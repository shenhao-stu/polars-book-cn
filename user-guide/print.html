<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Polars - User Guide</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="quickstart/intro.html"><strong aria-hidden="true">2.</strong> Getting started</a></li><li class="chapter-item expanded "><a href="dsl/intro.html"><strong aria-hidden="true">3.</strong> Polars expressions</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dsl/expressions.html"><strong aria-hidden="true">3.1.</strong> Expressions</a></li><li class="chapter-item "><a href="dsl/contexts.html"><strong aria-hidden="true">3.2.</strong> Contexts</a></li><li class="chapter-item "><a href="dsl/groupby.html"><strong aria-hidden="true">3.3.</strong> GroupBy</a></li><li class="chapter-item "><a href="dsl/folds.html"><strong aria-hidden="true">3.4.</strong> Folds</a></li><li class="chapter-item "><a href="dsl/window_functions.html"><strong aria-hidden="true">3.5.</strong> Window functions</a></li><li class="chapter-item "><a href="dsl/numpy.html"><strong aria-hidden="true">3.6.</strong> Numpy universal functions</a></li><li class="chapter-item "><a href="notebooks/introduction_polars.html"><strong aria-hidden="true">3.7.</strong> Examples</a></li><li class="chapter-item "><a href="dsl/api.html"><strong aria-hidden="true">3.8.</strong> API</a></li><li class="chapter-item "><a href="dsl/video_intro.html"><strong aria-hidden="true">3.9.</strong> Video introduction</a></li></ol></li><li class="chapter-item expanded "><a href="indexing.html"><strong aria-hidden="true">4.</strong> Indexing</a></li><li class="chapter-item expanded "><a href="datatypes.html"><strong aria-hidden="true">5.</strong> Data Types</a></li><li class="chapter-item expanded "><a href="coming_from_pandas.html"><strong aria-hidden="true">6.</strong> Coming from Pandas</a></li><li class="chapter-item expanded "><a href="coming_from_spark.html"><strong aria-hidden="true">7.</strong> Coming from Apache Spark</a></li><li class="chapter-item expanded "><a href="timeseries/intro.html"><strong aria-hidden="true">8.</strong> Time-series</a></li><li class="chapter-item expanded "><a href="howcani/intro.html"><strong aria-hidden="true">9.</strong> How can I?</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="howcani/io/intro.html"><strong aria-hidden="true">9.1.</strong> IO</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="howcani/io/csv.html"><strong aria-hidden="true">9.1.1.</strong> CSV files</a></li><li class="chapter-item "><a href="howcani/io/parquet.html"><strong aria-hidden="true">9.1.2.</strong> Parquet files</a></li><li class="chapter-item "><a href="multiple_files/intro.html"><strong aria-hidden="true">9.1.3.</strong> Multiple files</a></li><li class="chapter-item "><a href="howcani/io/read_db.html"><strong aria-hidden="true">9.1.4.</strong> Read from a database</a></li><li class="chapter-item "><a href="howcani/io/aws.html"><strong aria-hidden="true">9.1.5.</strong> Interact with AWS</a></li><li class="chapter-item "><a href="howcani/io/google-big-query.html"><strong aria-hidden="true">9.1.6.</strong> Interact with Google BigQuery</a></li><li class="chapter-item "><a href="howcani/io/postgres.html"><strong aria-hidden="true">9.1.7.</strong> Interact with Postgres</a></li><li class="chapter-item "><a href="howcani/interop/intro.html"><strong aria-hidden="true">9.1.8.</strong> Interoperability</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="howcani/interop/arrow.html"><strong aria-hidden="true">9.1.8.1.</strong> Arrow</a></li><li class="chapter-item "><a href="howcani/interop/numpy.html"><strong aria-hidden="true">9.1.8.2.</strong> NumPy</a></li></ol></li><li class="chapter-item "><a href="howcani/data/intro.html"><strong aria-hidden="true">9.1.9.</strong> Data handling</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="howcani/data/strings.html"><strong aria-hidden="true">9.1.9.1.</strong> Process strings</a></li><li class="chapter-item "><a href="howcani/data/timestamps.html"><strong aria-hidden="true">9.1.9.2.</strong> Process timestamps</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="performance/intro.html"><strong aria-hidden="true">10.</strong> Performance</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="performance/strings.html"><strong aria-hidden="true">10.1.</strong> Strings</a></li></ol></li><li class="chapter-item expanded "><a href="optimizations/intro.html"><strong aria-hidden="true">11.</strong> Optimizations</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="optimizations/lazy/intro.html"><strong aria-hidden="true">11.1.</strong> Lazy API</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="optimizations/lazy/predicate-pushdown.html"><strong aria-hidden="true">11.1.1.</strong> Predicate pushdown</a></li><li class="chapter-item "><a href="optimizations/lazy/projection-pushdown.html"><strong aria-hidden="true">11.1.2.</strong> Projection pushdown</a></li><li class="chapter-item "><a href="optimizations/lazy/other-optimizations.html"><strong aria-hidden="true">11.1.3.</strong> Other optimizations</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="references.html"><strong aria-hidden="true">12.</strong> Reference guides</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Polars - User Guide</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div style="margin: 30px auto; background-color: white; border-radius: 50%; width: 200px; height: 200px;"><img src="https://raw.githubusercontent.com/pola-rs/polars-static/master/logos/polars-logo-dark.svg" alt="Polars logo" style="width: 168px; height: 168px; padding: 10px 20px;"></div>
<h1 id="ä»‹ç»"><a class="header" href="#ä»‹ç»">ä»‹ç»</a></h1>
<p>è¿™æ˜¯ä¸€ä¸ªä»‹ç»<a href="https://github.com/pola-rs/polars"><code>Polars</code> DataFrame library</a>çš„æŒ‡å—ã€‚å®ƒçš„ç›®æ ‡æ˜¯é€šè¿‡é˜…è¯»ç¤ºä¾‹å¹¶ä¸å…¶ä»–ç¤ºä¾‹è¿›è¡Œæ¯”è¾ƒï¼Œå‘æ‚¨ä»‹ç»<code>Polars</code>è§£å†³æ–¹æ¡ˆã€‚è¿™é‡Œä»‹ç»äº†ä¸€äº›è®¾è®¡é€‰æ‹©ã€‚è¯¥æŒ‡å—è¿˜å°†å‘æ‚¨ä»‹ç»<code>Polars</code>çš„æœ€ä½³ä½¿ç”¨ã€‚</p>
<p>å°½ç®¡<code>Polars</code>å®Œå…¨æ˜¯ç”¨<a href="https://www.rust-lang.org/"><code>Rust</code></a>å†™çš„ï¼ˆæ²¡æœ‰è¿è¡Œæ—¶å¼€é”€ï¼ï¼‰ä½¿ç”¨ <a href="https://arrow.apache.org/"><code>Arrow</code></a> -- <a href="https://github.com/jorgecarleitao/arrow2">åŸç”Ÿ <code>Rust</code> å®ç°çš„arrow2</a> -- ä½œä¸ºå®ƒçš„åº•åŸºã€‚æœ¬æŒ‡å—ä¸­çš„ç¤ºä¾‹ä¸»è¦ä½¿ç”¨å…¶æ›´é«˜çº§çš„è¯­è¨€ç»‘å®šã€‚é«˜çº§ç»‘å®šåªä½œä¸ºæ ¸å¿ƒåº“ä¸­å®ç°çš„åŠŸèƒ½çš„ç®€è¦çš„åŒ…è£…ã€‚</p>
<p>å¯¹äº <a href="https://pandas.pydata.org/"><code>Pandas</code></a> ä½¿ç”¨è€…, æˆ‘ä»¬çš„<a href="https://pypi.org/project/polars/">Python package</a> æä¾›æœ€ç®€å•çš„æ–¹å¼æ¥å¯åŠ¨<code>Polars</code>.</p>
<h2 id="ç›®æ ‡ä¸éç›®æ ‡"><a class="header" href="#ç›®æ ‡ä¸éç›®æ ‡">ç›®æ ‡ä¸éç›®æ ‡</a></h2>
<p><code>Polars</code>çš„ç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªé—ªç”µèˆ¬çš„<code>DataFrame</code>åº“ï¼Œåˆ©ç”¨æ‰€æœ‰æœºå™¨ä¸Šçš„å¯ç”¨å†…æ ¸ã€‚ä¸åƒdaskè¿™æ ·çš„å·¥å…·â€”â€”å®ƒè¯•å›¾å¹¶è¡ŒåŒ–ç°æœ‰çš„å•çº¿ç¨‹åº“ï¼Œæ¯”å¦‚<code>NumPy</code>å’Œ<code>Pandas</code>â€”â€”<code>Polars</code>æ˜¯ä»å¤´å¼€å§‹ç¼–å†™çš„ï¼Œæ—¨åœ¨å¹¶è¡ŒåŒ–<code>DataFrame</code>ä¸Šçš„æŸ¥è¯¢ã€‚</p>
<p><code>Polars</code>ä¸é—ä½™åŠ›åœ°ï¼š</p>
<ul>
<li>å‡å°‘å†—ä½™æ‹·è´</li>
<li>é«˜æ•ˆåœ°éå†å†…å­˜ç¼“å­˜</li>
<li>æœ€å°åŒ–å¹¶è¡Œä¸­çš„äº‰ç”¨</li>
</ul>
<p><code>Polars</code>æ˜¯æ‡’æƒ°å’ŒåŠæ‡’æƒ°çš„ã€‚å®ƒå¯ä»¥è®©ä½ æ€¥åˆ‡åœ°å®Œæˆå¤§éƒ¨åˆ†å·¥ä½œï¼Œå°±åƒ<code>Pandas</code>ä¸€æ ·ï¼Œä½†æ˜¯
å®ƒè¿˜æä¾›äº†å¼ºå¤§çš„è¡¨è¾¾å¼è¯­æ³•ï¼Œå¯ä»¥åœ¨æŸ¥è¯¢å¼•æ“ä¸­å¯¹å…¶è¿›è¡Œä¼˜åŒ–å’Œæ‰§è¡Œã€‚</p>
<p>åœ¨lazy <code>Polars</code>ä¸­ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå¯¹æ•´ä¸ªæŸ¥è¯¢è¿›è¡ŒæŸ¥è¯¢ä¼˜åŒ–ï¼Œè¿›ä¸€æ­¥æé«˜æ€§èƒ½å’Œå†…å­˜å‹åŠ›ã€‚</p>
<p><code>Polars</code>ä»¥<em>é€»è¾‘è®¡åˆ’</em>è·Ÿè¸ªæ‚¨çš„æŸ¥è¯¢ã€‚è¿™è®¡åˆ’åœ¨è¿è¡Œå‰ç»è¿‡ä¼˜åŒ–å’Œé‡æ–°æ’åºã€‚å½“è¯·æ±‚ç»“æœæ—¶ï¼Œ<code>Polars</code>å°†å¯ç”¨çš„å·¥ä½œåˆ†é…ç»™ä½¿ç”¨å¯ç”¨ç®—æ³•çš„ä¸åŒ<em>æ‰§è¡Œè€…</em>åœ¨æ¸´æœ›äº§ç”Ÿç»“æœçš„APIä¸­ã€‚å› ä¸ºæ‰€æœ‰äººéƒ½çŸ¥é“æ•´ä¸ªæŸ¥è¯¢ä¸Šä¸‹æ–‡é€»è¾‘è®¡åˆ’çš„ä¼˜åŒ–å™¨å’Œæ‰§è¡Œè€…ï¼Œæµç¨‹ä¾èµ–äºå•ç‹¬çš„æ•°æ®æºå¯ä»¥åŠ¨æ€å¹¶è¡Œã€‚</p>
<p><img src="https://raw.githubusercontent.com/pola-rs/polars-static/master/docs/api.svg" alt="" /></p>
<h3 id="æ€§èƒ½-"><a class="header" href="#æ€§èƒ½-">æ€§èƒ½ ğŸš€ğŸš€</a></h3>
<p>Polarsçš„é€Ÿåº¦éå¸¸å¿«ï¼Œäº‹å®ä¸Šæ˜¯ç›®å‰æ€§èƒ½æœ€å¥½çš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚å‚è§h2oaiçš„dbåŸºå‡†æµ‹è¯•ä¸­çš„ç»“æœã€‚ä¸‹å›¾æ˜¾ç¤ºäº†äº§ç”Ÿç»“æœçš„æœ€å¤§æ•°æ®é›†ã€‚</p>
<p><img src="https://www.ritchievink.com/img/post-35-polars-0.15/db-benchmark.png" alt="" /></p>
<h3 id="å½“å‰çŠ¶æ€"><a class="header" href="#å½“å‰çŠ¶æ€">å½“å‰çŠ¶æ€</a></h3>
<p>ä¸‹é¢æ˜¯<code>Polars</code>èƒ½å¤Ÿå®ç°å…¶ç›®æ ‡çš„åŠŸèƒ½çš„ç®€æ˜åˆ—è¡¨ï¼š</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Copy-on-write">Copy-on-write</a> (COW) è¯­ä¹‰å­¦
<ul>
<li>â€œè‡ªç”±â€å…‹éš†ï¼ˆCloneï¼‰</li>
<li>ä¾¿æ·çš„è¿½åŠ ï¼ˆappendï¼‰</li>
</ul>
</li>
<li>æ²¡æœ‰å…‹éš†ï¼ˆcloneï¼‰çš„è¿½åŠ ï¼ˆappendï¼‰</li>
<li>é¢å‘åˆ—çš„æ•°æ®å­˜å‚¨
<ul>
<li>æ— åŒºå—ç®¡ç†å™¨ï¼ˆå³å¯é¢„æµ‹çš„æ€§èƒ½ï¼‰</li>
</ul>
</li>
<li>ç¼ºå°‘ç”¨ä½æ©ç ï¼ˆbitmaskï¼‰æŒ‡ç¤ºçš„å€¼
<ul>
<li>NaNå’Œmissingä¸ä¸€æ ·</li>
<li>ä½æ©ç ï¼ˆbitmaskï¼‰ä¼˜åŒ–</li>
</ul>
</li>
<li>é«˜æ•ˆç®—æ³•</li>
<li>éå¸¸å¿«çš„IO
<ul>
<li>å®ƒçš„csvå’Œparquet é˜…è¯»å™¨æ˜¯ç°å­˜é€Ÿåº¦æœ€å¿«çš„é˜…è¯»å™¨ä¹‹ä¸€</li>
</ul>
</li>
<li><a href="optimizations/lazy/intro.html">æŸ¥è¯¢ä¼˜åŒ–</a>
<ul>
<li>è°“è¯ï¼ˆPredicateï¼‰ä¸‹æ¨
<ul>
<li>æ‰«æçº§è¿‡æ»¤</li>
</ul>
</li>
<li>æŠ•å½±ä¸‹æ¨
<ul>
<li>æ‰«æçº§æŠ•å½±</li>
</ul>
</li>
<li>èšåˆä¸‹æ¨
<ul>
<li>æ‰«æçº§èšåˆ</li>
</ul>
</li>
<li>ç®€åŒ–è¡¨è¾¾å¼</li>
<li>ç‰©ç†è®¡åˆ’çš„å¹¶è¡Œæ‰§è¡Œ</li>
<li>åŸºäºåŸºæ•°çš„åˆ†ç»„è°ƒåº¦
<ul>
<li>åŸºäºæ•°æ®åŸºæ•°çš„åˆ†ç»„ç­–ç•¥</li>
</ul>
</li>
</ul>
</li>
<li>SIMDçŸ¢é‡åŒ–</li>
<li><a href="https://numpy.org/doc/stable/reference/ufuncs.html"><code>NumPy</code> é€šç”¨å‡½æ•°</a></li>
</ul>
<h2 id="è‡´è°¢"><a class="header" href="#è‡´è°¢">è‡´è°¢</a></h2>
<p><code>Polars</code>çš„å¼€å‘æ˜¯ç”±</p>
<p><a href="https://www.xomnia.com"><img src="https://raw.githubusercontent.com/pola-rs/polars-static/master/sponsors/xomnia.png" alt="Xomnia" /></a></p>
<h1 id="å…¥é—¨"><a class="header" href="#å…¥é—¨">å…¥é—¨</a></h1>
<h2 id="å®‰è£…"><a class="header" href="#å®‰è£…">å®‰è£…</a></h2>
<p>é‡‡ç”¨ <code>pip install</code> å³å¯å®‰è£… <code>Polars</code> ã€‚</p>
<pre><code class="language-shell">$ pip install polars
</code></pre>
<p>æ‰€æœ‰çš„äºŒè¿›åˆ¶åŒ…éƒ½æ˜¯åŸºäº <code>Python</code> v3.6+ æ„å»ºçš„ã€‚</p>
<h2 id="å®ä¾‹"><a class="header" href="#å®ä¾‹">å®ä¾‹</a></h2>
<p>ä¸‹é¢çš„ä¾‹å­ä¸­æˆ‘ä»¬è¯»å…¥å¹¶è§£æä¸€ä¸ª CSV æ–‡ä»¶ï¼Œè¿‡æ»¤åè¿æ¥ä¸€ä¸ª <code>groupby</code> æ“ä½œï¼š</p>
<pre><code class="language-python">import polars as pl

df = pl.read_csv(&quot;https://j.mp/iriscsv&quot;)
print(df.filter(pl.col(&quot;sepal_length&quot;) &gt; 5)
      .groupby(&quot;species&quot;)
      .agg(pl.all().sum())
)
</code></pre>
<p>ä¸Šé¢çš„ä»£ç è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre><code class="language-text">shape: (3, 5)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ species      â”† sepal_length_sum â”† sepal_width_sum â”† petal_length_sum â”† petal_width_sum â”‚
â”‚ ---          â”† ---              â”† ---             â”† ---              â”† ---             â”‚
â”‚ str          â”† f64              â”† f64             â”† f64              â”† f64             â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ &quot;virginica&quot;  â”† 324.5            â”† 146.2           â”† 273.1            â”† 99.6            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ &quot;versicolor&quot; â”† 281.9            â”† 131.8           â”† 202.9            â”† 63.3            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ &quot;setosa&quot;     â”† 116.9            â”† 81.7            â”† 33.2             â”† 6.1             â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
</code></pre>
<p>å¦‚ä¸Šæ‰€ç¤ºï¼Œ <code>Polars</code> å¯ä»¥æ ¼å¼åŒ–è¾“å‡ºï¼ŒåŒ…æ‹¬ä½œä¸ºè¡¨å¤´çš„åˆ—åå’Œæ•°æ®ç±»å‹ã€‚</p>
<h2 id="æƒ°æ€§å®ä¾‹"><a class="header" href="#æƒ°æ€§å®ä¾‹">æƒ°æ€§å®ä¾‹</a></h2>
<p>ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬ä¹Ÿå¯ä»¥é‡‡ç”¨æƒ°æ€§æ–¹å¼æ‰§è¡Œï¼š</p>
<pre><code class="language-python">import polars as pl

print(
    pl.read_csv(&quot;https://j.mp/iriscsv&quot;)
    .lazy()
    .filter(pl.col(&quot;sepal_length&quot;) &gt; 5)
    .groupby(&quot;species&quot;)
    .agg(pl.all().sum())
    .collect()
)
</code></pre>
<p>å¦‚æœæ•°æ®æ–‡ä»¶ä¿å­˜åœ¨æœ¬åœ°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ <code>scan_csv</code> æ¥å®ç°æƒ°æ€§æŸ¥è¯¢ã€‚</p>
<h2 id="å‚è€ƒ"><a class="header" href="#å‚è€ƒ">å‚è€ƒ</a></h2>
<p><code>Python</code> API å¯ä»¥å‚è€ƒï¼š<a href="https://pola-rs.github.io/polars/py-polars/html/reference">Fix Me</a>.</p>
<h3 id="æƒ°æ€§-api"><a class="header" href="#æƒ°æ€§-api">æƒ°æ€§ API</a></h3>
<p>æƒ°æ€§ API ä¼šæ„å»ºä¸€ä¸ªæŸ¥è¯¢æ–¹æ¡ˆã€‚åœ¨è°ƒç”¨ <code>LazyFrame.collect()</code> æˆ–è€… <code>LazyFrame.fetch()</code> ä¹‹å‰ï¼Œ
<code>Polars</code> ä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œã€‚è¿™ç§æ–¹å¼å¯ä»¥è®© <code>Polars</code> äº†è§£æŸ¥è¯¢çš„æ‰€æœ‰æ“ä½œï¼Œå¹¶ä¾æ®è¿™äº›æ“ä½œè¿›è¡Œä¼˜åŒ–ï¼Œ
é€‰æ‹©æœ€ä½³çš„ç®—æ³•æ‰§è¡Œã€‚</p>
<p>ä»é¥¥ä¿„æ‰§è¡Œåˆ°æƒ°æ€§æ‰§è¡Œçš„æ”¹å˜éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨å·²æœ‰è°ƒç”¨åŸºç¡€ä¸Šæ·»åŠ  <code>.lazy()</code> å’Œ <code>.collect()</code> å³å¯ã€‚</p>
<p>æ­£å¦‚ä¹‹å‰çœ‹åˆ°çš„ä¾‹å­ä¸€æ ·ï¼š</p>
<pre><code class="language-python">import polars as pl

print(
    pl.read_csv(&quot;https://j.mp/iriscsv&quot;)
    .lazy()
    .filter(pl.col(&quot;sepal_length&quot;) &gt; 5)
    .groupby(&quot;species&quot;)
    .agg(pl.all().sum())
    .collect()
)
</code></pre>
<h1 id="polars-è¡¨è¾¾å¼"><a class="header" href="#polars-è¡¨è¾¾å¼">Polars è¡¨è¾¾å¼</a></h1>
<p><code>Polars</code>æœ‰ä¸€ä¸ªå¼ºå¤§çš„æ¦‚å¿µå«åšè¡¨è¾¾å¼ã€‚<code>Polars</code>è¡¨è¾¾å¼å¯ä»¥åœ¨å„ç§ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ï¼Œæ˜¯<code>Fnï¼ˆSeriesï¼‰-&gt;Series</code>çš„å‡½æ•°æ˜ å°„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬æœ‰ä¸€ä¸ª<code>Series</code>ä½œä¸ºè¾“å…¥ï¼Œä¸€ä¸ª<code>Series</code>ä½œä¸ºè¾“å‡ºã€‚é€šè¿‡æŸ¥çœ‹è¿™ä¸ªå‡½æ•°å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>Expr</code>çš„è¾“å‡ºä¹Ÿå¯ä»¥ç”¨ä½œ<code>Expr</code>çš„è¾“å…¥ã€‚</p>
<p>è¿™å¬èµ·æ¥å¯èƒ½æœ‰ç‚¹å¥‡æ€ªï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä»ä¸€ä¸ªä¾‹å­å¼€å§‹ã€‚</p>
<h1 id="polars-è¡¨è¾¾å¼-1"><a class="header" href="#polars-è¡¨è¾¾å¼-1">Polars è¡¨è¾¾å¼</a></h1>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼š</p>
<p><code>pl.col(&quot;foo&quot;).sort().head(2)</code></p>
<p>è¿™ä¸ªè¡¨è¾¾å¼çš„æ„æ€æ˜¯ï¼š</p>
<ol>
<li>é€‰æ‹© <code>foo</code> åˆ—</li>
<li>ç»™ <code>foo</code> æ’åº</li>
<li>ç„¶åææ’åºåçš„å‰ä¸¤ä¸ªå€¼</li>
</ol>
<p>è¡¨è¾¾å¼çš„å¼ºå¤§ä¹‹å¤„åœ¨äºï¼šæ¯ä¸€ä¸ªè¡¨è¾¾å¼éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„è¡¨è¾¾å¼ï¼Œä»–ä»¬å¯ä»¥è¢«ä¸²åœ¨ä¸€èµ·ã€‚
ä½ ä¹Ÿå¯ä»¥æŠŠå¤šä¸ªè¡¨è¾¾å¼æ”¾å…¥ä¸€ä¸ª <code>Polars</code> çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ã€‚</p>
<p>æ¯”å¦‚ï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡ <code>df.select</code> å°†ä¸¤ä¸ªè¡¨è¾¾å¼æ”¾åœ¨åŒä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ï¼š</p>
<pre><code class="language-python">df.select([
    pl.col(&quot;foo&quot;).sort().head(2),
    pl.col(&quot;bar&quot;).filter(pl.col(&quot;foo&quot;) == 1).sum()
])
</code></pre>
<p>è¿™é‡Œçš„ä¸¤ä¸ªè¡¨è¾¾å¼æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œè¿™å°±æ„å‘³ç€ <code>Polars</code> è¡¨è¾¾å¼å¯ä»¥<strong>å°´å°¬å¹¶è¡Œ</strong>ï¼ˆå³æ— é€šè®¯å¹¶è¡Œï¼‰ã€‚
å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ¯ä¸€ä¸ªè¡¨è¾¾å¼çš„æ‰§è¡Œå¯èƒ½åŒæ—¶å­˜åœ¨æ›´å¤šçš„å¹¶è¡Œã€‚</p>
<h2 id="è¡¨è¾¾å¼ä¸¾ä¾‹"><a class="header" href="#è¡¨è¾¾å¼ä¸¾ä¾‹">è¡¨è¾¾å¼ä¸¾ä¾‹</a></h2>
<p>è¿™ä¸€å°èŠ‚æˆ‘ä»¬é€šè¿‡ä¾‹å­äº†è§£è¡¨è¾¾å¼ã€‚é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ•°æ®é›†ï¼š</p>
<pre><code class="language-python">import polars as pl
import numpy as np

np.random.seed(12)  # è®¾ç½®éšæœºæ•°ç§å­ï¼ˆä¿è¯æ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°ç›¸åŒï¼‰

df = pl.DataFrame(
    {
        &quot;nrs&quot;: [1, 2, 3, None, 5],
        &quot;names&quot;: [&quot;foo&quot;, &quot;ham&quot;, &quot;spam&quot;, &quot;egg&quot;, None],
        &quot;random&quot;: np.random.rand(5),
        &quot;groups&quot;: [&quot;A&quot;, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;B&quot;],
    }
)
print(df)
</code></pre>
<pre><code class="language-text">shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ nrs  â”† names â”† random   â”† groups â”‚
â”‚ ---  â”† ---   â”† ---      â”† ---    â”‚
â”‚ i64  â”† str   â”† f64      â”† str    â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1    â”† foo   â”† 0.154163 â”† A      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2    â”† ham   â”† 0.74     â”† A      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 3    â”† spam  â”† 0.263315 â”† B      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ null â”† egg   â”† 0.533739 â”† C      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 5    â”† null  â”† 0.014575 â”† B      â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>ä½ å¯ä»¥é€šè¿‡è¡¨è¾¾å¼åšå¾ˆå¤šäº‹æƒ…ï¼Œä»–ä»¬çš„è¡¨è¾¾èƒ½åŠ›å¾ˆå¼ºä»¥è‡³äºå¾ˆå¤šæ—¶å€™ä½ æœ‰å¤šç§ä¸åŒçš„æ–¹æ³•å®ç°åŒä¸€ä¸ªè®¡ç®—ã€‚
ä¸ºäº†æ›´å¥½çš„ç†è§£è¡¨è¾¾å¼ï¼Œè®©æˆ‘ä»¬çœ‹æ›´å¤šçš„ä¾‹å­ã€‚</p>
<h3 id="è®¡ç®—å”¯ä¸€å€¼"><a class="header" href="#è®¡ç®—å”¯ä¸€å€¼">è®¡ç®—å”¯ä¸€å€¼</a></h3>
<p>æˆ‘ä»¬å¯ä»¥è®¡ç®—ä¸€ä¸ªåˆ—ä¸­å”¯ä¸€å€¼ã€‚æ³¨æ„è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨äº†ä¸¤ç§ä¸åŒçš„æ–¹æ³•è®¡ç®—åŒä¸€ä¸ªç»“æœã€‚ä¸ºäº†é¿å…é‡å¤åˆ—åç§°ï¼Œ
æˆ‘ä»¬ä½¿ç”¨ <code>alias</code> å³åˆ«åè¡¨è¾¾å¼æ¥é‡å‘½åè¡¨è¾¾å¼ã€‚</p>
<pre><code class="language-python">out = df.select(
    [
        pl.col(&quot;names&quot;).n_unique().alias(&quot;unique_names_1&quot;),
        pl.col(&quot;names&quot;).unique().count().alias(&quot;unique_names_2&quot;),
    ]
)
print(out)
</code></pre>
<pre><code class="language-text">shape: (1, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ unique_names_1 â”† unique_names_2 â”‚
â”‚ ---            â”† ---            â”‚
â”‚ u32            â”† u32            â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 5              â”† 5              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="ä¸åŒçš„èšåˆæ“ä½œ"><a class="header" href="#ä¸åŒçš„èšåˆæ“ä½œ">ä¸åŒçš„èšåˆæ“ä½œ</a></h3>
<p>æˆ‘ä»¬å¯ä»¥å®Œæˆä¸åŒçš„èšåˆæ“ä½œï¼Œä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­ï¼Œå½“ç„¶è¿˜æœ‰æ›´å¤šæ“ä½œæ¯”å¦‚ï¼š<code>median</code>, <code>mean</code>, <code>first</code>
ç­‰ç­‰ã€‚</p>
<pre><code class="language-python">out = df.select(
    [
        pl.sum(&quot;random&quot;).alias(&quot;sum&quot;),  # å¯¹randomåˆ—æ±‚å’Œå¹¶æ–°å¢ä¸€åˆ—
        pl.min(&quot;random&quot;).alias(&quot;min&quot;),  # å¯¹randomåˆ—æ±‚æœ€å°å€¼å¹¶æ–°å¢ä¸€åˆ—
        pl.max(&quot;random&quot;).alias(&quot;max&quot;),  # å¯¹randomåˆ—æ±‚æœ€å¤§å€¼å¹¶æ–°å¢ä¸€åˆ—
        pl.col(&quot;random&quot;).max().alias(&quot;other_max&quot;),  # å¦ä¸€ç§æ±‚æœ€å¤§å€¼çš„æ–¹å¼
        pl.std(&quot;random&quot;).alias(&quot;std dev&quot;),  # å¯¹randomåˆ—æ±‚æ ‡å‡†å·®å¹¶æ–°å¢ä¸€åˆ—
        pl.var(&quot;random&quot;).alias(&quot;variance&quot;),  # å¯¹randomåˆ—æ±‚æ–¹å·®å¹¶æ–°å¢ä¸€åˆ—
    ]
)
print(out)
</code></pre>
<pre><code class="language-text">shape: (1, 6)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ sum      â”† min      â”† max  â”† other_max â”† std dev  â”† variance â”‚
â”‚ ---      â”† ---      â”† ---  â”† ---       â”† ---      â”† ---      â”‚
â”‚ f64      â”† f64      â”† f64  â”† f64       â”† f64      â”† f64      â”‚
â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 1.705842 â”† 0.014575 â”† 0.74 â”† 0.74      â”† 0.293209 â”† 0.085971 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="è¿‡æ»¤å’Œæ¡ä»¶é€‰æ‹©"><a class="header" href="#è¿‡æ»¤å’Œæ¡ä»¶é€‰æ‹©">è¿‡æ»¤å’Œæ¡ä»¶é€‰æ‹©</a></h3>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥åšä¸€äº›å¤æ‚çš„äº‹æƒ…ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ä¸­æˆ‘ä»¬è®¡ç®—æ‰€æœ‰ä»¥ <code>am</code> ç»“å°¾çš„åå­—ã€‚</p>
<pre><code class="language-python">out = df.select(
    [
        pl.col(&quot;names&quot;).filter(pl.col(&quot;names&quot;).str.contains(r&quot;am$&quot;)).count(),  # strå‘½åç©ºé—´ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼
    ]
)
print(df)
</code></pre>
<pre><code class="language-text">shape: (1, 1)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚ names â”‚
â”‚ ---   â”‚
â”‚ u32   â”‚
â•â•â•â•â•â•â•â•â•¡
â”‚ 2     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="äºŒå…ƒå‡½æ•°å’Œä¿®æ”¹"><a class="header" href="#äºŒå…ƒå‡½æ•°å’Œä¿®æ”¹">äºŒå…ƒå‡½æ•°å’Œä¿®æ”¹</a></h3>
<p>ä¸‹é¢çš„å®ä¾‹ä¸­ï¼Œç”¨ä¸€ä¸ªæ¡ä»¶è¯­å¥åˆ›å»ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>when -&gt; then -&gt; otherwise</code> çš„æ¨¡å¼ã€‚
<code>when</code> å‡½æ•°éœ€è¦ä¸€ä¸ªè°“è¯è¡¨è¾¾å¼ (Predicate expressionï¼Œå› æ­¤è¿”å›ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„ <code>Series</code>) ã€‚
<code>then</code> å‡½æ•°éœ€è¦ä¼ å…¥å½“è°“è¯è¡¨è¾¾å¼ä¸ºçœŸæ—¶æ‰§è¡Œçš„è¡¨è¾¾å¼ï¼Œè€Œ <code>otherwise</code> å‡½æ•°éœ€è¦ä¼ å…¥è°“è¯è¡¨è¾¾å¼ä¸º
å‡çš„è¡¨è¾¾å¼ã€‚</p>
<p>ä½ å¯ä»¥ä¼ å…¥ä»»ä½•è¡¨è¾¾å¼ï¼ŒåŒ…æ‹¬ç®€å•çš„<code>pl.col(&quot;foo&quot;)</code>, <code>pl.lit(3)</code>, <code>pl.lit(&quot;bar&quot;)</code>ç­‰ç­‰ã€‚</p>
<p>æœ€ç»ˆï¼Œæˆ‘ä»¬æŠŠç»“æœä¸ä¸€ä¸ª <code>sum</code> è¡¨è¾¾å¼ç›¸ä¹˜ã€‚</p>
<pre><code class="language-python">out = df.select(
    [
        pl.when(pl.col(&quot;random&quot;) &gt; 0.5).then(0).otherwise(pl.col(&quot;random&quot;)) * pl.sum(&quot;nrs&quot;),
    ]
)
print(df)
</code></pre>
<pre><code class="language-text">shape: (5, 1)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ literal  â”‚
â”‚ ---      â”‚
â”‚ f64      â”‚
â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 1.695791 â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 0.0      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2.896465 â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 0.0      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 0.160325 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="çª—å£è¡¨è¾¾å¼"><a class="header" href="#çª—å£è¡¨è¾¾å¼">çª—å£è¡¨è¾¾å¼</a></h3>
<p>ä¸€ä¸ª polars è¡¨è¾¾å¼å¯ä»¥éšå¼åœ°è¿›è¡Œ GROUPBYï¼ˆåˆ†ç»„ï¼‰ã€AGGREGATIONï¼ˆèšåˆï¼‰ ä»¥åŠ JOINï¼ˆè”åˆï¼‰ æ“ä½œã€‚
åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œä½¿ç”¨<code>over</code>å‡½æ•°ï¼Œæˆ‘ä»¬é€šè¿‡ <code>group</code> è¿›è¡Œåˆ†ç»„ï¼Œåœ¨ <code>random</code> åˆ—æ‰§è¡ŒèšåˆåŠ æ³•ã€‚åœ¨ä¸‹ä¸€ä¸ªè¡¨è¾¾å¼ä¸­ï¼Œ
é€šè¿‡ <code>names</code> è¿›è¡Œåˆ†ç»„ï¼Œåœ¨ <code>random</code> åˆ—æ‰§è¡Œèšåˆåˆ—è¡¨æ“ä½œã€‚
è¿™äº›çª—å£å‡½æ•°è¿˜å¯ä»¥ä¸å…¶ä»–è¡¨è¾¾å¼ç»„åˆå½¢æˆä¸€ä¸ªé«˜æ•ˆè®¡ç®—åˆ†ç»„ç»Ÿè®¡æŒ‡æ ‡è®¡ç®—æ–¹æ³•ã€‚
æ›´å¤šçš„åˆ†ç»„å‡½æ•°<a href="https://pola-rs.github.io/polars/py-polars/html/reference/expression.html#aggregation">å‚è€ƒè¿™é‡Œ</a>ã€‚</p>
<pre><code class="language-python">df = df[
    [
        pl.col(&quot;*&quot;),  # é€‰æ‹©æ‰€æœ‰åˆ—
        pl.col(&quot;random&quot;).sum().over(&quot;groups&quot;).alias(&quot;sum[random]/groups&quot;),
        pl.col(&quot;random&quot;).list().over(&quot;names&quot;).alias(&quot;random/name&quot;),
    ]
]
print(df)
</code></pre>
<pre><code class="language-text">shape: (5, 6)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ nrs  â”† names â”† random   â”† groups â”† sum[random]/groups â”† random/name â”‚
â”‚ ---  â”† ---   â”† ---      â”† ---    â”† ---                â”† ---         â”‚
â”‚ i64  â”† str   â”† f64      â”† str    â”† f64                â”† list[f64]   â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 1    â”† foo   â”† 0.154163 â”† A      â”† 0.894213           â”† [0.154163]  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2    â”† ham   â”† 0.74     â”† A      â”† 0.894213           â”† [0.74]      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 3    â”† spam  â”† 0.263315 â”† B      â”† 0.2778             â”† [0.263315]  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ null â”† egg   â”† 0.533739 â”† C      â”† 0.533739           â”† [0.533739]  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 5    â”† null  â”† 0.014575 â”† B      â”† 0.2778             â”† [0.014575]  â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 id="ç»“è®º"><a class="header" href="#ç»“è®º">ç»“è®º</a></h2>
<p>è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°çš„è¡¨è¾¾å¼ä»…ä»…æ˜¯å†°å±±ä¸€è§’ã€‚<code>Polars</code> æä¾›äº†å¾ˆå¤šè¡¨è¾¾å¼ï¼Œè€Œä¸”ä»–ä»¬å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼ç»„åˆã€‚</p>
<p>æœ¬ç¯‡æ–‡æ¡£æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼çš„ç®€ä»‹ï¼Œå¸®åŠ©ç”¨æˆ·ç¨å¾®äº†è§£å¦‚ä½•ä½¿ç”¨è¡¨è¾¾å¼ã€‚ä¸‹ä¸€ç« ä¸­æˆ‘ä»¬ä¼šè®¨è®ºåœ¨å“ªäº›åœºæ™¯
ä¸­å¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ã€‚åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬è¿˜ä¼šä»‹ç»å¦‚ä½•åœ¨ä¸åŒçš„ <code>groupby</code> åœºæ™¯ä¸­ä½¿ç”¨è¡¨è¾¾å¼ï¼Œå¹¶
ç¡®ä¿ <code>Polars</code> å¯ä»¥å¹¶è¡Œæ‰§è¡Œè®¡ç®—ã€‚</p>
<h1 id="è¡¨è¾¾å¼ä¸Šä¸‹æ–‡"><a class="header" href="#è¡¨è¾¾å¼ä¸Šä¸‹æ–‡">è¡¨è¾¾å¼ä¸Šä¸‹æ–‡</a></h1>
<p>è¡¨è¾¾å¼å‡ ä¹å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼Œä½†æ˜¯è¡¨è¾¾å¼éœ€è¦ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œè¿™äº›ä¸Šä¸‹æ–‡åŒ…æ‹¬ï¼š</p>
<ul>
<li>é€‰æ‹©: <code>df.select([..])</code></li>
<li>åˆ†ç»„é›†åˆ: <code>df.groupby(..).agg([..])</code></li>
<li>hstack æˆ–è€…å¢åŠ åˆ—: <code>df.with_columns([..])</code></li>
</ul>
<h2 id="è¯­æ³•ç³–"><a class="header" href="#è¯­æ³•ç³–">è¯­æ³•ç³–</a></h2>
<p>éœ€è¦ä¸Šä¸‹æ–‡çš„ä¸»è¦åŸå› æ˜¯ï¼šå³ä½¿å®åœ¨é¥¥é¥¿æ¨¡å¼ä¸­ï¼Œä½ ä¹Ÿåœ¨ä½¿ç”¨ Polars çš„æƒ°æ€§APIã€‚
æ¯”å¦‚å¦‚ä¸‹ä»£ç å®ä¾‹ï¼š</p>
<pre><code class="language-python">df.groupby(&quot;foo&quot;).agg([pl.col(&quot;bar&quot;).sum()])
</code></pre>
<p>å»æ‰è¯­æ³•ç³–åï¼š</p>
<pre><code class="language-python">(df.lazy().groupby(&quot;foo&quot;).agg([pl.col(&quot;bar&quot;).sum()])).collect()
</code></pre>
<p>è¿™ç§è®¾è®¡å¯ä»¥è®© Polars æŠŠè¡¨è¾¾å¼æ¨é€ç»™æŸ¥è¯¢å¼•æ“ï¼Œè¿›è¡Œä¸€äº›ä¼˜åŒ–å’Œç¼“å­˜æ“ä½œã€‚</p>
<h2 id="select-ä¸Šä¸‹æ–‡"><a class="header" href="#select-ä¸Šä¸‹æ–‡"><code>select</code> ä¸Šä¸‹æ–‡</a></h2>
<p>åœ¨ <code>select</code> ä¸Šä¸‹æ–‡ä¸­ï¼Œé€‰æ‹©æ“ä½œæ˜¯æŒ‰ç…§åˆ—è¿›è¡Œçš„ã€‚åœ¨é€‰æ‹©å‘ä¸‹æ–‡çš„è¡¨è¾¾å¼å¿…é¡»è¦è¿”å› <code>Series</code> å¹¶ä¸”è¿™äº› <code>Series</code> éœ€è¦æœ‰ç›¸åŒçš„é•¿åº¦æˆ–è€…é•¿åº¦ä¸º1ã€‚</p>
<p>ä¸€ä¸ªé•¿åº¦ä¸º 1 çš„ <code>Series</code> ä¼šè¢«å¹¿åŒ¹é… <code>DataFrame</code> çš„é«˜åº¦ã€‚
æ³¨æ„ï¼Œ<code>select</code> å¯èƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„åˆ—ï¼Œè¿™ä¸ªåˆ—å¯èƒ½æ˜¯ä¸€äº›èšåˆçš„ç»“æœã€ä¸€äº›è¡¨è¾¾å¼çš„ç»„åˆæˆ–è€…å­—ç¬¦ä¸²ã€‚</p>
<h4 id="é€‰æ‹©ä¸Šä¸‹æ–‡"><a class="header" href="#é€‰æ‹©ä¸Šä¸‹æ–‡">é€‰æ‹©ä¸Šä¸‹æ–‡</a></h4>
<pre><code class="language-python">out = df.select(
    [
        pl.sum(&quot;nrs&quot;),
        pl.col(&quot;names&quot;).sort(),
        pl.col(&quot;names&quot;).first().alias(&quot;first name&quot;),
        (pl.mean(&quot;nrs&quot;) * 10).alias(&quot;10xnrs&quot;),
    ]
)
print(out)
</code></pre>
<pre><code class="language-text">shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ nrs â”† names â”† first name â”† 10xnrs â”‚
â”‚ --- â”† ---   â”† ---        â”† ---    â”‚
â”‚ i64 â”† str   â”† str        â”† f64    â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 11  â”† null  â”† foo        â”† 27.5   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 11  â”† egg   â”† foo        â”† 27.5   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 11  â”† foo   â”† foo        â”† 27.5   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 11  â”† ham   â”† foo        â”† 27.5   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 11  â”† spam  â”† foo        â”† 27.5   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ·»åŠ åˆ—</strong></p>
<p>é‡‡ç”¨ <code>with_columns</code> ç»™ <code>DataFrame</code> å¢åŠ åˆ—åŒæ ·ä¹Ÿæ˜¯é€‰æ‹©ä¸Šä¸‹æ–‡ã€‚</p>
<pre><code class="language-python">df = df.with_columns(
    [
        pl.sum(&quot;nrs&quot;).alias(&quot;nrs_sum&quot;),
        pl.col(&quot;random&quot;).count().alias(&quot;count&quot;),
    ]
)
print(out)
</code></pre>
<pre><code class="language-text">shape: (5, 6)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ nrs  â”† names â”† random   â”† groups â”† nrs_sum â”† count â”‚
â”‚ ---  â”† ---   â”† ---      â”† ---    â”† ---     â”† ---   â”‚
â”‚ i64  â”† str   â”† f64      â”† str    â”† i64     â”† u32   â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 1    â”† foo   â”† 0.154163 â”† A      â”† 11      â”† 5     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2    â”† ham   â”† 0.74     â”† A      â”† 11      â”† 5     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 3    â”† spam  â”† 0.263315 â”† B      â”† 11      â”† 5     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ null â”† egg   â”† 0.533739 â”† C      â”† 11      â”† 5     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 5    â”† null  â”† 0.014575 â”† B      â”† 11      â”† 5     â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 id="groupby-ä¸Šä¸‹æ–‡"><a class="header" href="#groupby-ä¸Šä¸‹æ–‡">Groupby ä¸Šä¸‹æ–‡</a></h2>
<p>åœ¨ <code>groupby</code> ä¸Šä¸‹æ–‡ä¸­çš„è¡¨è¾¾å¼ä¸»è¦ä½œç”¨åŸŸåˆ†ç»„ä¸Šï¼Œå› æ­¤ä»–ä»¬ä¼šè¿”å›ä»»æ„é•¿åº¦ï¼ˆæ¯ä¸ªç»„å¯èƒ½æœ‰ä¸åŒæ•°é‡çš„æˆå‘˜ï¼‰ã€‚</p>
<pre><code class="language-python">out = df.groupby(&quot;groups&quot;).agg(
    [
        pl.sum(&quot;nrs&quot;),  # é€šè¿‡groupsåˆ—å¯¹nrsæ±‚å’Œ
        pl.col(&quot;random&quot;).count().alias(&quot;count&quot;),  # è®°å½•ç»„æ•°
        # å¦‚æœname != nullè®°å½•randomåˆ—çš„å’Œ
        pl.col(&quot;random&quot;).filter(pl.col(&quot;names&quot;).is_not_null()).sum().suffix(&quot;_sum&quot;),
        pl.col(&quot;names&quot;).reverse().alias((&quot;reversed names&quot;)),
    ]
)
print(out)
</code></pre>
<pre><code class="language-text">shape: (3, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ groups â”† nrs  â”† count â”† random_sum â”† reversed names â”‚
â”‚ ---    â”† ---  â”† ---   â”† ---        â”† ---            â”‚
â”‚ str    â”† i64  â”† u32   â”† f64        â”† list[str]      â”‚
â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ B      â”† 8    â”† 2     â”† 0.263315   â”† [null, &quot;spam&quot;] â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ C      â”† null â”† 1     â”† 0.533739   â”† [&quot;egg&quot;]        â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ A      â”† 3    â”† 2     â”† 0.894213   â”† [&quot;ham&quot;, &quot;foo&quot;] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>é™¤äº†æ ‡å‡†çš„ <code>groupby</code>ï¼Œè¿˜æœ‰ <code>groupby_dynamic</code> å’Œ <code>groupby_rolling</code> ä¹Ÿå±äº Groupby ä¸Šä¸‹æ–‡ã€‚</p>
<h1 id="groupby"><a class="header" href="#groupby">GroupBy</a></h1>
<blockquote>
<p>æœ¬é¡µè¿˜åœ¨æ–½å·¥ä¸­ã€‚ã€‚ã€‚ã€‚</p>
</blockquote>
<h2 id="å¤šçº¿ç¨‹"><a class="header" href="#å¤šçº¿ç¨‹">å¤šçº¿ç¨‹</a></h2>
<p>å¤„ç†è¡¨çŠ¶æ•°æ®æœ€é«˜æ•ˆçš„æ–¹å¼å°±æ˜¯é€šè¿‡â€œåˆ†å‰²-å¤„ç†-ç»„åˆâ€çš„æ–¹å¼å¹¶è¡Œåœ°è¿›è¡Œã€‚è¿™æ ·çš„æ“ä½œæ­£æ˜¯ <code>Polars</code> çš„
åˆ†ç»„æ“ä½œçš„æ ¸å¿ƒï¼Œä¹Ÿæ˜¯ <code>Polars</code> å¦‚æ­¤é«˜æ•ˆçš„ç§˜å¯†ã€‚ç‰¹åˆ«æŒ‡å‡ºï¼Œåˆ†å‰²å’Œå¤„ç†éƒ½æ˜¯å¤šçº¿ç¨‹æ‰§è¡Œçš„ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†åˆ†ç»„æ“ä½œçš„æµç¨‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/pola-rs/polars-static/master/docs/split-apply-combine.svg" alt="" /></p>
<p>å¯¹äºåˆ†å‰²é˜¶æ®µçš„å“ˆå¸Œæ“ä½œï¼Œ<code>Polars</code> ä½¿ç”¨äº†æ— é”å¤šçº¿ç¨‹æ–¹å¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/pola-rs/polars-static/master/docs/lock-free-hash.svg" alt="" /></p>
<p>è¿™æ ·çš„å¹¶è¡Œæ“ä½œå¯ä»¥è®©åˆ†ç»„å’Œè”åˆæ“ä½œéå¸¸éå¸¸é«˜æ•ˆã€‚</p>
<blockquote>
<p>æ›´å¤šè§£é‡Šå‚è€ƒ <a href="https://www.ritchievink.com/blog/2021/02/28/i-wrote-one-of-the-fastest-dataframe-libraries/">è¿™ç¯‡åšå®¢</a></p>
</blockquote>
<h2 id="ä¸è¦æ€æ­»å¹¶è¡Œ"><a class="header" href="#ä¸è¦æ€æ­»å¹¶è¡Œ">ä¸è¦â€œæ€æ­»â€å¹¶è¡Œ</a></h2>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œ<code>Python</code> æ…¢ã€æ°´å¹³æ‹“å±•ä¸å¥½ã€‚é™¤äº†å› ä¸ºæ˜¯è§£é‡Šå‹è¯­è¨€ï¼ŒPython è¿˜æ”¶åˆ°å…¨å±€è§£é‡Šå™¨é”ï¼ŒGILã€‚
è¿™å°±æ„å‘³ç€ï¼Œå¦‚æœä½ ä¼ å…¥ä¸€ä¸ª <code>lambda</code> æˆ–è€… <code>Python</code> è‡ªå®šä¹‰å‡½æ•°ï¼Œ<code>Polars</code> é€Ÿåº¦ä¼šè¢«é™åˆ¶ï¼Œå³
æ— æ³•ä½¿ç”¨å¤šæ ¸è¿›è¡Œå¹¶è¡Œè®¡ç®—ã€‚</p>
<p>è¿™æ˜¯ä¸ªå¾ˆç³Ÿç³•çš„æƒ…å†µï¼Œç‰¹åˆ«æˆ‘ä»¬åœ¨åš <code>.groupby</code> çš„æ—¶å€™ä¼šç»å¸¸ä¼ å…¥ <code>lambda</code> å‡½æ•°ã€‚è™½ç„¶ <code>Polars</code>
æ”¯æŒè¿™ç§æ“ä½œï¼Œä½†æ˜¯è¯·æ³¨æ„ Python çš„é™åˆ¶ï¼Œç‰¹åˆ«æ˜¯è§£é‡Šå™¨å’ŒGILã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<code>Polars</code> å®ç°äº†ä¸€ç§éå¸¸å¼ºå¤§çš„è¯­æ³•ï¼Œä¸ä»…å¯ä»¥ç”¨åœ¨æƒ°æ€§APIï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨é¥¥é¥¿APIã€‚</p>
<h2 id="polars-expressions"><a class="header" href="#polars-expressions">Polars Expressions</a></h2>
<p>åˆšæ‰æˆ‘ä»¬æåˆ°è‡ªå®šä¹‰ Python å‡½æ•°ä¼šæŸä¼¤å¹¶è¡Œèƒ½åŠ›ï¼Œ<code>Polars</code> æä¾›äº†æƒ°æ€§ API æ¥åº”å¯¹è¿™ç§æƒ…å†µã€‚æ¥ä¸‹æ¥
æˆ‘ä»¬çœ‹çœ‹è¿™æ˜¯ä»€ä¹ˆæ„æ€ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä»è¿™ä¸ªæ•°æ®é›†å¼€å§‹ï¼š<a href="https://github.com/unitedstates/congress-legislators">US congress dataset</a>.</p>
<pre><code class="language-python">import polars as pl

from .dataset import dataset

q = (
    dataset.lazy()
    .groupby(&quot;first_name&quot;)
    .agg(
        [
            pl.count(),
            pl.col(&quot;gender&quot;).list(),
            pl.first(&quot;last_name&quot;),
        ]
    )
    .sort(&quot;count&quot;, reverse=True)
    .limit(5)
)

df = q.collect()
</code></pre>
<h4 id="åŸºæœ¬èšåˆæ“ä½œ"><a class="header" href="#åŸºæœ¬èšåˆæ“ä½œ">åŸºæœ¬èšåˆæ“ä½œ</a></h4>
<p>ä½ å¯ä»¥è½»æ¾åœ°æŠŠå¤šä¸ªèšåˆè¡¨è¾¾å¼æ”¾åœ¨ä¸€ä¸ª <code>list</code> é‡Œé¢ï¼Œå¹¶æ²¡æœ‰é•¿åº¦é™åˆ¶ï¼Œä½ æ”¾å…¥ä»»ä½•æ•°é‡çš„è¡¨è¾¾å¼ã€‚
ä¸‹é¢è¿™æ®µä»£ç ä¸­æˆ‘ä»¬åšå¦‚ä¸‹èšåˆæ“ä½œï¼š</p>
<p>å¯¹äºæ¯ä¸€ä¸ª <code>first_name</code> åˆ†ç»„ï¼š</p>
<ul>
<li>ç»Ÿè®¡æ¯ç»„çš„è¡Œæ•°ï¼š
<ul>
<li>çŸ­ç‰ˆï¼š<code>pl.count(&quot;party&quot;)</code></li>
<li>é•¿ç‰ˆï¼š<code>pl.col(&quot;party&quot;).count()</code></li>
</ul>
</li>
<li>æŠŠæ¯ç»„çš„æ€§åˆ«æ”¾å…¥ä¸€ä¸ªåˆ—è¡¨:
<ul>
<li>é•¿ç‰ˆï¼š <code>pl.col(&quot;gender&quot;).list()</code></li>
</ul>
</li>
<li>æ‰¾åˆ°æ¯ç»„çš„ç¬¬ä¸€ä¸ª <code>last_name</code>ï¼š
<ul>
<li>çŸ­ç‰ˆ: <code>pl.first(&quot;last_name&quot;)</code></li>
<li>é•¿ç‰ˆ: <code>pl.col(&quot;last_name&quot;).first()</code></li>
</ul>
</li>
</ul>
<p>Besides the aggregation, we immediately sort the result and limit to the top <code>5</code> so that
we have a nice summary overview.</p>
<pre><code class="language-python">import polars as pl

from .dataset import dataset

q = (
    dataset.lazy()
    .groupby(&quot;first_name&quot;)
    .agg(
        [
            pl.count(),
            pl.col(&quot;gender&quot;).list(),
            pl.first(&quot;last_name&quot;),
        ]
    )
    .sort(&quot;count&quot;, reverse=True)
    .limit(5)
)

df = q.collect()
</code></pre>
<pre><code class="language-text">shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ first_name â”† count â”† gender              â”† last_name â”‚
â”‚ ---        â”† ---   â”† ---                 â”† ---       â”‚
â”‚ cat        â”† u32   â”† list[cat]           â”† str       â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ John       â”† 1254  â”† [&quot;M&quot;, &quot;M&quot;, ... &quot;M&quot;] â”† Walker    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ William    â”† 1022  â”† [&quot;M&quot;, &quot;M&quot;, ... &quot;M&quot;] â”† Few       â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ James      â”† 712   â”† [&quot;M&quot;, &quot;M&quot;, ... &quot;M&quot;] â”† Armstrong â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Thomas     â”† 453   â”† [&quot;M&quot;, &quot;M&quot;, ... &quot;M&quot;] â”† Tucker    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Charles    â”† 439   â”† [&quot;M&quot;, &quot;M&quot;, ... &quot;M&quot;] â”† Carroll   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 id="æ¡ä»¶"><a class="header" href="#æ¡ä»¶">æ¡ä»¶</a></h4>
<p>ç®€å•å§ï¼æˆ‘ä»¬åŠ ç‚¹æ–™ï¼å‡è®¾æˆ‘ä»¬æƒ³è¦çŸ¥é“å¯¹äºæ¯ä¸ª <code>state</code> æœ‰å¤šå°‘ <code>Pro</code> å’Œ <code>Anti</code>ã€‚æˆ‘ä»¬å¯ä»¥
ä¸ç”¨ <code>lambda</code> è€Œç›´æ¥æŸ¥è¯¢ã€‚</p>
<pre><code class="language-python">import polars as pl

from .dataset import dataset

q = (
    dataset.lazy()
    .groupby(&quot;state&quot;)
    .agg(
        [
            (pl.col(&quot;party&quot;) == &quot;Anti-Administration&quot;).sum().alias(&quot;anti&quot;),
            (pl.col(&quot;party&quot;) == &quot;Pro-Administration&quot;).sum().alias(&quot;pro&quot;),
        ]
    )
    .sort(&quot;pro&quot;, reverse=True)
    .limit(5)
)

df = q.collect()
</code></pre>
<pre><code class="language-text">shape: (5, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ state â”† anti â”† pro â”‚
â”‚ ---   â”† ---  â”† --- â”‚
â”‚ cat   â”† u32  â”† u32 â”‚
â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ CT    â”† 0    â”† 3   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ NJ    â”† 0    â”† 3   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ NC    â”† 1    â”† 2   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ SC    â”† 0    â”† 1   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ MA    â”† 0    â”† 1   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šå±‚èšåˆå®ç°ï¼Œä½†æ˜¯è¿™ä¸åˆ©äºæˆ‘æ˜¾æ‘†è¿™äº›å¾ˆé…·çš„ç‰¹å¾ğŸ˜‰ï¼</p>
<pre><code class="language-python">import polars as pl

from .dataset import dataset

q = (
    dataset.lazy()
    .groupby([&quot;state&quot;, &quot;party&quot;])
    .agg([pl.count(&quot;party&quot;).alias(&quot;count&quot;)])
    .filter((pl.col(&quot;party&quot;) == &quot;Anti-Administration&quot;) | (pl.col(&quot;party&quot;) == &quot;Pro-Administration&quot;))
    .sort(&quot;count&quot;, reverse=True)
    .limit(5)
)

df = q.collect()
</code></pre>
<pre><code class="language-text">shape: (5, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ state â”† party               â”† count â”‚
â”‚ ---   â”† ---                 â”† ---   â”‚
â”‚ cat   â”† cat                 â”† u32   â”‚
â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ CT    â”† Pro-Administration  â”† 3     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ NJ    â”† Pro-Administration  â”† 3     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ VA    â”† Anti-Administration â”† 3     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ NC    â”† Pro-Administration  â”† 2     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ PA    â”† Anti-Administration â”† 1     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 id="è¿‡æ»¤"><a class="header" href="#è¿‡æ»¤">è¿‡æ»¤</a></h4>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿‡æ»¤åˆ†ç»„ã€‚å‡è®¾æˆ‘ä»¬æƒ³è¦è®¡ç®—æ¯ç»„çš„å‡å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸å¸Œæœ›è®¡ç®—æ‰€æœ‰å€¼çš„å‡å€¼ï¼Œæˆ‘ä»¬ä¹Ÿä¸å¸Œæœ›ç›´æ¥
ä» <code>DataFrame</code> è¿‡æ»¤ï¼Œå› ä¸ºæˆ‘ä»¬åéœ€è¿˜éœ€è¦å“ªäº›è¡Œåšå…¶ä»–æ“ä½œã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­è¯´æ˜æˆ‘ä»¬æ˜¯å¦‚ä½•åšåˆ°çš„ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬å¯ä»¥å†™æ˜ <code>Python</code> çš„è‡ªå®šä¹‰å‡½æ•°ï¼Œè¿™äº›å‡½æ•°æ²¡æœ‰ä»€ä¹ˆ
è¿è¡Œæ—¶å¼€é”€ã€‚å› ä¸ºè¿™äº›å‡½æ•°è¿”å›äº† <code>Polars</code> è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¹¶æ²¡åœ¨è¿è¡Œæ—¶è®© <code>Series</code> è°ƒç”¨è‡ªåŠ¨å‡½æ•°ã€‚</p>
<pre><code class="language-python">from datetime import date

import polars as pl

from .dataset import dataset


def compute_age() -&gt; pl.Expr:
    return date(2021, 1, 1).year - pl.col(&quot;birthday&quot;).dt.year()


def avg_birthday(gender: str) -&gt; pl.Expr:
    return compute_age().filter(pl.col(&quot;gender&quot;) == gender).mean().alias(f&quot;avg {gender} birthday&quot;)


q = (
    dataset.lazy()
    .groupby([&quot;state&quot;])
    .agg(
        [
            avg_birthday(&quot;M&quot;),
            avg_birthday(&quot;F&quot;),
            (pl.col(&quot;gender&quot;) == &quot;M&quot;).sum().alias(&quot;# male&quot;),
            (pl.col(&quot;gender&quot;) == &quot;F&quot;).sum().alias(&quot;# female&quot;),
        ]
    )
    .limit(5)
)

df = q.collect()
</code></pre>
<pre><code class="language-text">shape: (5, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ state â”† avg M birthday â”† avg F birthday â”† # male â”† # female â”‚
â”‚ ---   â”† ---            â”† ---            â”† ---    â”† ---      â”‚
â”‚ cat   â”† f64            â”† f64            â”† u32    â”† u32      â”‚
â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•¡
â”‚ NH    â”† 203.096591     â”† 61.0           â”† 179    â”† 2        â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ TX    â”† 132.440154     â”† 88.0           â”† 260    â”† 4        â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ WY    â”† 137.717949     â”† 75.0           â”† 39     â”† 1        â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ NY    â”† 186.016887     â”† 96.95          â”† 1449   â”† 20       â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ AR    â”† 154.073394     â”† 121.4          â”† 112    â”† 5        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 id="æ’åº"><a class="header" href="#æ’åº">æ’åº</a></h4>
<p>æˆ‘ä»¬ç»å¸¸æŠŠä¸€ä¸ª <code>DataFrame</code> æ’åºä¸ºäº†åœ¨åˆ†ç»„æ“ä½œçš„æ—¶å€™ä¿æŒæŸç§é¡ºåºã€‚å‡è®¾æˆ‘ä»¬æˆ‘ä»¬å¸Œæœ›çŸ¥é“
æ¯ä¸ª <code>state</code> æ”¿æ²»å®¶çš„åå­—ï¼Œå¹¶æŒ‰ç…§å¹´é¾„æ’åºã€‚æˆ‘ä»¬å¯ä»¥ç”¨ <code>sort</code> å’Œ <code>groupby</code>ï¼š</p>
<pre><code class="language-python">import polars as pl

from .dataset import dataset


def get_person() -&gt; pl.Expr:
    return pl.col(&quot;first_name&quot;) + pl.lit(&quot; &quot;) + pl.col(&quot;last_name&quot;)


q = (
    dataset.lazy()
    .sort(&quot;birthday&quot;)
    .groupby([&quot;state&quot;])
    .agg(
        [
            get_person().first().alias(&quot;youngest&quot;),
            get_person().last().alias(&quot;oldest&quot;),
        ]
    )
    .limit(5)
)

df = q.collect()
</code></pre>
<pre><code class="language-text">shape: (5, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ state â”† youngest          â”† oldest            â”‚
â”‚ ---   â”† ---               â”† ---               â”‚
â”‚ cat   â”† str               â”† str               â”‚
â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ WY    â”† Stephen Nuckolls  â”† Barbara Cubin     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ PA    â”† Thomas Fitzsimons â”† Ryan Costello     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ ND    â”† Lyman Casey       â”† Rick Berg         â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ VI    â”† Melvin Evans      â”† Donna Christensen â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ AS    â”† FofÃ³ Sunia        â”† Eni Faleomavaega  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>ä½†æ˜¯ï¼Œ<strong>å¦‚æœ</strong>æˆ‘ä»¬æƒ³æŠŠåå­—ä¹ŸæŒ‰ç…§å­—æ¯æ’åºï¼Œä¸Šé¢çš„ä»£ç å°±ä¸è¡Œäº†ã€‚
å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>groupby</code> ä¸Šä¸‹æ–‡ä¸­è¿›è¡Œæ’åºï¼Œä¸ <code>DataFrame</code> æ— å…³ã€‚</p>
<pre><code class="language-python">import polars as pl

from .dataset import dataset


def get_person() -&gt; pl.Expr:
    return pl.col(&quot;first_name&quot;) + pl.lit(&quot; &quot;) + pl.col(&quot;last_name&quot;)


q = (
    dataset.lazy()
    .sort(&quot;birthday&quot;)
    .groupby([&quot;state&quot;])
    .agg(
        [
            get_person().first().alias(&quot;youngest&quot;),
            get_person().last().alias(&quot;oldest&quot;),
            get_person().sort().first().alias(&quot;alphabetical_first&quot;),
        ]
    )
    .limit(5)
)

df = q.collect()
</code></pre>
<pre><code class="language-text">shape: (5, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ state â”† youngest        â”† oldest           â”† alphabetical_first â”‚
â”‚ ---   â”† ---             â”† ---              â”† ---                â”‚
â”‚ cat   â”† str             â”† str              â”† str                â”‚
â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ KY    â”† John Edwards    â”† Ben Chandler     â”† Aaron Harding      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ FL    â”† Charles Downing â”† Patrick Murphy   â”† Abijah Gilbert     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ LA    â”† Jean DestrÃ©han  â”† Vance McAllister â”† Adolph Meyer       â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ MO    â”† Spencer Pettis  â”† Russ Carnahan    â”† Abram Comingo      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ OH    â”† John Smith      â”† John Boccieri    â”† Aaron Harlan       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>æˆ‘ä»¬ç”šè‡³å¯ä»¥åœ¨ <code>groupby</code> ä¸Šä¸‹æ–‡ä¸­å¢åŠ å¦ä¸€ä¸ªåˆ—ï¼Œå¹¶ä¸”æŒ‰ç…§ç”·å¥³æ’åºï¼š
<code>pl.col(&quot;gender&quot;).sort_by(&quot;first_name&quot;).first().alias(&quot;gender&quot;)</code></p>
<pre><code class="language-python">import polars as pl

from .dataset import dataset


def get_person() -&gt; pl.Expr:
    return pl.col(&quot;first_name&quot;) + pl.lit(&quot; &quot;) + pl.col(&quot;last_name&quot;)


q = (
    dataset.lazy()
    .sort(&quot;birthday&quot;)
    .groupby([&quot;state&quot;])
    .agg(
        [
            get_person().first().alias(&quot;youngest&quot;),
            get_person().last().alias(&quot;oldest&quot;),
            get_person().sort().first().alias(&quot;alphabetical_first&quot;),
            pl.col(&quot;gender&quot;).sort_by(&quot;first_name&quot;).first().alias(&quot;gender&quot;),
        ]
    )
    .sort(&quot;state&quot;)
    .limit(5)
)

df = q.collect()
</code></pre>
<pre><code class="language-text">shape: (5, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ state â”† youngest          â”† oldest         â”† alphabetical_first â”† gender â”‚
â”‚ ---   â”† ---               â”† ---            â”† ---                â”† ---    â”‚
â”‚ cat   â”† str               â”† str            â”† str                â”† cat    â”‚
â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ DE    â”† Samuel White      â”† John Carney    â”† Albert Polk        â”† M      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ VA    â”† William Grayson   â”† Scott Taylor   â”† Abraham Venable    â”† M      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ SC    â”† Ralph Izard       â”† Joe Cunningham â”† Abraham Nott       â”† M      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ MD    â”† Benjamin Contee   â”† Frank Kratovil â”† Albert Blakeney    â”† M      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ PA    â”† Thomas Fitzsimons â”† Ryan Costello  â”† Aaron Kreider      â”† M      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="ç»“è®º-1"><a class="header" href="#ç»“è®º-1">ç»“è®º</a></h3>
<p>ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬çŸ¥é“é€šè¿‡ç»„åˆè¡¨è¾¾å¼å¯ä»¥å®Œæˆå¤æ‚çš„æŸ¥è¯¢ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬é¿å…äº†ä½¿ç”¨è‡ªå®šä¹‰ <code>Python</code> å‡½æ•°
å¸¦æ¥çš„æ€§èƒ½æŸå¤± ï¼ˆè§£é‡Šå™¨å’Œ GILï¼‰ã€‚</p>
<p>å¦‚æœè¿™é‡Œå°‘äº†å“ªç±»è¡¨è¾¾å¼ï¼Œæ¸…åœ¨è¿™é‡Œå¼€ä¸€ä¸ª Issueï¼š
<a href="https://github.com/pola-rs/polars/issues/new/choose">feature request</a>!</p>
<h1 id="folds"><a class="header" href="#folds">Folds</a></h1>
<p><code>Polars</code> æä¾›äº†æ¨ªå‘è¡¨è¾¾å¼æˆ–è€…æ–¹æ³•ï¼Œæ¯”å¦‚<a href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.sum.html"><code>sum</code></a>,
<a href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.min.html"><code>min</code></a>, <a href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.mean.html"><code>mean</code></a> ç­‰ç­‰ï¼Œ
æˆ‘ä»¬åªéœ€è¦è®¾ç½® <code>axis=1</code> å³å¯å®ç°æ¨ªå‘èšåˆã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬éœ€è¦å¤æ‚çš„èšåˆæ¨¡å¼æ—¶ï¼Œ<code>Polars</code> æä¾›çš„åŸºæœ¬å‡½æ•°å¯èƒ½ä¸èƒ½èƒœä»»ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ <code>fold</code> å‡½æ•°ã€‚</p>
<p><code>fold</code> å‡½æ•°åœ¨åˆ—æ–¹å‘çš„æ€§èƒ½æœ€ä½³ï¼Œå®ƒå¾ˆå¥½çš„åˆ©ç”¨äº†æ•°æ®çš„å†…å­˜æ ¼å±€ï¼Œé€šå¸¸è¿˜ä¼šä¼´éšå‘é‡åŒ–æ“ä½œã€‚</p>
<p>è®©æˆ‘ä»¬é€šè¿‡é‡Œä¸€ä¸ªä¾‹å­çœ‹çœ‹å¦‚ä½•å—ä½¿ç”¨ <code>fold</code> å®ç° <code>sum</code> å‡½æ•°ã€‚</p>
<h2 id="æ‰‹å·¥-sum"><a class="header" href="#æ‰‹å·¥-sum">æ‰‹å·¥ <code>sum</code></a></h2>
<pre><code class="language-python">
out = df.select(
    pl.fold(acc=pl.lit(0), f=lambda acc, x: acc + x, exprs=pl.col(&quot;*&quot;)).alias(&quot;sum&quot;),
)
print(out)
</code></pre>
<pre><code class="language-text">shape: (3, 1)
â”Œâ”€â”€â”€â”€â”€â”
â”‚ sum â”‚
â”‚ --- â”‚
â”‚ i64 â”‚
â•â•â•â•â•â•â•¡
â”‚ 11  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 22  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 33  â”‚
â””â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå‡½æ•° <code>f(acc, x) -&gt; acc</code> è¢«åå¤è°ƒç”¨å¹¶æŠŠç»“æœç´¯åŠ åˆ° <code>acc</code> å˜é‡ï¼Œæœ€ç»ˆæŠŠç»“æœæ”¾å…¥ x åˆ—ã€‚
è¿™ä¸ªå‡½æ•°æŒ‰ç…§åˆ—æ‰§è¡Œï¼Œå¹¶ä¸”å……åˆ†åˆ©ç”¨äº†ç¼“å­˜å’Œå‘é‡åŒ–æ“ä½œã€‚</p>
<h2 id="æ¡ä»¶è¯­å¥"><a class="header" href="#æ¡ä»¶è¯­å¥">æ¡ä»¶è¯­å¥</a></h2>
<p>å½“æˆ‘ä»¬å¸Œæœ›å¯¹ä¸€ä¸ª <code>DataFrame</code> çš„æ‰€æœ‰åˆ—æ˜¯æ–½åŠ æ¡ä»¶è¯­å¥çš„æ—¶å€™ï¼Œé‡‡ç”¨ <code>fold</code> å°±éå¸¸ç®€æ´ã€‚</p>
<pre><code class="language-python">
out = df.filter(
    pl.fold(
        acc=pl.lit(True),
        f=lambda acc, x: acc &amp; x,
        exprs=pl.col(&quot;*&quot;) &gt; 1,
    )
)
print(out)
</code></pre>
<pre><code class="language-text">shape: (1, 2)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ a   â”† b   â”‚
â”‚ --- â”† --- â”‚
â”‚ i64 â”† i64 â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ 3   â”† 2   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©æ‰€æœ‰è¡Œï¼Œè¿™äº›è¡Œçš„æ¯ä¸€åˆ—éƒ½å¤§äº 1ã€‚</p>
<h2 id="fold-å’Œ-å­—ç¬¦ä¸²æ•°æ®"><a class="header" href="#fold-å’Œ-å­—ç¬¦ä¸²æ•°æ®"><code>fold</code> å’Œ å­—ç¬¦ä¸²æ•°æ®</a></h2>
<p>Fold å¯ä»¥ç”¨æ¥è¿æ¥å­—ç¬¦ä¸²ã€‚ä½†æ˜¯ç”±äºè¿™ä¸ªæ“ä½œä¼šäº§ç”Ÿä¸€äº›ä¸­é—´ç»“æœï¼Œè¿™ä¸ªæ“ä½œæ˜¯ <code>O(n^2)</code> çš„æ—¶é—´å¤æ‚åº¦ã€‚
å› æ­¤ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ <code>concat_str</code> è¡¨è¾¾å¼ã€‚</p>
<pre><code class="language-python">df = pl.DataFrame({&quot;a&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], &quot;b&quot;: [1, 2, 3]})

out = df.select(
    [
        pl.concat_str([&quot;a&quot;, &quot;b&quot;]),
    ]
)
print(out)
</code></pre>
<pre><code class="language-text">shape: (3, 1)
â”Œâ”€â”€â”€â”€â”€â”
â”‚ a   â”‚
â”‚ --- â”‚
â”‚ str â”‚
â•â•â•â•â•â•â•¡
â”‚ a1  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ b2  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ c3  â”‚
â””â”€â”€â”€â”€â”€â”˜
</code></pre>
<h1 id="çª—å£å‡½æ•°-"><a class="header" href="#çª—å£å‡½æ•°-">çª—å£å‡½æ•° ğŸš€ğŸš€</a></h1>
<p>çª—å£å‡½æ•°æ˜¯ä¸€ç§å¼ºå¤§çš„è¡¨è¾¾å¼ã€‚å®ƒå¯ä»¥è®©ç”¨æˆ·åœ¨ <code>select</code> ä¸Šä¸‹æ–‡ä¸­åˆ†ç»„è¿›è¡Œç±»èšã€‚
è®©æˆ‘ä»¬é€šè¿‡ä¾‹å­çœ‹çœ‹è¿™æ˜¯ä»€ä¹ˆæ„æ€ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œè¿™ä¸ªæ•°æ®åŒ…å«å¦‚ä¸‹åˆ—ï¼Œåˆ†åˆ«ä»£è¡¨å£è¢‹å¦–æ€ªçš„ä¸€äº›ä¿¡æ¯ï¼š</p>
<p><code>['#',  'Name',  'Type 1',  'Type 2',  'Total',  'HP',  'Attack',  'Defense',  'Sp. Atk',  'Sp. Def',  'Speed',  'Generation',  'Legendary']</code></p>
<pre><code class="language-python">import polars as pl

# ç„¶åï¼Œè®©æˆ‘ä»¬åŠ è½½ä¸€äº›åŒ…pokemonä¿¡æ¯çš„csvæ•°æ®
df = pl.read_csv(
    &quot;https://gist.githubusercontent.com/ritchie46/cac6b337ea52281aa23c049250a4ff03/raw/89a957ff3919d90e6ef2d34235e6bf22304f3366/pokemon.csv&quot;
)
</code></pre>
<pre><code class="language-text">shape: (163, 13)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ #   â”† Name                  â”† Type 1  â”† Type 2 â”† ... â”† Sp. Def â”† Speed â”† Generation â”† Legendary â”‚
â”‚ --- â”† ---                   â”† ---     â”† ---    â”†     â”† ---     â”† ---   â”† ---        â”† ---       â”‚
â”‚ i64 â”† str                   â”† str     â”† str    â”†     â”† i64     â”† i64   â”† i64        â”† bool      â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 1   â”† Bulbasaur             â”† Grass   â”† Poison â”† ... â”† 65      â”† 45    â”† 1          â”† false     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2   â”† Ivysaur               â”† Grass   â”† Poison â”† ... â”† 80      â”† 60    â”† 1          â”† false     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 3   â”† Venusaur              â”† Grass   â”† Poison â”† ... â”† 100     â”† 80    â”† 1          â”† false     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 3   â”† VenusaurMega Venusaur â”† Grass   â”† Poison â”† ... â”† 120     â”† 80    â”† 1          â”† false     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ ... â”† ...                   â”† ...     â”† ...    â”† ... â”† ...     â”† ...   â”† ...        â”† ...       â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 147 â”† Dratini               â”† Dragon  â”† null   â”† ... â”† 50      â”† 50    â”† 1          â”† false     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 148 â”† Dragonair             â”† Dragon  â”† null   â”† ... â”† 70      â”† 70    â”† 1          â”† false     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 149 â”† Dragonite             â”† Dragon  â”† Flying â”† ... â”† 100     â”† 80    â”† 1          â”† false     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 150 â”† Mewtwo                â”† Psychic â”† null   â”† ... â”† 90      â”† 130   â”† 1          â”† true      â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 id="groupby-ç±»èš"><a class="header" href="#groupby-ç±»èš">Groupby ç±»èš</a></h2>
<p>ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç”¨çª—å£å‡½æ•°å¯¹ä¸åŒçš„åˆ—åˆ†ç»„å¹¶ä¸”ç±»èšã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªæ½®æ±›ä¸­ï¼Œå¹¶è¡Œçš„è¿è¡Œå¤šä¸ªåˆ†ç»„æ“ä½œã€‚
ç±»èšçš„ç»“æœä¼šæŠ•å°„ä¼šåŸæœ‰çš„è¡Œã€‚å› æ­¤ï¼Œçª—å£å‡½æ•°æ°¸è¿œè¿”å›ä¸€ä¸ªè·ŸåŸæœ‰ <code>DataFrame</code> ä¸€æ ·è§„æ ¼çš„ <code>DataFrame</code>ã€‚</p>
<p>æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>.over(&quot;Type 1&quot;)</code> å’Œ <code>.over([&quot;Type 1&quot;, &quot;Type 2&quot;])</code>ï¼Œåˆ©ç”¨çª—å£å‡½æ•°æˆ‘ä»¬å¯ä»¥ä¸€ä¸ª
<code>select</code> è¯­å¢ƒä¸­å®ç°å¤šä¸ªåˆ†ç»„ç±»èšã€‚</p>
<p>æ›´å¥½çš„æ˜¯ï¼Œè®¡ç®—è¿‡çš„åˆ†ç»„ä¼šè¢«ç¼“å­˜å¹¶ä¸”åœ¨ä¸åŒçš„çª—å£å‡½æ•°ä¸­å…±äº«ã€‚</p>
<pre><code class="language-python">
out = df.select(
    [
        &quot;Type 1&quot;,
        &quot;Type 2&quot;,
        pl.col(&quot;Attack&quot;).mean().over(&quot;Type 1&quot;).alias(&quot;avg_attack_by_type&quot;),
        pl.col(&quot;Defense&quot;).mean().over([&quot;Type 1&quot;, &quot;Type 2&quot;]).alias(&quot;avg_defense_by_type_combination&quot;),
        pl.col(&quot;Attack&quot;).mean().alias(&quot;avg_attack&quot;),
    ]
)
</code></pre>
<pre><code class="language-text">shape: (163, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Type 1  â”† Type 2 â”† avg_attack_by_type â”† avg_defense_by_type_combination â”† avg_attack â”‚
â”‚ ---     â”† ---    â”† ---                â”† ---                             â”† ---        â”‚
â”‚ str     â”† str    â”† f64                â”† f64                             â”† f64        â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ Grass   â”† Poison â”† 72.923077          â”† 67.8                            â”† 75.349693  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Grass   â”† Poison â”† 72.923077          â”† 67.8                            â”† 75.349693  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Grass   â”† Poison â”† 72.923077          â”† 67.8                            â”† 75.349693  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Grass   â”† Poison â”† 72.923077          â”† 67.8                            â”† 75.349693  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ ...     â”† ...    â”† ...                â”† ...                             â”† ...        â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Dragon  â”† null   â”† 94.0               â”† 55.0                            â”† 75.349693  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Dragon  â”† null   â”† 94.0               â”† 55.0                            â”† 75.349693  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Dragon  â”† Flying â”† 94.0               â”† 95.0                            â”† 75.349693  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Psychic â”† null   â”† 53.875             â”† 51.428571                       â”† 75.349693  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 id="åˆ†ç»„æ“ä½œ"><a class="header" href="#åˆ†ç»„æ“ä½œ">åˆ†ç»„æ“ä½œ</a></h2>
<p>çª—å£å‡½æ•°ä¸ä»…ä»…å¯ä»¥ç±»èšï¼Œè¿˜å¯ä»¥ç”¨æ¥æŒ‰ç…§ç»„æ–½åŠ è‡ªå®šä¹‰å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³è¦åœ¨æŸä¸€ç»„ä¸­æ’åºï¼Œä½ å¯ä»¥ï¼š
<code>.col(&quot;value&quot;).sort().over(&quot;group&quot;)</code>ã€‚</p>
<p>è®©æˆ‘ä»¬è¯•ç€è¿‡æ»¤ä¸€äº›è¡Œï¼š</p>
<pre><code class="language-python">filtered = df.filter(pl.col(&quot;Type 2&quot;) == &quot;Psychic&quot;).select(
    [
        &quot;Name&quot;,
        &quot;Type 1&quot;,
        &quot;Speed&quot;,
    ]
)
print(filtered)
</code></pre>
<pre><code class="language-text">shape: (7, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Name                â”† Type 1 â”† Speed â”‚
â”‚ ---                 â”† ---    â”† ---   â”‚
â”‚ str                 â”† str    â”† i64   â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ Slowpoke            â”† Water  â”† 15    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Slowbro             â”† Water  â”† 30    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ SlowbroMega Slowbro â”† Water  â”† 30    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Exeggcute           â”† Grass  â”† 40    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Exeggutor           â”† Grass  â”† 55    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Starmie             â”† Water  â”† 115   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Jynx                â”† Ice    â”† 95    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>æ³¨æ„åˆ°ï¼Œåˆ†ç»„ <code>Water</code> çš„åˆ— <code>Type 1</code> å¹¶ä¸è¿ç»­ï¼Œä¸­é—´æœ‰ä¸¤è¡Œ <code>Grass</code>ã€‚è€Œä¸”ï¼ŒåŒç»„ä¸­çš„æ¯ä¸€ä¸ªå£è¢‹å¦–è‚¡
è¢«æŒ‰ç…§ <code>Speed</code> å‡åºæ’åˆ—ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªä¾‹å­æˆ‘ä»¬å¸Œæœ›é™åºæ’åˆ—ï¼Œå¹¸è¿çš„æ˜¯ï¼Œè¿™å¾ˆç®€å•ï¼š</p>
<pre><code class="language-python">out = filtered.with_columns(
    [
        pl.col([&quot;Name&quot;, &quot;Speed&quot;]).sort(reverse=True).over(&quot;Type 1&quot;),
    ]
)
print(out)
</code></pre>
<pre><code class="language-text">shape: (7, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Name                â”† Type 1 â”† Speed â”‚
â”‚ ---                 â”† ---    â”† ---   â”‚
â”‚ str                 â”† str    â”† i64   â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ Starmie             â”† Water  â”† 115   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Slowpoke            â”† Water  â”† 30    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ SlowbroMega Slowbro â”† Water  â”† 30    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Exeggutor           â”† Grass  â”† 55    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Exeggcute           â”† Grass  â”† 40    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Slowbro             â”† Water  â”† 15    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Jynx                â”† Ice    â”† 95    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><code>Polars</code> ä¼šè¿½è¸ªæ¯ä¸ªç»„çš„ä½ç½®ï¼Œå¹¶æŠŠç›¸åº”çš„è¡¨è¾¾å¼æ˜ å°„åˆ°é€‚å½“çš„è¡Œã€‚è¿™ä¸ªæ“ä½œå¯ä»¥åœ¨ä¸€ä¸ª select ç¯å¢ƒä¸­å®Œæˆã€‚</p>
<p>çª—å£å‡½æ•°çš„å¼ºå¤§ä¹‹å¤„åœ¨äºï¼šä½ é€šå¸¸ä¸éœ€è¦ <code>groupby -&gt; explode</code> ç»„åˆï¼Œè€Œæ˜¯æŠŠé€»è¾‘æ”¾å…¥ä¸€ä¸ªè¡¨è¾¾å¼ä¸­ã€‚
è¿™ä¹Ÿä½¿å¾— API æ›´åŠ ç®€æ´ï¼š</p>
<ul>
<li><code>groupby</code> -&gt; æ ‡è®°ç±»èšçš„åˆ†ç»„ï¼Œè¿”å›ä¸€ä¸ªè·Ÿç»„çš„ä¸ªæ•°ä¸€è‡´çš„ <code>DataFrame</code></li>
<li><code>over</code> -&gt; æ ‡è®°æˆ‘ä»¬å¸Œæœ›å¯¹è¿™ä¸ªåˆ†ç»„è¿›è¡Œè®¡ç®—ï¼Œä½†æ˜¯ä¸ä¼šæ›´æ”¹åŸæœ‰ <code>DataFrame</code> çš„å½¢çŠ¶</li>
</ul>
<h2 id="çª—å£è¡¨è¾¾å¼çš„è§„åˆ™"><a class="header" href="#çª—å£è¡¨è¾¾å¼çš„è§„åˆ™">çª—å£è¡¨è¾¾å¼çš„è§„åˆ™</a></h2>
<p>çª—å£è¡¨è¾¾å¼çš„è®¡ç®—è§„åˆ™å¦‚ä¸‹ï¼ˆå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª <code>pl.Int32</code> åˆ—ï¼‰ï¼š</p>
<pre><code class="language-python"># åˆ†ç»„å†…ç±»èšä¸”å¹¿æ’­
# è¾“å‡ºç±»å‹: -&gt; Int32
pl.sum(&quot;foo&quot;).over(&quot;groups&quot;)

# ç»„å†…åŠ å’Œï¼Œç„¶åä¹˜ä»¥ç»„å†…çš„å…ƒç´ 
# è¾“å‡ºç±»å‹: -&gt; Int32
(pl.col(&quot;x&quot;).sum() * pl.col(&quot;y&quot;)).over(&quot;groups&quot;)

# ç»„å†…åŠ å’Œï¼Œç„¶åä¹˜ä»¥ç»„å†…çš„å…ƒç´ 
# å¹¶ä¸”ç»„å†…ç±»èšæˆä¸€ä¸ªåˆ—è¡¨
# è¾“å‡ºç±»å‹: -&gt; List(Int32)
(pl.col(&quot;x&quot;).sum() * pl.col(&quot;y&quot;)).list().over(&quot;groups&quot;)

# æ³¨æ„è¿™é‡Œéœ€è¦ä¸€ä¸ªæ˜¾å¼çš„ `list` è°ƒç”¨
# ç»„å†…åŠ å’Œï¼Œç„¶åä¹˜ä»¥ç»„å†…çš„å…ƒç´ 
# å¹¶ä¸”ç»„å†…ç±»èšæˆä¸€ä¸ªåˆ—è¡¨
# list() ä¼šå±•å¼€

# å¦‚æœç»„å†…æ˜¯æœ‰åºçš„ï¼Œè¿™æ˜¯æœ€å¿«çš„æ“ä½œæ–¹æ³•ï¼š
(pl.col(&quot;x&quot;).sum() * pl.col(&quot;y&quot;)).list().over(&quot;groups&quot;).flatten()
</code></pre>
<h2 id="more-examples"><a class="header" href="#more-examples">More examples</a></h2>
<p>æ›´å¤šç»ƒä¹ ï¼Œä¸‹é¢æ˜¯ä¸€äº›çª—å£å‡½æ•°ï¼š</p>
<ul>
<li>æŒ‰ç…§ <code>Type</code> ç»™æ‰€æœ‰å£è¢‹å¦–æ€ªæ’åº</li>
<li>é€‰æ‹©æ¯ç»„å‰ä¸‰ä¸ªå¦–æ€ª</li>
<li>æ¯ç»„æŒ‰ç…§é€Ÿåº¦æ’åºï¼Œå¹¶é€‰æ‹©å‰ä¸‰ä½œä¸º <code>&quot;fastest/group&quot;</code></li>
<li>æ¯ç»„æŒ‰ç…§æ”»å‡»æ’åºï¼Œå¹¶é€‰æ‹©å‰ä¸‰ä½œä¸º <code>&quot;strongest/group&quot;</code></li>
<li>æ¯ç»„æŒ‰ç…§åå­—æ’åºï¼Œå¹¶é€‰æ‹©å‰ä¸‰ä½œä¸º <code>&quot;sorted_by_alphabet&quot;</code></li>
</ul>
<pre><code class="language-python">
out = df.sort(&quot;Type 1&quot;).select(
    [
        pl.col(&quot;Type 1&quot;).head(3).list().over(&quot;Type 1&quot;).flatten(),
        pl.col(&quot;Name&quot;).sort_by(pl.col(&quot;Speed&quot;)).head(3).list().over(&quot;Type 1&quot;).flatten().alias(&quot;fastest/group&quot;),
        pl.col(&quot;Name&quot;).sort_by(pl.col(&quot;Attack&quot;)).head(3).list().over(&quot;Type 1&quot;).flatten().alias(&quot;strongest/group&quot;),
        pl.col(&quot;Name&quot;).sort().head(3).list().over(&quot;Type 1&quot;).flatten().alias(&quot;sorted_by_alphabet&quot;),
    ]
)
</code></pre>
<pre><code class="language-text">shape: (43, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Type 1 â”† fastest/group       â”† strongest/group â”† sorted_by_alphabet      â”‚
â”‚ ---    â”† ---                 â”† ---             â”† ---                     â”‚
â”‚ str    â”† str                 â”† str             â”† str                     â”‚
â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ Bug    â”† Paras               â”† Metapod         â”† Beedrill                â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Bug    â”† Metapod             â”† Kakuna          â”† BeedrillMega Beedrill   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Bug    â”† Parasect            â”† Caterpie        â”† Butterfree              â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Dragon â”† Dratini             â”† Dratini         â”† Dragonair               â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ ...    â”† ...                 â”† ...             â”† ...                     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Rock   â”† Omanyte             â”† Omastar         â”† Geodude                 â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Water  â”† Slowpoke            â”† Magikarp        â”† Blastoise               â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Water  â”† Slowbro             â”† Tentacool       â”† BlastoiseMega Blastoise â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ Water  â”† SlowbroMega Slowbro â”† Horsea          â”† Cloyster                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 id="å±•å¼€çª—å£å‡½æ•°"><a class="header" href="#å±•å¼€çª—å£å‡½æ•°">å±•å¼€çª—å£å‡½æ•°</a></h2>
<p>å°±åƒåˆšåˆšçš„ä¾‹å­ï¼Œå¦‚æœä½ çš„çª—å£å‡½æ•°è¿”å›ä¸€ä¸ª <code>list</code>ï¼š</p>
<p><code>pl.col(&quot;Name&quot;).sort_by(pl.col(&quot;Speed&quot;)).head(3).list().over(&quot;Type 1&quot;)</code></p>
<p>è¿™æ ·å¯ä»¥ï¼Œä½†æ˜¯è¿™æ ·ä¼šè¿”å›ä¸€ä¸ªç±»å‹ä¸º <code>List</code> çš„åˆ—ï¼Œè¿™å¯èƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œè€Œä¸”ä¼šå¢åŠ å†…å­˜ä½¿ç”¨ã€‚</p>
<p>è¿™æ˜¯æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ <code>flatten</code>ã€‚è¿™ä¸ªå‡½æ•°ä¼šæŠŠä¸€ä¸ª 2D åˆ—è¡¨è½¬æ¢æˆ 1Dï¼Œç„¶åæŠŠåˆ—æŠ•å°„åˆ°æˆ‘ä»¬çš„ <code>DataFrame</code>ã€‚
è¿™ä¸ªæ“ä½œéå¸¸å¿«ï¼Œå› ä¸º reshape åŸºæœ¬æ²¡æœ‰æˆæœ¬ï¼Œç»™åŸæœ‰ <code>DataFrame</code> å¢åŠ åˆ—ä¹Ÿéå¸¸å¿«ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦
ä¸€èˆ¬çª—å£å‡½æ•°çš„è”åˆï¼ˆJoinï¼‰æ“ä½œã€‚</p>
<p>ä½†æ˜¯ï¼Œæƒ³è¦æ­£ç¡®çš„ä½¿ç”¨è¿™ä¸ªæ“ä½œï¼Œæˆ‘ä»¬è¦ä¿è¯ç”¨äº <code>over</code> çš„åˆ—æ˜¯æœ‰åºçš„ã€‚</p>
<h1 id="ä¸numpyäº¤äº’"><a class="header" href="#ä¸numpyäº¤äº’">ä¸Numpyäº¤äº’</a></h1>
<p><code>Polars</code> è¡¨è¾¾å¼æ”¯æŒ<code>NumPy</code> <a href="https://numpy.org/doc/stable/reference/ufuncs.html">ufuncs</a>ã€‚ <a href="https://numpy.org/doc/stable/reference/ufuncs.html#available-ufuncs">è¿™é‡Œ</a>æŸ¥çœ‹æ‰€æœ‰å—æ”¯æŒçš„numpyå‡½æ•°çš„åˆ—è¡¨ã€‚</p>
<p>è¿™æ„å‘³ç€ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°ä¸æ˜¯ç”±<code>Polars</code>æä¾›çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>NumPy</code>ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥é€šè¿‡<code>NumPy</code>APIè¿›è¡Œå¿«é€Ÿçš„åˆ—æ“ä½œã€‚</p>
<h2 id="å®ä¾‹-1"><a class="header" href="#å®ä¾‹-1">å®ä¾‹</a></h2>
<pre><code class="language-python">import polars as pl
import numpy as np

df = pl.DataFrame({&quot;a&quot;: [1, 2, 3], &quot;b&quot;: [4, 5, 6]})

out = df.select(
    [
        np.log(pl.all()).suffix(&quot;_log&quot;),  # å¯¹dfæ‰€æœ‰åˆ—æ±‚å¯¹æ•°
    ]
)
print(out)
</code></pre>
<pre><code class="language-text">shape: (3, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a_log    â”† b_log    â”‚
â”‚ ---      â”† ---      â”‚
â”‚ f64      â”† f64      â”‚
â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 0.0      â”† 1.386294 â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 0.693147 â”† 1.609438 â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 1.098612 â”† 1.791759 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 id="gotchas"><a class="header" href="#gotchas">Gotcha's</a></h2>
<p>é˜…è¯»æ›´å¤šå…³äº <a href="dsl//polars-book/user-guide/howcani/interop/numpy.html">gotcha's è¿™é‡Œ</a>.</p>
<pre><code class="language-python">import polars as pl
</code></pre>
<h1 id="è¡¨è¾¾å¼"><a class="header" href="#è¡¨è¾¾å¼">è¡¨è¾¾å¼</a></h1>
<p><code>fn(Series) -&gt; Series</code></p>
<ul>
<li>æ‡’æƒ°è¯„ä¼°
<ul>
<li>å¯ä»¥è¢«ä¼˜åŒ–</li>
<li>å‘åº“æä¾›èƒŒæ™¯ä¿¡æ¯ï¼Œå¹¶åšå‡ºæ˜æ™ºçš„å†³å®š</li>
</ul>
</li>
<li>é«˜åº¦å¹¶è¡Œ</li>
<li>ä¸Šä¸‹æ–‡ç›¸å…³
<ul>
<li>é€‰æ‹© / æŠ•å½± -&gt; <code>Series</code> = <strong>åˆ—ã€æ–‡æœ¬æˆ–å€¼</strong></li>
<li>èšåˆ -&gt; <code>Series</code> = <strong>ç»„</strong></li>
</ul>
</li>
</ul>
<pre><code class="language-python">df = pl.DataFrame(
    {
        &quot;A&quot;: [1, 2, 3, 4, 5],
        &quot;fruits&quot;: [&quot;banana&quot;, &quot;banana&quot;, &quot;apple&quot;, &quot;apple&quot;, &quot;banana&quot;],
        &quot;B&quot;: [5, 4, 3, 2, 1],
        &quot;cars&quot;: [&quot;beetle&quot;, &quot;audi&quot;, &quot;beetle&quot;, &quot;beetle&quot;, &quot;beetle&quot;],
        &quot;optional&quot;: [28, 300, None, 2, -30],
    }
)
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
A
</th>
<th>
fruits
</th>
<th>
B
</th>
<th>
cars
</th>
<th>
optional
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
"banana"
</td>
<td>
5
</td>
<td>
"beetle"
</td>
<td>
28
</td>
</tr>
<tr>
<td>
2
</td>
<td>
"banana"
</td>
<td>
4
</td>
<td>
"audi"
</td>
<td>
300
</td>
</tr>
<tr>
<td>
3
</td>
<td>
"apple"
</td>
<td>
3
</td>
<td>
"beetle"
</td>
<td>
null
</td>
</tr>
<tr>
<td>
4
</td>
<td>
"apple"
</td>
<td>
2
</td>
<td>
"beetle"
</td>
<td>
2
</td>
</tr>
<tr>
<td>
5
</td>
<td>
"banana"
</td>
<td>
1
</td>
<td>
"beetle"
</td>
<td>
-30
</td>
</tr>
</tbody>
</table>
</div>
<h1 id="é€‰æ‹©ä¸Šä¸‹æ–‡-1"><a class="header" href="#é€‰æ‹©ä¸Šä¸‹æ–‡-1">é€‰æ‹©ä¸Šä¸‹æ–‡</a></h1>
<pre><code class="language-python"># æˆ‘ä»¬å¯ä»¥é€šè¿‡åç§°æ¥é€‰æ‹©

(df.select([
    pl.col(&quot;A&quot;),
    &quot;B&quot;,      # &quot;B&quot;è¿™ä¸€åˆ—å°†ä¼šè¢«æ¨ç†
    pl.lit(&quot;B&quot;),  # æˆ‘ä»¬å¿…é¡»å‘Šè¯‰Polars, æˆ‘ä»¬&quot;B&quot;çš„æ–‡å­—ä¿¡æ¯
    pl.col(&quot;fruits&quot;),
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
A
</th>
<th>
B
</th>
<th>
literal
</th>
<th>
fruits
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
5
</td>
<td>
"B"
</td>
<td>
"banana"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
4
</td>
<td>
"B"
</td>
<td>
"banana"
</td>
</tr>
<tr>
<td>
3
</td>
<td>
3
</td>
<td>
"B"
</td>
<td>
"apple"
</td>
</tr>
<tr>
<td>
4
</td>
<td>
2
</td>
<td>
"B"
</td>
<td>
"apple"
</td>
</tr>
<tr>
<td>
5
</td>
<td>
1
</td>
<td>
"B"
</td>
<td>
"banana"
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># å¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼ˆèµ·å§‹ä¸ºâ€˜^â€™ç»ˆæ­¢ä¸º'$'ï¼‰æ¥é€‰æ‹©åˆ—

(df.select([
    pl.col(&quot;^A|B$&quot;).sum() # æ±‚å’Œ
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
A
</th>
<th>
B
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
15
</td>
<td>
15
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># å¯ä»¥é€šè¿‡åç§°é€‰å–å¤šä¸ªåˆ—

(df.select([
    pl.col([&quot;A&quot;, &quot;B&quot;]).sum() # æ±‚å’Œ
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
A
</th>
<th>
B
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
15
</td>
<td>
15
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># æˆ‘ä»¬å¯ä»¥ä»¥æ­£å¸¸é¡ºåºé€‰æ‹©æ‰€æœ‰äº‹ç‰©
# ç„¶åæˆ‘ä»¬å¯ä»¥ä»¥é€†åºçš„æ–¹å¼é€‰æ‹©äº‹ç‰©

(df.select([
    pl.all(),
    pl.all().reverse().suffix(&quot;_reverse&quot;) # è¡¨æ ¼ä¸­æ‰€æœ‰åˆ—é€†åºï¼ˆå¹¶ä¸”æ–‡å­—ä¸­åç¼€ä¸º_reverse
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
A
</th>
<th>
fruits
</th>
<th>
B
</th>
<th>
cars
</th>
<th>
optional
</th>
<th>
A_reverse
</th>
<th>
fruits_reverse
</th>
<th>
B_reverse
</th>
<th>
cars_reverse
</th>
<th>
optional_reverse
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
"banana"
</td>
<td>
5
</td>
<td>
"beetle"
</td>
<td>
28
</td>
<td>
5
</td>
<td>
"banana"
</td>
<td>
1
</td>
<td>
"beetle"
</td>
<td>
-30
</td>
</tr>
<tr>
<td>
2
</td>
<td>
"banana"
</td>
<td>
4
</td>
<td>
"audi"
</td>
<td>
300
</td>
<td>
4
</td>
<td>
"apple"
</td>
<td>
2
</td>
<td>
"beetle"
</td>
<td>
2
</td>
</tr>
<tr>
<td>
3
</td>
<td>
"apple"
</td>
<td>
3
</td>
<td>
"beetle"
</td>
<td>
null
</td>
<td>
3
</td>
<td>
"apple"
</td>
<td>
3
</td>
<td>
"beetle"
</td>
<td>
null
</td>
</tr>
<tr>
<td>
4
</td>
<td>
"apple"
</td>
<td>
2
</td>
<td>
"beetle"
</td>
<td>
2
</td>
<td>
2
</td>
<td>
"banana"
</td>
<td>
4
</td>
<td>
"audi"
</td>
<td>
300
</td>
</tr>
<tr>
<td>
5
</td>
<td>
"banana"
</td>
<td>
1
</td>
<td>
"beetle"
</td>
<td>
-30
</td>
<td>
1
</td>
<td>
"banana"
</td>
<td>
5
</td>
<td>
"beetle"
</td>
<td>
28
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># æ‰€æœ‰è¡¨è¾¾å¼å¹¶è¡Œåœ°è¿è¡Œ
# å•å€¼'Series'è¢«å¹¿æ’­åˆ°'DataFrame'çš„å½¢çŠ¶`

(df.select([
    pl.all(),
    pl.all().sum().suffix(&quot;_sum&quot;)
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
A
</th>
<th>
fruits
</th>
<th>
B
</th>
<th>
cars
</th>
<th>
optional
</th>
<th>
A_sum
</th>
<th>
fruits_sum
</th>
<th>
B_sum
</th>
<th>
cars_sum
</th>
<th>
optional_sum
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
"banana"
</td>
<td>
5
</td>
<td>
"beetle"
</td>
<td>
28
</td>
<td>
15
</td>
<td>
null
</td>
<td>
15
</td>
<td>
null
</td>
<td>
300
</td>
</tr>
<tr>
<td>
2
</td>
<td>
"banana"
</td>
<td>
4
</td>
<td>
"audi"
</td>
<td>
300
</td>
<td>
15
</td>
<td>
null
</td>
<td>
15
</td>
<td>
null
</td>
<td>
300
</td>
</tr>
<tr>
<td>
3
</td>
<td>
"apple"
</td>
<td>
3
</td>
<td>
"beetle"
</td>
<td>
null
</td>
<td>
15
</td>
<td>
null
</td>
<td>
15
</td>
<td>
null
</td>
<td>
300
</td>
</tr>
<tr>
<td>
4
</td>
<td>
"apple"
</td>
<td>
2
</td>
<td>
"beetle"
</td>
<td>
2
</td>
<td>
15
</td>
<td>
null
</td>
<td>
15
</td>
<td>
null
</td>
<td>
300
</td>
</tr>
<tr>
<td>
5
</td>
<td>
"banana"
</td>
<td>
1
</td>
<td>
"beetle"
</td>
<td>
-30
</td>
<td>
15
</td>
<td>
null
</td>
<td>
15
</td>
<td>
null
</td>
<td>
300
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># ä¸“é—¨å‡½æ•°æœ‰'str'å’Œ'dt'åç§°ç©ºé—´

predicate = pl.col(&quot;fruits&quot;).str.contains(&quot;^b.*&quot;)

(df.select([
    predicate
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
</tr>
<tr>
<td>
bool
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
false
</td>
</tr>
<tr>
<td>
true
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># åˆ©ç”¨è°“è¯­ï¼ˆpredicateï¼‰è¿›è¡Œè¿‡æ»¤

df.filter(predicate)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
A
</th>
<th>
fruits
</th>
<th>
B
</th>
<th>
cars
</th>
<th>
optional
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
"banana"
</td>
<td>
5
</td>
<td>
"beetle"
</td>
<td>
28
</td>
</tr>
<tr>
<td>
2
</td>
<td>
"banana"
</td>
<td>
4
</td>
<td>
"audi"
</td>
<td>
300
</td>
</tr>
<tr>
<td>
5
</td>
<td>
"banana"
</td>
<td>
1
</td>
<td>
"beetle"
</td>
<td>
-30
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># è°“è¯­ï¼ˆpredicateï¼‰ è¡¨è¾¾å¼å¯ä»¥è¢«ç”¨äºè¿‡æ»¤

(df.select([
    pl.col(&quot;A&quot;).filter(pl.col(&quot;fruits&quot;).str.contains(&quot;^b.*&quot;)).sum(),
    (pl.col(&quot;B&quot;).filter(pl.col(&quot;cars&quot;).str.contains(&quot;^b.*&quot;)).sum() * pl.col(&quot;B&quot;).sum()).alias(&quot;some_compute()&quot;), # .aliasæ–¹æ³•è¡¨ç¤ºå¦èµ·ä¸€åˆ—
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
A
</th>
<th>
some_compute()
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
8
</td>
<td>
165
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># æˆ‘ä»¬å¯ä»¥å¯¹åˆ—å’Œï¼ˆæ–‡å­—ï¼‰å€¼è¿›è¡Œç®—æœ¯è¿ç®—
# å¯ä»¥åœ¨ç¨‹åºå‘˜ä¸çŸ¥é“çš„æƒ…å†µä¸‹è®¡ç®—ä¸º1

some_var = 1

(df.select([
    ((pl.col(&quot;A&quot;) / 124.0 * pl.col(&quot;B&quot;)) / pl.sum(&quot;B&quot;) * some_var).alias(&quot;computed&quot;)
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
computed
</th>
</tr>
<tr>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0.002688
</td>
</tr>
<tr>
<td>
0.004301
</td>
</tr>
<tr>
<td>
0.004839
</td>
</tr>
<tr>
<td>
0.004301
</td>
</tr>
<tr>
<td>
0.002688
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># æˆ‘ä»¬å¯ä»¥é€šè¿‡è°“è¯ï¼ˆpredicateï¼‰æ¥ç»„åˆåˆ—

(df.select([
    &quot;fruits&quot;,
    &quot;B&quot;,
    pl.when(pl.col(&quot;fruits&quot;) == &quot;banana&quot;).then(pl.col(&quot;B&quot;)).otherwise(-1).alias(&quot;b&quot;)
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
<th>
B
</th>
<th>
b
</th>
</tr>
<tr>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"banana"
</td>
<td>
5
</td>
<td>
5
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
4
</td>
<td>
4
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
3
</td>
<td>
-1
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
2
</td>
<td>
-1
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
1
</td>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># æˆ‘ä»¬å¯ä»¥åœ¨åˆ—è¿™ä¸€å±‚é€šè¿‡æŠ˜å æ“ä½œç»„åˆåˆ—

(df.select([
    &quot;A&quot;,
    &quot;B&quot;,
    pl.fold(0, lambda a, b: a + b, [pl.col(&quot;A&quot;), &quot;B&quot;, pl.col(&quot;B&quot;)**2, pl.col(&quot;A&quot;) / 2.0]).alias(&quot;fold&quot;)
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
A
</th>
<th>
B
</th>
<th>
fold
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
i64
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
5
</td>
<td>
31.5
</td>
</tr>
<tr>
<td>
2
</td>
<td>
4
</td>
<td>
23.0
</td>
</tr>
<tr>
<td>
3
</td>
<td>
3
</td>
<td>
16.5
</td>
</tr>
<tr>
<td>
4
</td>
<td>
2
</td>
<td>
12.0
</td>
</tr>
<tr>
<td>
5
</td>
<td>
1
</td>
<td>
9.5
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># ç”šè‡³ç»„åˆæ‰€æœ‰

(df.select([
    pl.arange(0, df.height).alias(&quot;idx&quot;),
    &quot;A&quot;,
    pl.col(&quot;A&quot;).shift().alias(&quot;A_shifted&quot;),
    pl.concat_str(pl.all(), &quot;-&quot;).alias(&quot;str_concat_1&quot;),  # å€¾å‘äºè¿™ç§æ–¹å¼
    pl.fold(pl.col(&quot;A&quot;), lambda a, b: a + &quot;-&quot; + b, pl.all().exclude(&quot;A&quot;)).alias(&quot;str_concat_2&quot;),
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
idx
</th>
<th>
A
</th>
<th>
A_shifted
</th>
<th>
str_concat_1
</th>
<th>
str_concat_2
</th>
</tr>
<tr>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
1
</td>
<td>
null
</td>
<td>
"1-banana-5-beetle-28"
</td>
<td>
"1-banana-5-beetle-28"
</td>
</tr>
<tr>
<td>
1
</td>
<td>
2
</td>
<td>
1
</td>
<td>
"2-banana-4-audi-300"
</td>
<td>
"2-banana-4-audi-300"
</td>
</tr>
<tr>
<td>
2
</td>
<td>
3
</td>
<td>
2
</td>
<td>
null
</td>
<td>
null
</td>
</tr>
<tr>
<td>
3
</td>
<td>
4
</td>
<td>
3
</td>
<td>
"4-apple-2-beetle-2"
</td>
<td>
"4-apple-2-beetle-2"
</td>
</tr>
<tr>
<td>
4
</td>
<td>
5
</td>
<td>
4
</td>
<td>
"5-banana-1-beetle--30"
</td>
<td>
"5-banana-1-beetle--30"
</td>
</tr>
</tbody>
</table>
</div>
<h1 id="èšåˆä¸Šä¸‹æ–‡"><a class="header" href="#èšåˆä¸Šä¸‹æ–‡">èšåˆä¸Šä¸‹æ–‡</a></h1>
<ul>
<li>è¡¨è¾¾å¼åº”ç”¨äºç»„è€Œä¸æ˜¯åˆ—</li>
</ul>
<pre><code class="language-python"># æˆ‘ä»¬ä»å¯ä»¥ç»„åˆå¾ˆå¤šè¡¨è¾¾å¼

(df.sort(&quot;cars&quot;).groupby(&quot;fruits&quot;)
    .agg([
        pl.col(&quot;B&quot;).sum().alias(&quot;B_sum&quot;),
        pl.sum(&quot;B&quot;).alias(&quot;B_sum2&quot;),  # ç¬¬ä¸€ä¸ªæ˜¯è¯­æ³•ç³–
        pl.first(&quot;fruits&quot;).alias(&quot;fruits_first&quot;),
        pl.count(&quot;A&quot;).alias(&quot;count&quot;),
        pl.col(&quot;cars&quot;).reverse()
    ]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
<th>
B_sum
</th>
<th>
B_sum2
</th>
<th>
fruits_first
</th>
<th>
count
</th>
<th>
cars
</th>
</tr>
<tr>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
u32
</td>
<td>
list
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"banana"
</td>
<td>
10
</td>
<td>
10
</td>
<td>
"banana"
</td>
<td>
3
</td>
<td>
["beetle", "beetle", "audi"]
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
5
</td>
<td>
5
</td>
<td>
"apple"
</td>
<td>
2
</td>
<td>
["beetle", "beetle"]
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># æˆ‘ä»¬å¯ä»¥ä»â€œæ±½è½¦â€åˆ—ä¸‹æ‰‹

(df.sort(&quot;cars&quot;).groupby(&quot;fruits&quot;)
    .agg([
        pl.col(&quot;B&quot;).sum().alias(&quot;B_sum&quot;),
        pl.sum(&quot;B&quot;).alias(&quot;B_sum2&quot;),  # ç¬¬ä¸€ä¸ªæ˜¯è¯­æ³•ç³–
        pl.first(&quot;fruits&quot;).alias(&quot;fruits_first&quot;),
        pl.count(&quot;A&quot;).alias(&quot;count&quot;),
        pl.col(&quot;cars&quot;).reverse()
    ])).explode(&quot;cars&quot;)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
<th>
B_sum
</th>
<th>
B_sum2
</th>
<th>
fruits_first
</th>
<th>
count
</th>
<th>
cars
</th>
</tr>
<tr>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
u32
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"banana"
</td>
<td>
10
</td>
<td>
10
</td>
<td>
"banana"
</td>
<td>
3
</td>
<td>
"beetle"
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
10
</td>
<td>
10
</td>
<td>
"banana"
</td>
<td>
3
</td>
<td>
"beetle"
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
10
</td>
<td>
10
</td>
<td>
"banana"
</td>
<td>
3
</td>
<td>
"audi"
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
5
</td>
<td>
5
</td>
<td>
"apple"
</td>
<td>
2
</td>
<td>
"beetle"
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
5
</td>
<td>
5
</td>
<td>
"apple"
</td>
<td>
2
</td>
<td>
"beetle"
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python">(df.groupby(&quot;fruits&quot;)
    .agg([
        pl.col(&quot;B&quot;).sum().alias(&quot;B_sum&quot;),
        pl.sum(&quot;B&quot;).alias(&quot;B_sum2&quot;),  # ç¬¬ä¸€ä¸ªæ˜¯è¯­æ³•ç³–
        pl.first(&quot;fruits&quot;).alias(&quot;fruits_first&quot;),
        pl.count(),
        pl.col(&quot;B&quot;).shift().alias(&quot;B_shifted&quot;)
    ])
 .explode(&quot;B_shifted&quot;)
)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
<th>
B_sum
</th>
<th>
B_sum2
</th>
<th>
fruits_first
</th>
<th>
count
</th>
<th>
B_shifted
</th>
</tr>
<tr>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
u32
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"banana"
</td>
<td>
10
</td>
<td>
10
</td>
<td>
"banana"
</td>
<td>
3
</td>
<td>
null
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
10
</td>
<td>
10
</td>
<td>
"banana"
</td>
<td>
3
</td>
<td>
5
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
10
</td>
<td>
10
</td>
<td>
"banana"
</td>
<td>
3
</td>
<td>
4
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
5
</td>
<td>
5
</td>
<td>
"apple"
</td>
<td>
2
</td>
<td>
null
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
5
</td>
<td>
5
</td>
<td>
"apple"
</td>
<td>
2
</td>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># æˆ‘ä»¬å¯ä»¥ä»â€œæ±½è½¦â€åˆ—ä¸‹æ‰‹

(df.sort(&quot;cars&quot;).groupby(&quot;fruits&quot;)
    .agg([
        pl.col(&quot;B&quot;).sum(),
        pl.sum(&quot;B&quot;).alias(&quot;B_sum2&quot;),  # ç¬¬ä¸€ä¸ªæ˜¯è¯­æ³•ç³–
        pl.first(&quot;fruits&quot;).alias(&quot;fruits_first&quot;),
        pl.count(&quot;A&quot;).alias(&quot;count&quot;),
        pl.col(&quot;cars&quot;).reverse()
    ])).explode(&quot;cars&quot;)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
<th>
B
</th>
<th>
B_sum2
</th>
<th>
fruits_first
</th>
<th>
count
</th>
<th>
cars
</th>
</tr>
<tr>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
str
</td>
<td>
u32
</td>
<td>
str
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"banana"
</td>
<td>
10
</td>
<td>
10
</td>
<td>
"banana"
</td>
<td>
3
</td>
<td>
"beetle"
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
10
</td>
<td>
10
</td>
<td>
"banana"
</td>
<td>
3
</td>
<td>
"beetle"
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
10
</td>
<td>
10
</td>
<td>
"banana"
</td>
<td>
3
</td>
<td>
"audi"
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
5
</td>
<td>
5
</td>
<td>
"apple"
</td>
<td>
2
</td>
<td>
"beetle"
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
5
</td>
<td>
5
</td>
<td>
"apple"
</td>
<td>
2
</td>
<td>
"beetle"
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># æˆ‘ä»¬ä¹Ÿå¯ä»¥å¾—åˆ°ä¸€åˆ—ç»„

(df.groupby(&quot;fruits&quot;)
    .agg([
         pl.col(&quot;B&quot;).shift().alias(&quot;shift_B&quot;),
         pl.col(&quot;B&quot;).reverse().alias(&quot;rev_B&quot;),
    ]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
<th>
shift_B
</th>
<th>
rev_B
</th>
</tr>
<tr>
<td>
str
</td>
<td>
list
</td>
<td>
list
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"apple"
</td>
<td>
[null, 3]
</td>
<td>
[2, 3]
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
[null, 5, 4]
</td>
<td>
[1, 4, 5]
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨groupbyä¸­ä½¿ç”¨è°“è¯

(df.groupby(&quot;fruits&quot;)
    .agg([
        pl.col(&quot;B&quot;).filter(pl.col(&quot;B&quot;) &gt; 1).list().keep_name(),
    ]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
<th>
B
</th>
</tr>
<tr>
<td>
str
</td>
<td>
list
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"banana"
</td>
<td>
[5, 4]
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
[3, 2]
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># å¹¶ä¸”åªæ ¹æ®è°“è¯ä¸ºçœŸçš„å€¼æ±‚å’Œ

(df.groupby(&quot;fruits&quot;)
    .agg([
        pl.col(&quot;B&quot;).filter(pl.col(&quot;B&quot;) &gt; 1).mean(),
    ]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
<th>
B
</th>
</tr>
<tr>
<td>
str
</td>
<td>
f64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"apple"
</td>
<td>
2.5
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
4.5
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># å¦ä¸€ä¸ªä¾‹å­

(df.groupby(&quot;fruits&quot;)
    .agg([
        pl.col(&quot;B&quot;).shift_and_fill(1, fill_value=0).alias(&quot;shifted&quot;),
        pl.col(&quot;B&quot;).shift_and_fill(1, fill_value=0).sum().alias(&quot;shifted_sum&quot;),
    ]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
<th>
shifted
</th>
<th>
shifted_sum
</th>
</tr>
<tr>
<td>
str
</td>
<td>
list
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"banana"
</td>
<td>
[0, 5, 4]
</td>
<td>
9
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
[0, 3]
</td>
<td>
3
</td>
</tr>
</tbody>
</table>
</div>
<h1 id="çª—å£å‡½æ•°"><a class="header" href="#çª—å£å‡½æ•°">çª—å£å‡½æ•°!</a></h1>
<ul>
<li>ç”¨â€œè¶…èƒ½åŠ›è¡¨â€è¾¾ã€‚</li>
<li>é€‰æ‹©ä¸Šä¸‹æ–‡ä¸­çš„èšåˆ</li>
</ul>
<pre><code class="language-python">pl.col(&quot;foo&quot;).aggregation_expression(..).over(&quot;column_used_to_group&quot;)
</code></pre>
<pre><code class="language-python"># groupby 2ä¸ªä¸åŒçš„åˆ—

(df.select([
    &quot;fruits&quot;,
    &quot;cars&quot;,
    &quot;B&quot;,
    pl.col(&quot;B&quot;).sum().over(&quot;fruits&quot;).alias(&quot;B_sum_by_fruits&quot;),
    pl.col(&quot;B&quot;).sum().over(&quot;cars&quot;).alias(&quot;B_sum_by_cars&quot;),
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
<th>
cars
</th>
<th>
B
</th>
<th>
B_sum_by_fruits
</th>
<th>
B_sum_by_cars
</th>
</tr>
<tr>
<td>
str
</td>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"banana"
</td>
<td>
"beetle"
</td>
<td>
5
</td>
<td>
10
</td>
<td>
11
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
"audi"
</td>
<td>
4
</td>
<td>
10
</td>
<td>
4
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
"beetle"
</td>
<td>
3
</td>
<td>
5
</td>
<td>
11
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
"beetle"
</td>
<td>
2
</td>
<td>
5
</td>
<td>
11
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
"beetle"
</td>
<td>
1
</td>
<td>
10
</td>
<td>
11
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># æŒ‰ç»„åè½¬Bï¼Œå¹¶åœ¨åŸå§‹dfä¸­æ˜¾ç¤ºç»“æœ

(df.select([
    &quot;fruits&quot;,
    &quot;B&quot;,
    pl.col(&quot;B&quot;).reverse().over(&quot;fruits&quot;).alias(&quot;B_reversed_by_fruits&quot;)
]))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
<th>
B
</th>
<th>
B_reversed_by_fruits
</th>
</tr>
<tr>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"banana"
</td>
<td>
5
</td>
<td>
1
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
4
</td>
<td>
4
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
3
</td>
<td>
2
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
2
</td>
<td>
3
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
1
</td>
<td>
5
</td>
</tr>
</tbody>
</table>
</div>
<pre><code class="language-python"># å°†ä¸€åˆ—ç½®äºâ€œfruitsâ€ä¸­

(df.select([
    &quot;fruits&quot;,
    &quot;B&quot;,
    pl.col(&quot;B&quot;).shift().over(&quot;fruits&quot;).alias(&quot;lag_B_by_fruits&quot;)
]))

</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1 "class="dataframe ">
<thead>
<tr>
<th>
fruits
</th>
<th>
B
</th>
<th>
lag_B_by_fruits
</th>
</tr>
<tr>
<td>
str
</td>
<td>
i64
</td>
<td>
i64
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
"banana"
</td>
<td>
5
</td>
<td>
null
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
4
</td>
<td>
5
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
3
</td>
<td>
null
</td>
</tr>
<tr>
<td>
"apple"
</td>
<td>
2
</td>
<td>
3
</td>
</tr>
<tr>
<td>
"banana"
</td>
<td>
1
</td>
<td>
4
</td>
</tr>
</tbody>
</table>
</div>
<h1 id="è¡¨è¾¾å¼api"><a class="header" href="#è¡¨è¾¾å¼api">è¡¨è¾¾å¼API</a></h1>
<p>å¯ä»¥åœ¨<a href="https://pola-rs.github.io/polars/py-polars/html/reference/expression.html"><code>Expr</code></a>ä¸Šæ‰¾åˆ°å¯èƒ½çš„è¡¨è¾¾å¼çš„å®Œæ•´åˆ—è¡¨ï¼Œå‚è€ƒæŒ‡å—ä¸­çš„å®šä¹‰ã€‚</p>
<h1 id="è§†é¢‘ä»‹ç»"><a class="header" href="#è§†é¢‘ä»‹ç»">è§†é¢‘ä»‹ç»</a></h1>
<p>ä½ ä¸å–œæ¬¢é˜…è¯»æ–‡æ¡£å—ï¼Ÿçœ‹çœ‹è¿™æ®µå…³äº<code>Polars</code>åŠå…¶è¡¨è¾¾çš„ä»‹ç»è§†é¢‘ã€‚</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/iwGIuGk5nCE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h1 id="ç´¢å¼•"><a class="header" href="#ç´¢å¼•">ç´¢å¼•</a></h1>
<p><code>Polars</code> <code>DataFrame</code>æ²¡æœ‰ç´¢å¼•ï¼Œå› æ­¤ç´¢å¼•è¡Œä¸ºå¯ä»¥æ˜¯ä¸€è‡´çš„ï¼Œè€Œä¸éœ€è¦  <code>df.loc</code>,
<code>df.iloc</code>, or a <code>df.at</code> æ“ä½œã€‚</p>
<p>è§„åˆ™å¦‚ä¸‹ï¼ˆå–å†³äºå€¼çš„æ•°æ®ç±»å‹ï¼‰:</p>
<ul>
<li>
<p><strong>æ•°å€¼å‹</strong></p>
<ul>
<li>axis 0: è¡Œï¼ˆrowï¼‰</li>
<li>axis 1: åˆ—ï¼ˆcolumnï¼‰</li>
</ul>
</li>
<li>
<p><strong>æ•°å€¼å‹ + å­—ç¬¦ä¸²</strong></p>
<ul>
<li>axis 0: è¡Œï¼ˆè¿™é‡Œåªæ¥æ”¶æ•°å­—)</li>
<li>axis 1: åˆ—ï¼ˆæ¥å—æ•°å­—+å­—ç¬¦ä¸²å€¼ï¼‰</li>
</ul>
</li>
<li>
<p><strong>ä»…å­—ç¬¦ä¸²</strong></p>
<ul>
<li>axis 0: åˆ—ï¼ˆcolumnï¼‰</li>
<li>axis 1: æŠ¥é”™ï¼ˆerrorï¼‰</li>
</ul>
</li>
<li>
<p><strong>è¡¨è¾¾å¼</strong></p>
<p><em>æ‰€æœ‰è¡¨è¾¾å¼æ±‚å€¼éƒ½æ˜¯å¹¶è¡Œæ‰§è¡Œçš„</em></p>
<ul>
<li>axis 0: åˆ—ï¼ˆcolumnï¼‰</li>
<li>axis 1: åˆ—ï¼ˆcolumnï¼‰</li>
<li>..</li>
<li>axis n: åˆ—ï¼ˆcolumnï¼‰</li>
</ul>
</li>
</ul>
<h2 id="ä¸pandasçš„å¯¹æ¯”"><a class="header" href="#ä¸pandasçš„å¯¹æ¯”">ä¸Pandasçš„å¯¹æ¯”</a></h2>
<table><thead><tr><th>pandas</th><th>polars</th></tr></thead><tbody>
<tr><td>é€‰æ‹©åˆ—<br> <code>df.iloc[2]</code></td><td><code>df[2, :]</code></td></tr>
<tr><td>æŒ‰ç´¢å¼•é€‰æ‹©å‡ è¡Œ<br> <code>df.iloc[[2, 5, 6]]</code></td><td><code>df[[2, 5, 6], :]</code></td></tr>
<tr><td>é€‰æ‹©è¡Œçš„åˆ‡ç‰‡<br> <code>df.iloc[2:6]</code></td><td><code>df[2:6, :]</code></td></tr>
<tr><td>ä½¿ç”¨å¸ƒå°”æ©ç ï¼ˆboolean maskï¼‰é€‰æ‹©è¡Œ<br> <code>df.iloc[True, True, False]</code></td><td><code>df[[True, True, False]]</code></td></tr>
<tr><td>æŒ‰è°“è¯ï¼ˆpredicateï¼‰æ¡ä»¶é€‰æ‹©è¡Œ<br> <code>df.loc[df[&quot;A&quot;] &gt; 3]</code></td><td><code>df[df[&quot;A&quot;] &gt; 3]</code></td></tr>
<tr><td>é€‰æ‹©åˆ—çš„åˆ‡ç‰‡<br> <code>df.iloc[:, 1:3]</code></td><td><code>df[:, 1:3]</code></td></tr>
<tr><td>æŒ‰å­—ç¬¦ä¸²é¡ºåºé€‰æ‹©åˆ—çš„åˆ‡ç‰‡<br> <code>df.loc[:, &quot;A&quot;:&quot;Z&quot;]</code></td><td><code>df[:, &quot;A&quot;:&quot;Z&quot;]</code></td></tr>
<tr><td>é€‰æ‹©å•ä¸ªå€¼ï¼ˆæ ‡é‡ï¼‰<br> <code>df.loc[2, &quot;A&quot;]</code></td><td><code>df[2, &quot;A&quot;]</code></td></tr>
<tr><td>é€‰æ‹©å•ä¸ªå€¼ï¼ˆæ ‡é‡ï¼‰<br> <code>df.iloc[2, 1]</code></td><td><code>df[2, 1]</code></td></tr>
<tr><td>é€‰æ‹©å•ä¸ªå€¼ï¼ˆSeriesæˆ–DataFrameï¼‰<br> <code>df.loc[2, [&quot;A&quot;]]</code></td><td><code>df[2, [&quot;A&quot;]]</code></td></tr>
<tr><td>é€‰æ‹©å•ä¸ªå€¼ (Seriesæˆ–DataFrame)<br> <code>df.iloc[2, [1]]</code></td><td><code>df[2, [1]]</code></td></tr>
</tbody></table>
<h2 id="è¡¨è¾¾å¼-1"><a class="header" href="#è¡¨è¾¾å¼-1">è¡¨è¾¾å¼</a></h2>
<p>è¡¨è¾¾å¼ä¹Ÿå¯ä»¥ç”¨äºç´¢å¼•ï¼ˆå®ƒæ˜¯<code>df.select</code>çš„è¯­æ³•ç³–ï¼‰ã€‚</p>
<p>è¿™å¯ä»¥ç”¨æ¥åšä¸€äº›å¾ˆæœ‰åˆ«è‡´çš„é€‰æ‹©ã€‚</p>
<pre><code class="language-python">df[[
    pl.col(&quot;A&quot;).head(5),  # ä»â€œAâ€çš„é¦–éƒ¨å¼€å§‹è·å–
    pl.col(&quot;B&quot;).tail(5).reverse(), # ä»¥é€†åºçš„æ–¹å¼è·å–â€œBâ€çš„åéƒ¨
    pl.col(&quot;B&quot;).filter(pl.col(&quot;B&quot;) &gt; 5).head(5), # é¦–å…ˆå¾—åˆ°æ»¡è¶³è°“è¯çš„â€œBâ€
    pl.sum(&quot;A&quot;).over(&quot;B&quot;).head(5) # è·å–â€œAâ€åœ¨â€œBâ€ç»„ä¸Šçš„æ€»å’Œï¼Œå¹¶è¿”å›å‰5ä¸ª
</code></pre>
<h1 id="æ•°æ®ç±»å‹"><a class="header" href="#æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</a></h1>
<p><code>Polars</code>å®Œå…¨åŸºäº<code>Arrow</code>æ•°æ®ç±»å‹ï¼Œå¹¶ç”±<code>Arrow</code>å†…å­˜é˜µåˆ—æ”¯æŒã€‚è¿™ä½¿å¾—æ•°æ®å¤„ç†
ç¼“å­˜æ•ˆç‡é«˜ï¼Œæ”¯æŒè¿›ç¨‹é—´é€šä¿¡ã€‚å¤§å¤šæ•°æ•°æ®ç±»å‹éµå¾ªç¡®åˆ‡çš„å®ç°æ¥è‡ª<code>Arrow</code>ï¼Œé™¤äº†<code>Utf8</code>ï¼ˆå®é™…ä¸Šæ˜¯<code>LargeUtf8</code>ï¼‰ã€<code>category</code>å’Œ<code>Object</code>ï¼ˆæ”¯æŒæœ‰é™ï¼‰ã€‚</p>
<p>è¿™äº›æ•°æ®ç±»å‹æ˜¯:</p>
<ul>
<li><code>Int8</code>: 8ä½æœ‰ç¬¦å·æ•´æ•°ã€‚</li>
<li><code>Int16</code>: 16ä½æœ‰ç¬¦å·æ•´æ•°ã€‚</li>
<li><code>Int32</code>: 32ä½æœ‰ç¬¦å·æ•´æ•°ã€‚</li>
<li><code>Int64</code>: 64ä½æœ‰ç¬¦å·æ•´æ•°ã€‚</li>
<li><code>UInt8</code>: 8ä½æœ‰ç¬¦å·æ•´æ•°ã€‚</li>
<li><code>UInt16</code>: 16ä½æ— ç¬¦å·æ•´æ•°ã€‚</li>
<li><code>UInt32</code>: 32ä½æ— ç¬¦å·æ•´æ•°ã€‚</li>
<li><code>UInt64</code>: 64ä½æ— ç¬¦å·æ•´æ•°ã€‚</li>
<li><code>Float32</code>: 32ä½æµ®ç‚¹æ•°ã€‚</li>
<li><code>Float64</code>: 64ä½æµ®ç‚¹æ•°ã€‚</li>
<li><code>Boolean</code>: å¸ƒå°”å‹æœ‰æ•ˆä½å‹ç¼©ã€‚</li>
<li><code>Utf8</code>: å­—ç¬¦ä¸²æ•°æ®ï¼ˆå†…éƒ¨å®é™…ä¸Šæ˜¯<code>Arrow </code> <code>LargeUtf8</code>ï¼‰ã€‚</li>
<li><code>List</code>: åˆ—è¡¨æ•°ç»„åŒ…å«ç€åŒ…å«åˆ—è¡¨å€¼çš„å­æ•°ç»„å’Œåç§»æ•°ç»„ã€‚ï¼ˆè¿™å®é™…ä¸Šæ˜¯å†…éƒ¨çš„<code>Arrow</code> <code>LargeList</code>ï¼‰ã€‚</li>
<li><code>Date</code>: æ—¥æœŸè¡¨ç¤ºï¼Œå†…éƒ¨è¡¨ç¤ºä¸ºè‡ªUNIXçºªå…ƒä»¥æ¥çš„å¤©æ•°ï¼Œç”±32ä½æœ‰ç¬¦å·æ•´æ•°ç¼–ç ã€‚</li>
<li><code>Datetime</code>: Datetimeè¡¨ç¤ºæ³•ï¼Œå†…éƒ¨è¡¨ç¤ºä¸ºè‡ªUNIXçºªå…ƒä»¥æ¥çš„çº³ç§’ï¼Œç”±64ä½æœ‰ç¬¦å·æ•´æ•°ç¼–ç ã€‚</li>
<li><code>Duration</code>: æ—¶é—´å‹ã€‚åœ¨å‡å»<code>Date/Datetime</code>æ—¶åˆ›å»ºã€‚</li>
<li><code>Time</code>: æ—¶é—´è¡¨ç¤ºæ³•ï¼Œä»åˆå¤œå¼€å§‹åœ¨å†…éƒ¨è¡¨ç¤ºä¸ºçº³ç§’ã€‚</li>
<li><code>Object</code>: å—æ”¯æŒçš„æœ‰é™æ•°æ®ç±»å‹ï¼Œå¯ä»¥æ˜¯ä»»ä½•å€¼ã€‚</li>
</ul>
<p>è¦äº†è§£æœ‰å…³è¿™äº›æ•°æ®ç±»å‹çš„å†…éƒ¨è¡¨ç¤ºå½¢å¼çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹<a href="https://arrow.apache.org/docs/format/Columnar.html"><code>Arrow</code>æŸ±çŠ¶æ ¼å¼</a>ã€‚</p>
<h1 id="ä»pandaså…¥æ‰‹"><a class="header" href="#ä»pandaså…¥æ‰‹">ä»pandaså…¥æ‰‹</a></h1>
<p>å¦‚æœä½ å¾ˆç†Ÿæ‚‰<code>Pandas</code>ï¼Œé‚£ä¹ˆä½ åªéœ€è¦çŸ¥é“ä¸€ä»¶äº‹ï¼š</p>
<pre><code>polars != pandas
</code></pre>
<p>å¦‚æœä½ çš„<code>Polars</code>ä»£ç å†™èµ·æ¥å¾ˆåƒ<code>Pandas</code>ï¼Œç¨‹åºä¹Ÿè®¸å¯ä»¥è¿è¡Œï¼Œä½†æ˜¯å¾ˆæœ‰å¯èƒ½ä¼šæ…¢äºå®ƒæœ¬è¯¥æœ‰çš„é€Ÿåº¦ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬å°±é€šè¿‡å‡ æ®µç»å…¸<code>Pandas</code>ä»£ç çœ‹çœ‹æ€æ ·å°†ä½ çš„ä»£ç å†™å¾—æ›´åŠ <code>Polars</code>ã€‚</p>
<h2 id="åˆ—è¿ç®—"><a class="header" href="#åˆ—è¿ç®—">åˆ—è¿ç®—</a></h2>
<h3 id="pandas"><a class="header" href="#pandas"><code>Pandas</code></a></h3>
<pre><code class="language-python"># ä»¥ä¸‹ä»£ç æ˜¯é¡ºåºæ‰§è¡Œçš„
df[&quot;a&quot;] = df[&quot;b&quot;] * 10
df[&quot;c&quot;] = df[&quot;b&quot;] * 100
</code></pre>
<h3 id="polars"><a class="header" href="#polars"><code>Polars</code></a></h3>
<pre><code class="language-python"># ä»¥ä¸‹ä»£ç æ˜¯å¹¶å‘æ‰§è¡Œçš„
df.with_columns([
    (pl.col(&quot;b&quot;) * 10).alias(&quot;a&quot;),
    (pl.col(&quot;b&quot;) * 100).alias(&quot;c&quot;),
])
</code></pre>
<h3 id="åŸºäºåˆ¤å®šçš„åˆ—è¿ç®—"><a class="header" href="#åŸºäºåˆ¤å®šçš„åˆ—è¿ç®—">åŸºäºåˆ¤å®šçš„åˆ—è¿ç®—</a></h3>
<h3 id="pandas-1"><a class="header" href="#pandas-1"><code>Pandas</code></a></h3>
<pre><code class="language-python">df.loc[df[&quot;c&quot;] == 2, &quot;a&quot;] = df.loc[df[&quot;c&quot;] == 2, &quot;b&quot;]
</code></pre>
<h3 id="polars-1"><a class="header" href="#polars-1"><code>Polars</code></a></h3>
<pre><code class="language-python">df.with_column(
    pl.when(pl.col(&quot;c&quot;) == 2)
    .then(pl.col(&quot;b&quot;))
    .otherwise(pl.col(&quot;a&quot;)).alias(&quot;a&quot;)
)
</code></pre>
<p>æ³¨æ„ï¼Œ<code>Polars</code>çš„æ–¹å¼æ›´â€œå¹²å‡€â€ï¼Œå› è€ŒåŸå§‹<code>DataFrame</code>ä¸­çš„æ•°æ®å¹¶æ²¡æœ‰è¢«ä¿®æ”¹ã€‚å¹¶ä¸”ï¼Œ<code>mask</code>ï¼ˆæ©è†œï¼‰ä¹Ÿä¸åƒåœ¨<code>Pandas</code>ä¸­é‚£æ ·è¢«è®¡ç®—äº†ä¸¤æ¬¡ã€‚</p>
<p>å½“ç„¶ï¼Œä½ å¯ä»¥åœ¨<code>Pandas</code>ä¸­é˜²æ­¢åŸå§‹<code>DataFrame</code>ä¸­çš„æ•°æ®åœ¨è¿™ä¸€æ­¥è¢«ä¿®æ”¹ï¼Œä½†è¿™éœ€è¦å€ŸåŠ©ä¸´æ—¶å˜é‡ã€‚</p>
<p>å¦å¤–ï¼Œ<code>Polars</code>èƒ½å¹¶è¡Œè®¡ç®—æ¯ä¸€ä¸ª <code>if -&gt; then -&gt; otherwise</code>çš„åˆ†æ”¯ã€‚å½“åˆ†æ”¯çš„è®¡ç®—å¤æ‚åº¦æé«˜æ—¶ï¼Œå°±èƒ½ä½“ç°å¹¶è¡Œè®¡ç®—çš„ä¼˜åŠ¿äº†ã€‚</p>
<h2 id="ç­›é€‰"><a class="header" href="#ç­›é€‰">ç­›é€‰</a></h2>
<h3 id="pandas-2"><a class="header" href="#pandas-2"><code>Pandas</code></a></h3>
<pre><code class="language-python">df.loc[(df['sqft_living'] &gt; 2500) &amp; (df['price'] &lt; 300000)]
</code></pre>
<h3 id="polars-2"><a class="header" href="#polars-2"><code>Polars</code></a></h3>
<pre><code class="language-python">df.filter(
    (pl.col(&quot;m2_living&quot;) &gt; 2500) &amp; (pl.col(&quot;price&quot;) &lt; 300000)
)
</code></pre>
<blockquote>
<p>PS: è¿™éƒ¨åˆ†å†…å®¹è¿˜åœ¨å»ºè®¾ä¸­ï¼Œå†…å®¹æœ‰ç¼ºå°‘ï¼Ÿæ¬¢è¿æäº¤PR!</p>
</blockquote>
<h2 id="æ²¡æœ‰ç´¢å¼•åˆ—"><a class="header" href="#æ²¡æœ‰ç´¢å¼•åˆ—">æ²¡æœ‰ç´¢å¼•åˆ—</a></h2>
<p>æ ¹æœ¬ä¸éœ€è¦ç´¢å¼•åˆ—ï¼æ²¡æœ‰ç´¢å¼•åˆ—ä¼šè®©å¤„ç†å˜å¾—æ›´ç®€å•ã€‚å¦‚æœä½ ä¸ç›¸ä¿¡æ¥è¯´æœæˆ‘ä»¬å§!</p>
<h2 id="pandasé‡å¡‘"><a class="header" href="#pandasé‡å¡‘">Pandasé‡å¡‘</a></h2>
<p>åœ¨<code>Pandas</code>æ–‡æ¡£ä¸­æ¼”ç¤ºäº†ä¸€ç§èšåˆæ“ä½œ <code>transform</code>ï¼ˆé‡å¡‘ï¼‰ï¼š</p>
<h3 id="pandas-3"><a class="header" href="#pandas-3"><code>Pandas</code></a></h3>
<pre><code class="language-python">df = pd.DataFrame({
    &quot;c&quot;: [1, 1, 1, 2, 2, 2, 2],
    &quot;type&quot;: [&quot;m&quot;, &quot;n&quot;, &quot;o&quot;, &quot;m&quot;, &quot;m&quot;, &quot;n&quot;, &quot;n&quot;]
})

df[&quot;size&quot;] = df.groupby(&quot;c&quot;)[&quot;type&quot;].transform(len)
</code></pre>
<p>ä½¿ç”¨<code>Pandas</code> è¦å…ˆèšåˆ<code>&quot;c&quot;</code>åˆ—ã€æˆªå–å‡º<code>&quot;type&quot;</code>åˆ—ã€è®¡ç®—ç»„çš„<code>é•¿åº¦</code>ï¼Œæœ€åå°†ç»“æœæ‹¼æ¥å›åŸå§‹<code>DataFrame</code>ä¸­ã€‚</p>
<p>å…¶ç»“æœæ˜¯:</p>
<pre><code>   c type size
0  1    m    3
1  1    n    3
2  1    o    3
3  2    m    4
4  2    m    4
5  2    n    4
6  2    n    4
</code></pre>
<h3 id="polars-3"><a class="header" href="#polars-3"><code>Polars</code></a></h3>
<p>åœ¨ <code>Polars</code>ä¸­å¯ä»¥ç”¨ <code>çª—å£</code> å‡½æ•°æ¥è¾¾åˆ°ç›¸åŒçš„ç›®çš„ã€‚</p>
<pre><code class="language-python">df.select([
    pl.all(),
    pl.col(&quot;type&quot;).count().over(&quot;c&quot;).alias(&quot;size&quot;)
])
</code></pre>
<pre><code>shape: (7, 3)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ c   â”† type â”† size â”‚
â”‚ --- â”† ---  â”† ---  â”‚
â”‚ i64 â”† str  â”† u32  â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ 1   â”† m    â”† 3    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 1   â”† n    â”† 3    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 1   â”† o    â”† 3    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2   â”† m    â”† 4    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2   â”† m    â”† 4    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2   â”† n    â”† 4    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2   â”† n    â”† 4    â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>å› ä¸ºæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰çš„æ“ä½œæ”¾åœ¨ä¸€ä¸ªè¯­å¥ä¸­ï¼Œå› æ­¤ç»“åˆå¤šä¸ª<code>çª—å£</code>å‡½æ•°ï¼Œç”šè‡³ç»“åˆä¸åŒçš„ç»„éƒ½æ˜¯å¯ä»¥çš„!</p>
<p><code>Polars</code>ä¼šå°†åº”ç”¨äºç›¸åŒç»„çš„<code>çª—å£</code>å‡½æ•°è¡¨è¾¾å¼ç¼“å­˜ï¼Œæ‰€ä»¥å°†å¤šä¸ªè¡¨è¾¾å¼å…¥åœ¨ä¸€ä¸ª<code>select</code>è¯­å¥ä¸­æ—¢æ–¹ä¾¿<strong>ä¸”</strong>ä¼˜é›…ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="language-python">df.select([
    pl.all(),
    pl.col(&quot;c&quot;).count().over(&quot;c&quot;).alias(&quot;size&quot;),
    pl.col(&quot;c&quot;).sum().over(&quot;type&quot;).alias(&quot;sum&quot;),
    pl.col(&quot;c&quot;).reverse().over(&quot;c&quot;).flatten().alias(&quot;reverse_type&quot;)
])
</code></pre>
<pre><code>shape: (7, 5)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ c   â”† type â”† size â”† sum â”† reverse_type â”‚
â”‚ --- â”† ---  â”† ---  â”† --- â”† ---          â”‚
â”‚ i64 â”† str  â”† u32  â”† i64 â”† i64          â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 1   â”† m    â”† 3    â”† 5   â”† 2            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 1   â”† n    â”† 3    â”† 5   â”† 2            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 1   â”† o    â”† 3    â”† 1   â”† 2            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2   â”† m    â”† 4    â”† 5   â”† 2            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2   â”† m    â”† 4    â”† 5   â”† 1            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2   â”† n    â”† 4    â”† 5   â”† 1            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2   â”† n    â”† 4    â”† 5   â”† 1            â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h1 id="ä»-apache-spark-è½¬åŒ–"><a class="header" href="#ä»-apache-spark-è½¬åŒ–">ä» Apache Spark è½¬åŒ–</a></h1>
<h2 id="åŸºäºåˆ—çš„-api-vs-åŸºäºè¡Œçš„-api"><a class="header" href="#åŸºäºåˆ—çš„-api-vs-åŸºäºè¡Œçš„-api">åŸºäºåˆ—çš„ API vs. åŸºäºè¡Œçš„ API</a></h2>
<p><code>Spark</code> <code>DataFrame</code> ç±»ä¼¼äºä¸€ä¸ªè¡Œçš„é›†åˆï¼Œè€Œ <code>Polars</code> <code>DataFrame</code> æ›´æ¥è¿‘äºä¸€ä¸ªåˆ—çš„é›†åˆã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨ <code>Polars</code> ä¸­ä»¥ <code>Spark</code> ä¸­ä¸å¯èƒ½çš„æ–¹å¼ç»„åˆåˆ—ï¼Œå› ä¸º <code>Spark</code> ä¿ç•™äº†æ¯ä¸€è¡Œä¸­çš„æ•°æ®å…³ç³»ã€‚</p>
<p>è€ƒè™‘ä¸€ä¸‹ä¸‹é¢è¿™ä¸ªæ ·æœ¬æ•°æ®é›†ã€‚</p>
<pre><code class="language-python">import polars as pl

df = pl.DataFrame({
    &quot;foo&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;d&quot;],
    &quot;bar&quot;: [1, 2, 3, 4, 5],
})

dfs = spark.createDataFrame(
    [
        (&quot;a&quot;, 1),
        (&quot;b&quot;, 2),
        (&quot;c&quot;, 3),
        (&quot;d&quot;, 4),
        (&quot;d&quot;, 5),
    ],
    schema=[&quot;foo&quot;, &quot;bar&quot;],
)
</code></pre>
<h3 id="æ¡ˆä¾‹-1-åˆå¹¶-head-ä¸-sum"><a class="header" href="#æ¡ˆä¾‹-1-åˆå¹¶-head-ä¸-sum">æ¡ˆä¾‹ 1: åˆå¹¶ <code>head</code> ä¸ <code>sum</code></a></h3>
<p>åœ¨ <code>Polars</code> ä¸­ä½ å¯ä»¥å†™å‡ºä¸‹é¢çš„è¯­å¥ï¼š</p>
<pre><code class="language-python">df.select([
    pl.col(&quot;foo&quot;).sort().head(2),
    pl.col(&quot;bar&quot;).filter(pl.col(&quot;foo&quot;) == &quot;d&quot;).sum()
])
</code></pre>
<p>è¯¥ä»£ç æ®µè¾“å‡º:</p>
<pre><code>shape: (2, 2)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ foo â”† bar â”‚
â”‚ --- â”† --- â”‚
â”‚ str â”† i64 â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ a   â”† 9   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ b   â”† 9   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>åˆ— <code>foo</code> å’Œ <code>bar</code> ä¸Šçš„è¡¨è¾¾å¼æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚ç”±äº <code>bar</code> ä¸Šçš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ªå•ä¸€çš„å€¼ï¼Œè¿™ä¸ªå€¼åœ¨ <code>foo</code> è¡¨è¾¾å¼è¾“å‡ºçš„æ¯ä¸ªå€¼ä¸­éƒ½ä¼šé‡å¤ï¼Œä½†æ˜¯ <code>a</code> å’Œ <code>b</code> ä¸äº§ç”Ÿ <code>9</code> æ²¡æœ‰å…³ç³»ã€‚</p>
<p>è¦åœ¨ <code>Spark</code> ä¸­åšç±»ä¼¼çš„äº‹æƒ…ï¼Œä½ éœ€è¦å•ç‹¬è®¡ç®—æ€»å’Œï¼Œå¹¶å°†å…¶ä½œä¸ºå­—é¢å€¼è¿”å›ï¼š</p>
<pre><code class="language-python">from pyspark.sql.functions import col, sum, lit

bar_sum = (
    dfs
    .where(col(&quot;foo&quot;) == &quot;d&quot;)
    .groupBy()
    .agg(sum(col(&quot;bar&quot;)))
    .take(1)[0][0]
)

(
    dfs
    .orderBy(&quot;foo&quot;)
    .limit(2)
    .withColumn(&quot;bar&quot;, lit(bar_sum))
    .show()
)
</code></pre>
<p>è¯¥ä»£ç æ®µè¾“å‡º:</p>
<pre><code>+---+---+
|foo|bar|
+---+---+
|  a|  9|
|  b|  9|
+---+---+
</code></pre>
<h3 id="æ¡ˆä¾‹-2-åˆå¹¶ä¸¤ä¸ª-head"><a class="header" href="#æ¡ˆä¾‹-2-åˆå¹¶ä¸¤ä¸ª-head">æ¡ˆä¾‹ 2: åˆå¹¶ä¸¤ä¸ª <code>head</code></a></h3>
<p>åœ¨ <code>Polars</code> ä¸­ä½ å¯ä»¥åœ¨åŒä¸€ä¸ª DataFrame ä¸Šç»“åˆä¸¤ä¸ªä¸åŒçš„ <code>head</code> è¡¨è¾¾å¼ï¼Œåªè¦å®ƒä»¬è¿”å›ç›¸åŒæ•°é‡çš„å€¼ã€‚</p>
<pre><code class="language-python">df.select([
    pl.col(&quot;foo&quot;).sort().head(2),
    pl.col(&quot;bar&quot;).sort(reverse=True).head(2),
])
</code></pre>
<p>è¯¥ä»£ç æ®µè¾“å‡º:</p>
<pre><code>shape: (3, 2)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ foo â”† bar â”‚
â”‚ --- â”† --- â”‚
â”‚ str â”† i64 â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ a   â”† 5   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ b   â”† 4   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>åŒæ ·ï¼Œè¿™é‡Œçš„ä¸¤ä¸ª <code>head</code> è¡¨è¾¾å¼æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œ<code>a</code> ä¸ <code>5</code> å’Œ <code>b</code> ä¸ <code>4</code> çš„é…å¯¹çº¯ç²¹æ˜¯è¡¨è¾¾å¼è¾“å‡ºçš„ä¸¤åˆ—å¹¶åˆ—çš„ç»“æœã€‚</p>
<p>ä¸ºäº†åœ¨ <code>Spark</code> ä¸­å®Œæˆç±»ä¼¼çš„å·¥ä½œï¼Œä½ éœ€è¦ç”Ÿæˆä¸€ä¸ªäººå·¥çš„ key ä½¿ä½ èƒ½å¤Ÿä»¥ç›¸åŒçš„æ–¹å¼è¿æ¥è¿™äº›å€¼ã€‚</p>
<pre><code class="language-python">from pyspark.sql import Window
from pyspark.sql.functions import row_number

foo_dfs = (
    dfs
    .withColumn(
        &quot;rownum&quot;,
        row_number().over(Window.orderBy(&quot;foo&quot;))
    )
)

bar_dfs = (
    dfs
    .withColumn(
        &quot;rownum&quot;,
        row_number().over(Window.orderBy(col(&quot;bar&quot;).desc()))
    )
)

(
    foo_dfs.alias(&quot;foo&quot;)
    .join(bar_dfs.alias(&quot;bar&quot;), on=&quot;rownum&quot;)
    .select(&quot;foo.foo&quot;, &quot;bar.bar&quot;)
    .limit(2)
    .show()
)
</code></pre>
<p>è¯¥ä»£ç æ®µè¾“å‡º:</p>
<pre><code>+---+---+
|foo|bar|
+---+---+
|  a|  5|
|  b|  4|
+---+---+
</code></pre>
<h1 id="æ—¶é—´åºåˆ—"><a class="header" href="#æ—¶é—´åºåˆ—">æ—¶é—´åºåˆ—</a></h1>
<p><code>Polars</code> ä¸ºæ—¶é—´åºåˆ—é‡é‡‡æ ·æä¾›äº†å¼ºå¤§çš„ API æ”¯æŒã€‚è®¸å¤šäººéƒ½çŸ¥é“ <code>Pandas</code> ä¸­ <code>df.resample</code> æä¾›äº†é‡é‡‡æ ·åŠŸèƒ½ã€‚</p>
<p><code>Polars</code> åœ¨ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢ä¸ <code>Pandas</code> æœ‰æ‰€åŒºåˆ«ï¼š</p>
<ul>
<li>ä¸Šé‡‡æ · (Upsampling)</li>
<li>ä¸‹é‡‡æ · (Downsampling)</li>
</ul>
<h2 id="ä¸Šé‡‡æ ·-upsampling"><a class="header" href="#ä¸Šé‡‡æ ·-upsampling">ä¸Šé‡‡æ · (Upsampling)</a></h2>
<p>ä¸Šé‡‡æ ·å®é™…ä¸Šç›¸å½“äºå°†ä¸€ä¸ªæ—¥æœŸèŒƒå›´ä¸ä½ çš„æ•°æ®é›†è¿›è¡Œå·¦å…³è” (left join) æ“ä½œï¼Œå¹¶å¡«å……ç¼ºå¤±æ•°æ®ã€‚<code>Polars</code> ä¸ºæ­¤æ“ä½œ
æä¾›äº†å°è£…æ–¹æ³•ï¼Œä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„ä¸€ä¸ªç¤ºä¾‹ã€‚</p>
<h2 id="ä¸‹é‡‡æ ·-downsampling"><a class="header" href="#ä¸‹é‡‡æ ·-downsampling">ä¸‹é‡‡æ · (Downsampling)</a></h2>
<p>ä¸‹é‡‡æ ·å¾ˆæœ‰æ„æ€ã€‚ä½ éœ€è¦å¤„ç†æ—¥æœŸé—´éš”ã€çª—å£æŒç»­æ—¶é—´ã€èšåˆç­‰é—®é¢˜ã€‚</p>
<p><code>Polars</code> å°†ä¸‹é‡‡æ ·è§†ä¸º <strong>groupby</strong> æ“ä½œçš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œå› æ­¤è¡¨è¾¾å¼ API ä¸º <strong>groupby</strong> ä¸Šä¸‹æ–‡æä¾›äº†ä¸¤ä¸ªé¢å¤–çš„å…¥å£ã€‚</p>
<ul>
<li><a href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.groupby_dynamic.html">groupby_dynamic</a></li>
<li><a href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.groupby_rolling.html">groupby_rolling</a></li>
</ul>
<p>ä½ å¯ä»¥é€šè¿‡è°ƒç”¨äºŒè€…å…¶ä¸­ä»»ä½•ä¸€ä¸ªå‡½æ•°æ¥è·å–å¯¹è¡¨è¾¾å¼ API çš„å®Œæ•´è®¿é—®ï¼Œå®ƒæœ‰ç€å¼ºå¤§çš„æ€§èƒ½ï¼</p>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸‹é¢å‡ ä¸ªç¤ºä¾‹æ¥ç†è§£è¿™æ ·åšçš„æ„ä¹‰ã€‚</p>
<h2 id="åŠ¨æ€åˆ†ç»„-groupby-dynamic"><a class="header" href="#åŠ¨æ€åˆ†ç»„-groupby-dynamic">åŠ¨æ€åˆ†ç»„ (Groupby Dynamic)</a></h2>
<p>åœ¨ä¸‹é¢çš„ä¸€æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬ä»¥ <strong>å¤©</strong> (<code>&quot;1d&quot;</code>) ä¸ºå•ä½ï¼ŒæŠŠå…³äº 2021 å¹´çš„ <code>æ—¥æœŸèŒƒå›´ (date range)</code> åˆ›å»ºä¸ºä¸€ä¸ª <code>DataFrame</code>ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºèµ·å§‹äºæ¯ <strong>æœˆ</strong> (<code>&quot;1mo&quot;</code>)ï¼Œé•¿åº¦ä¸º <code>1</code> ä¸ªæœˆçš„åŠ¨æ€çª—å£ (dynamic windows)ã€‚åŠ¨æ€çª—å£çš„å¤§å°å¹¶ä¸ç”± <code>DataFrame</code>
ä¸­çš„è¡Œæ•°å†³å®šï¼Œè€Œæ˜¯ç”±ä¸€ä¸ªæ—¶é—´å•ä½ (temporal unit) å†³å®šï¼Œæ¯”å¦‚ä¸€å¤© (<code>&quot;1d&quot;</code>)ï¼Œä¸‰å‘¨ (<code>&quot;3w&quot;</code>)ï¼Œäº¦æˆ–æ˜¯äº”çº³ç§’ (<code>&quot;5ns&quot;</code>) ...
å¸Œæœ›è¿™ä¸ªä¾‹å­æœ‰åŠ©äºè®©ä½ ç†è§£åŠ¨æ€çª—å£çš„å«ä¹‰ã€‚</p>
<p>åŒ¹é…æŸä¸ªåŠ¨æ€çª—å£çš„å€¼ä¼šè¢«åˆ†é…åˆ°è¯¥çª—å£æ‰€å¯¹åº”çš„ç»„ä¸­ï¼Œæ¥ä¸‹æ¥ä½ å¯ä»¥ç”¨å¼ºå¤§çš„è¡¨è¾¾å¼ API è¿›è¡Œèšåˆæ“ä½œã€‚</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹ä½¿ç”¨ <strong>groupby_dynamic</strong> æ¥è®¡ç®—ï¼š</p>
<ul>
<li>è·ç¦»æœˆåº•çš„å¤©æ•°</li>
<li>ä¸€ä¸ªæœˆé‡Œçš„å¤©æ•°</li>
</ul>
<pre><code class="language-python"># æ—¶é—´è½´ï¼ˆä»lowåˆ°highï¼Œé—´éš”ä¸º1å¤©ï¼Œè½´åç§°ä¸º&quot;time&quot;ï¼‰
df = pl.date_range(low=datetime(2021, 1, 1), high=datetime(2021, 12, 31), interval=&quot;1d&quot;, name=&quot;time&quot;).to_frame()

out = (
    df.groupby_dynamic(&quot;time&quot;, every=&quot;1mo&quot;, period=&quot;1mo&quot;, closed=&quot;left&quot;)
    .agg(
        [
            pl.col(&quot;time&quot;).cumcount().reverse().head(3).alias(&quot;day/eom&quot;),
            ((pl.col(&quot;time&quot;) - pl.col(&quot;time&quot;).first()).last().dt.days() + 1).alias(&quot;days_in_month&quot;),
        ]
    )
    .explode(&quot;day/eom&quot;)
)
print(out)
</code></pre>
<pre><code class="language-text">shape: (36, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ time                â”† day/eom â”† days_in_month â”‚
â”‚ ---                 â”† ---     â”† ---           â”‚
â”‚ datetime[ns]        â”† u32     â”† i64           â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 2021-01-01 00:00:00 â”† 30      â”† 31            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-01-01 00:00:00 â”† 29      â”† 31            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-01-01 00:00:00 â”† 28      â”† 31            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-02-01 00:00:00 â”† 27      â”† 28            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ ...                 â”† ...     â”† ...           â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-11-01 00:00:00 â”† 27      â”† 30            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-12-01 00:00:00 â”† 30      â”† 31            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-12-01 00:00:00 â”† 29      â”† 31            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-12-01 00:00:00 â”† 28      â”† 31            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>è¦å®šä¹‰ä¸€ä¸ªåŠ¨æ€çª—å£ï¼Œéœ€è¦æä¾›ä»¥ä¸‹ä¸‰ä¸ªå‚æ•°ï¼š</p>
<ul>
<li><strong>every</strong>ï¼šçª—å£çš„æ—¶é—´é—´éš”</li>
<li><strong>period</strong>ï¼šçª—å£çš„æŒç»­æ—¶é—´</li>
<li><strong>offset</strong>ï¼šå¯ä»¥å¯¹çª—å£çš„å¼€å§‹è¿›è¡Œåç§»</li>
</ul>
<p>å› ä¸º <em><strong>every</strong></em> å¹¶ä¸æ€»æ˜¯éœ€è¦ç­‰äº <em><strong>period</strong></em>ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ç§éå¸¸çµæ´»çš„æ–¹å¼æ¥åˆ›å»ºå¾ˆå¤šç»„åˆ«ã€‚å®ƒä»¬å¯ä»¥äº’ç›¸é‡å ï¼Œä¹Ÿå¯ä»¥åœ¨ç»„é—´ç•™å‡ºè¾¹ç•Œã€‚</p>
<p>æˆ‘ä»¬å…ˆä»ç®€å•çš„ä¾‹å­å¼€å§‹ ğŸ¥± æƒ³æƒ³çœ‹ä¸‹é¢å‡ ç»„å‚æ•°ä¼šåˆ›å»ºå‡ºæ€ä¹ˆæ ·çš„çª—å£ã€‚</p>
<blockquote>
</blockquote>
<ul>
<li>every: 1 å¤© -&gt; <code>&quot;1d&quot;</code></li>
<li>period: 1 å¤© -&gt; <code>&quot;1d&quot;</code></li>
</ul>
<pre><code class="language-text">åˆ›å»ºå‡ºçš„çª—å£ç›¸é‚»ï¼Œä¸”é•¿åº¦ç›¸ç­‰
|--|
   |--|
      |--|
</code></pre>
<blockquote>
</blockquote>
<ul>
<li>every: 1 å¤© -&gt; <code>&quot;1d&quot;</code></li>
<li>period: 2 å¤© -&gt; <code>&quot;2d&quot;</code></li>
</ul>
<pre><code class="language-text">çª—å£ä¹‹é—´æœ‰ 1 å¤©çš„é‡å 
|----|
   |----|
      |----|
</code></pre>
<blockquote>
</blockquote>
<ul>
<li>every: 2 å¤© -&gt; <code>&quot;2d&quot;</code></li>
<li>period: 1 å¤© -&gt; <code>&quot;1d&quot;</code></li>
</ul>
<pre><code class="language-text">ä¸¤ä¸ªçª—å£ä¹‹é—´ç•™æœ‰é—´éš”ï¼Œåœ¨è¿™æ®µèŒƒå›´å†…çš„æ•°æ®ä¸å±äºä»»ä½•ä¸€ä¸ªç»„åˆ«
|--|
       |--|
              |--|
</code></pre>
<h2 id="æ»šåŠ¨åˆ†ç»„-rolling-groupby"><a class="header" href="#æ»šåŠ¨åˆ†ç»„-rolling-groupby">æ»šåŠ¨åˆ†ç»„ (Rolling Groupby)</a></h2>
<p>æ»šåŠ¨åˆ†ç»„æ˜¯ <code>groupby</code> ä¸Šä¸‹æ–‡çš„å¦ä¸€ä¸ªå…¥å£ã€‚ä½†ä¸ <code>groupby_dynamic</code> ä¸åŒçš„æ˜¯ï¼Œçª—å£çš„è®¾ç½®ä¸æ¥å—å‚æ•° <code>every</code> å’Œ <code>period</code> â€”â€”
å¯¹äºä¸€ä¸ªæ»šåŠ¨åˆ†ç»„ï¼Œçª—å£æ ¹æœ¬å°±ä¸æ˜¯å›ºå®šçš„ï¼å®ƒä»¬ç”± <code>index_column</code> ä¸­çš„å€¼å†³å®šã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªå€¼ä¸º<code>{2021-01-01, 20210-01-05}</code> çš„æ—¶é—´åºåˆ—ï¼Œä½¿ç”¨å‚æ•° <code>period=&quot;5d&quot;</code> å°†åˆ›å»ºä»¥ä¸‹çª—å£ï¼š</p>
<pre><code class="language-text">
2021-01-01   2021-01-06
    |----------|

       2021-01-05   2021-01-10
             |----------|
</code></pre>
<p>ç”±äºæ»šåŠ¨åˆ†ç»„çš„çª—å£æ€»æ˜¯ç”± <code>DataFrame</code> åˆ—ä¸­çš„å€¼å†³å®šï¼Œç»„åˆ«çš„æ•°ç›®æ€»æ˜¯ä¸åŸ <code>DataFrame</code> ç›¸ç­‰ã€‚</p>
<h2 id="å°†åŠ¨æ€åˆ†ç»„ä¸æ»šåŠ¨åˆ†ç»„ç»“åˆèµ·æ¥"><a class="header" href="#å°†åŠ¨æ€åˆ†ç»„ä¸æ»šåŠ¨åˆ†ç»„ç»“åˆèµ·æ¥">å°†åŠ¨æ€åˆ†ç»„ä¸æ»šåŠ¨åˆ†ç»„ç»“åˆèµ·æ¥</a></h2>
<p>ç”¨æ­£å¸¸çš„ groupby æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸¤ç§åˆ†ç»„æ–¹å¼ç»“åˆèµ·æ¥ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨åŠ¨æ€åˆ†ç»„çš„ä¾‹å­ï¼š</p>
<pre><code class="language-python">import polars as pl
from datetime import datetime


df = pl.DataFrame(
    {
        &quot;time&quot;: pl.date_range(
            low=datetime(2021, 12, 16),
            high=datetime(2021, 12, 16, 3),
            interval=&quot;30m&quot;,
        ),
        &quot;groups&quot;: [&quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;a&quot;, &quot;a&quot;],
    }
)
print(out)
</code></pre>
<pre><code class="language-text">shape: (7, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ time                â”† groups â”‚
â”‚ ---                 â”† ---    â”‚
â”‚ datetime[ns]        â”† str    â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 2021-12-16 00:00:00 â”† a      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-12-16 00:30:00 â”† a      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-12-16 01:00:00 â”† a      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-12-16 01:30:00 â”† b      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-12-16 02:00:00 â”† b      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-12-16 02:30:00 â”† a      â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2021-12-16 03:00:00 â”† a      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<pre><code class="language-python"># åŠ¨æ€åˆ†ç»„
out = df.groupby_dynamic(
    &quot;time&quot;,
    every=&quot;1h&quot;,
    closed=&quot;both&quot;,
    by=&quot;groups&quot;,
    include_boundaries=True,
).agg([pl.count()])
print(out)
</code></pre>
<pre><code class="language-text">shape: (7, 5)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ groups â”† _lower_boundary     â”† _upper_boundary     â”† time                â”† count â”‚
â”‚ ---    â”† ---                 â”† ---                 â”† ---                 â”† ---   â”‚
â”‚ str    â”† datetime[ns]        â”† datetime[ns]        â”† datetime[ns]        â”† u32   â”‚
â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ a      â”† 2021-12-15 23:00:00 â”† 2021-12-16 00:00:00 â”† 2021-12-16 00:00:00 â”† 1     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ a      â”† 2021-12-16 00:00:00 â”† 2021-12-16 01:00:00 â”† 2021-12-16 00:00:00 â”† 3     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ a      â”† 2021-12-16 01:00:00 â”† 2021-12-16 02:00:00 â”† 2021-12-16 01:00:00 â”† 1     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ a      â”† 2021-12-16 02:00:00 â”† 2021-12-16 03:00:00 â”† 2021-12-16 02:00:00 â”† 2     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ a      â”† 2021-12-16 03:00:00 â”† 2021-12-16 04:00:00 â”† 2021-12-16 03:00:00 â”† 1     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ b      â”† 2021-12-16 01:00:00 â”† 2021-12-16 02:00:00 â”† 2021-12-16 01:00:00 â”† 2     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ b      â”† 2021-12-16 02:00:00 â”† 2021-12-16 03:00:00 â”† 2021-12-16 02:00:00 â”† 1     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 id="ä¸Šé‡‡æ ·"><a class="header" href="#ä¸Šé‡‡æ ·">ä¸Šé‡‡æ ·</a></h2>
<blockquote>
<p>è¯¥éƒ¨åˆ†å†…å®¹ä»åœ¨ç¼–å†™ã€‚</p>
</blockquote>
<h1 id="how-can-i"><a class="header" href="#how-can-i">How Can Iï¼Ÿ</a></h1>
<p>æœ¬ç« åŒ…å«ä¸€äº›ç‰‡æ®µï¼Œå¯ä»¥å¸®åŠ©æ‚¨äº†è§£ç”¨<code>Polars</code>å®Œæˆäº‹æƒ…çš„æƒ¯ç”¨æ–¹æ³•çš„æœ€æ–°ä¿¡æ¯ã€‚</p>
<blockquote>
<p>â€œHow Can Iâ€ä¸€ç« æ­£åœ¨å»ºè®¾ä¸­ã€‚</p>
</blockquote>
<h1 id="io"><a class="header" href="#io">IO</a></h1>
<p><code>Polars</code> supports different file types, and its respective parsers are amongst the fastest
out there.</p>
<p>For instance, it is faster to load a CSV file <em>via</em> <code>Polars</code> before handing it to <code>Pandas</code>
than loading them using <code>Pandas</code>. Just run a
<code>pl.read_csv(&quot;&lt;FILE&gt;&quot;, rechunk=False).to_pandas()</code> to convince yourself!</p>
<h1 id="å­—ç¬¦åˆ†éš”å€¼"><a class="header" href="#å­—ç¬¦åˆ†éš”å€¼">å­—ç¬¦åˆ†éš”å€¼</a></h1>
<h2 id="è¯»å†™"><a class="header" href="#è¯»å†™">è¯»&amp;å†™</a></h2>
<p>è¯»å–CSVæ–‡ä»¶åº”è¯¥çœ‹èµ·æ¥å¾ˆç†Ÿæ‚‰:</p>
<pre><code class="language-python">df = pl.read_csv(&quot;path.csv&quot;)
</code></pre>
<p>CSVæ–‡ä»¶ä¼šæœ‰éå¸¸å¤šçš„æ ·å¼ï¼Œæ‰€ä»¥ä¸€å®šè¦å»çœ‹ä¸€ä¸‹
<a href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.read_csv.html"><code>read_csv()</code></a> APIã€‚</p>
<p>å†™å…¥CSVæ–‡ä»¶å¯ä»¥ç”¨
<a href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.write_csv.html"><code>write_csv()</code></a>æ–¹æ³•ã€‚</p>
<pre><code class="language-python">df = pl.DataFrame({&quot;foo&quot;: [1, 2, 3], &quot;bar&quot;: [None, &quot;bak&quot;, &quot;baz&quot;]})
df.write_csv(&quot;path.csv&quot;)
</code></pre>
<h2 id="æ‰«æ"><a class="header" href="#æ‰«æ">æ‰«æ</a></h2>
<p><code>Polars</code>å…è®¸ä½ <em>æ‰«æ</em>CSVæ–‡ä»¶ã€‚æ‰«ææ“ä½œå»¶è¿Ÿäº†å¯¹æ–‡ä»¶çš„å®é™…è§£æï¼Œ
å¹¶è¿”å›ä¸€ä¸ªå»¶è¿Ÿè®¡ç®—çš„å®¹å™¨<code>LazyFrame</code>ã€‚</p>
<pre><code class="language-python">df = pl.scan_csv(&quot;path.csv&quot;)
</code></pre>
<p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šè¿™æ ·è®¾è®¡çš„ç²¾å¦™ä¹‹å¤„ï¼Œ
è¯·ç§»æ­¥<code>Polars</code><a href="howcani/io/../../optimizations/intro.html">Optimizations</a>è¿™ä¸€ç« ã€‚</p>
<h1 id="parquet"><a class="header" href="#parquet">Parquet</a></h1>
<p>åŠ è½½æˆ–å†™å…¥ <a href="https://parquet.apache.org/"><code>Parquet</code>æ–‡ä»¶</a>å¿«å¦‚é—ªç”µã€‚</p>
<p><code>Pandas</code> ä½¿ç”¨ <a href="https://arrow.apache.org/docs/python/"><code>PyArrow</code></a>ï¼ˆç”¨äºApache <code>Arrow</code>çš„<code>Python</code>åº“ï¼‰å°†<code>Parquet</code>æ•°æ®åŠ è½½åˆ°å†…å­˜ï¼Œä½†ä¸å¾—ä¸å°†æ•°æ®å¤åˆ¶åˆ°äº†<code>Pandas</code>çš„å†…å­˜ç©ºé—´ä¸­ã€‚</p>
<p><code>Polars</code>å°±æ²¡æœ‰è¿™éƒ¨åˆ†é¢å¤–çš„å†…å­˜å¼€é”€ï¼Œå› ä¸ºè¯»å–<code>Parquet</code>æ—¶ï¼Œ<code>Polars</code>ä¼šç›´æ¥å¤åˆ¶è¿›<code>Arrow</code>çš„å†…å­˜ç©ºé—´ï¼Œä¸”<em>å§‹ç»ˆä½¿ç”¨è¿™å—å†…å­˜</em>ã€‚</p>
<h2 id="è¯»å†™-1"><a class="header" href="#è¯»å†™-1">è¯»&amp;å†™</a></h2>
<pre><code class="language-python">df = pl.read_parquet(&quot;path.parquet&quot;)
</code></pre>
<pre><code class="language-python">df = pl.DataFrame({&quot;foo&quot;: [1, 2, 3], &quot;bar&quot;: [None, &quot;bak&quot;, &quot;baz&quot;]})
df.write_parquet(&quot;path.parquet&quot;)
</code></pre>
<h2 id="æ‰«æ-1"><a class="header" href="#æ‰«æ-1">æ‰«æ</a></h2>
<p>Polarså…è®¸ä½ æ‰«æ<code>Parquet</code>è¾“å…¥ã€‚æ‰«ææ“ä½œå»¶è¿Ÿäº†å¯¹æ–‡ä»¶çš„å®é™…è§£æï¼Œå¹¶è¿”å›ä¸€ä¸ªå»¶è¿Ÿè®¡ç®—çš„å®¹å™¨<code>LazyFrame</code>ã€‚</p>
<pre><code class="language-python">df = pl.scan_parquet(&quot;path.parquet&quot;)
</code></pre>
<p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šè¿™æ ·è®¾è®¡çš„ç²¾å¦™ä¹‹å¤„ï¼Œè¯·ç§»æ­¥<code>Polars</code><a href="howcani/io/../../optimizations/intro.html">Optimizations</a>è¿™ä¸€ç« ã€‚</p>
<h2 id="å¤„ç†å¤šä¸ªæ–‡ä»¶"><a class="header" href="#å¤„ç†å¤šä¸ªæ–‡ä»¶">å¤„ç†å¤šä¸ªæ–‡ä»¶</a></h2>
<p><code>Polars</code>å¯ä»¥æ ¹æ®æ‚¨çš„éœ€è¦å’Œå†…å­˜ç´§å¼ ç¨‹åº¦ï¼Œä»¥ä¸åŒçš„æ–¹å¼å¤„ç†å¤šä¸ªæ–‡ä»¶ã€‚</p>
<p>è®©æˆ‘ä»¬åˆ›å»ºä¸€äº›æ–‡ä»¶æ¥ä½¿ç”¨ä¸€äº›ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰ï¼š</p>
<pre><code class="language-python">import polars as pl

df = pl.DataFrame({&quot;foo&quot;: [1, 2, 3], &quot;bar&quot;: [None, &quot;ham&quot;, &quot;spam&quot;]})

for i in range(5):
    df.write_csv(f&quot;my_many_files_{i}.csv&quot;)
</code></pre>
<h2 id="è¯»å…¥å•ä¸ªdataframe"><a class="header" href="#è¯»å…¥å•ä¸ªdataframe">è¯»å…¥å•ä¸ª<code>DataFrame</code></a></h2>
<p>è¦å°†å¤šä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ª<code>DataFrame</code>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¨å±€æ¨¡å¼ï¼š</p>
<pre><code class="language-python">df = pl.read_csv(&quot;my_many_files_*.csv&quot;)
print(df)
</code></pre>
<pre><code class="language-text">shape: (15, 2)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ foo â”† bar  â”‚
â”‚ --- â”† ---  â”‚
â”‚ i64 â”† str  â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•¡
â”‚ 1   â”† null â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2   â”† ham  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 3   â”† spam â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 1   â”† null â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ ... â”† ...  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 3   â”† spam â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 1   â”† null â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2   â”† ham  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 3   â”† spam â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>è¦äº†è§£è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹æŸ¥è¯¢è®¡åˆ’ã€‚ä¸‹é¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯å•ç‹¬è¯»å–å¹¶è¿æ¥æˆä¸€ä¸ª<code>DataFrame</code> ã€‚<code>Polars</code>å°†å°è¯•å°†è¯»å–å¹¶è¡ŒåŒ–ã€‚</p>
<pre><code class="language-python">pl.scan_csv(&quot;my_many_files_*.csv&quot;).show_graph()
</code></pre>
<p><img src="multiple_files/../outputs/multiple_files/single_df_graph.png" alt="single_df_graph" /></p>
<h2 id="å¹¶è¡Œè¯»å–å’Œå¤„ç†"><a class="header" href="#å¹¶è¡Œè¯»å–å’Œå¤„ç†">å¹¶è¡Œè¯»å–å’Œå¤„ç†</a></h2>
<p>å¦‚æœæ‚¨çš„æ–‡ä»¶ä¸å¿…ä½äºå•ä¸ªè¡¨ä¸­ï¼Œæ‚¨è¿˜å¯ä»¥ä¸ºæ¯ä¸ªæ–‡ä»¶æ„å»ºä¸€ä¸ªæŸ¥è¯¢è®¡åˆ’ï¼Œå¹¶åœ¨<code>Polars</code>çº¿ç¨‹æ± ä¸­å¹¶è¡Œæ‰§è¡Œå®ƒä»¬ã€‚æ‰€æœ‰æŸ¥è¯¢è®¡åˆ’çš„æ‰§è¡Œéƒ½æ˜¯æå¥½çš„å¹¶è¡Œæ‰§è¡Œï¼Œä¸éœ€è¦ä»»ä½•é€šä¿¡ã€‚</p>
<pre><code class="language-python">import polars as pl
import glob

queries = []
for file in glob.glob(&quot;my_many_files_*.csv&quot;):
    q = pl.scan_csv(file).groupby(&quot;bar&quot;).agg([pl.count(), pl.sum(&quot;foo&quot;)])
    queries.append(q)

dataframes = pl.collect_all(queries)
print(dataframes)
</code></pre>
<pre><code class="language-text">[shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ bar  â”† count â”† foo â”‚
â”‚ ---  â”† ---   â”† --- â”‚
â”‚ str  â”† u32   â”† i64 â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ spam â”† 1     â”† 3   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ null â”† 1     â”† 1   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ ham  â”† 1     â”† 2   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜, shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ bar  â”† count â”† foo â”‚
â”‚ ---  â”† ---   â”† --- â”‚
â”‚ str  â”† u32   â”† i64 â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ spam â”† 1     â”† 3   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ null â”† 1     â”† 1   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ ham  â”† 1     â”† 2   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜, shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ bar  â”† count â”† foo â”‚
â”‚ ---  â”† ---   â”† --- â”‚
â”‚ str  â”† u32   â”† i64 â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ ham  â”† 1     â”† 2   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ null â”† 1     â”† 1   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ spam â”† 1     â”† 3   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜, shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ bar  â”† count â”† foo â”‚
â”‚ ---  â”† ---   â”† --- â”‚
â”‚ str  â”† u32   â”† i64 â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ null â”† 1     â”† 1   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ ham  â”† 1     â”† 2   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ spam â”† 1     â”† 3   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜, shape: (3, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ bar  â”† count â”† foo â”‚
â”‚ ---  â”† ---   â”† --- â”‚
â”‚ str  â”† u32   â”† i64 â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡
â”‚ ham  â”† 1     â”† 2   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ spam â”† 1     â”† 3   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ null â”† 1     â”† 1   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜]
</code></pre>
<h1 id="è¯»å–mysqlpostgressqliteredshiftclickhouse"><a class="header" href="#è¯»å–mysqlpostgressqliteredshiftclickhouse">è¯»å–MySQLã€Postgresã€Sqliteã€Redshiftã€Clickhouse</a></h1>
<p>ä»ä»¥ä¸Šæ•°æ®åº“ä¸­è¯»å–æ•°æ®ï¼Œè¯·å…ˆå®‰è£…<code>connector-x</code>ã€‚</p>
<pre><code class="language-shell">$  pip install connectorx&gt;=0.2.0a3
</code></pre>
<pre><code class="language-python">import polars as pl

conn = &quot;postgres://username:password@server:port/database&quot;
query = &quot;SELECT * FROM foo&quot;

pl.read_sql(query, conn)
</code></pre>
<h1 id="ä¸awsäº’åŠ¨"><a class="header" href="#ä¸awsäº’åŠ¨">ä¸AWSäº’åŠ¨</a></h1>
<blockquote>
<p>&quot;ä¸AWSäº’åŠ¨&quot;é¡µé¢æ­£åœ¨å»ºè®¾ä¸­ã€‚</p>
</blockquote>
<p>è¦è¯»å–æˆ–å†™å…¥AWSå­˜å‚¨æ¡¶ï¼Œéœ€è¦é¢å¤–çš„ä¾èµ–é¡¹ï¼š</p>
<pre><code class="language-shell">$ pip install s3fs
</code></pre>
<p>åœ¨æ¥ä¸‹æ¥çš„å‡ ä¸ªç‰‡æ®µä¸­ï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºå¦‚ä½•ä¸<code>Parquet</code>æ–‡ä»¶äº¤äº’ä½äºAWSæ¡¶ä¸Šã€‚</p>
<h2 id="è¯»å…¥"><a class="header" href="#è¯»å…¥">è¯»å…¥</a></h2>
<p>ä½¿ç”¨å¦‚ä¸‹åŠ è½½ä¸€ä¸ª<code>.parquet</code>ï¼š</p>
<pre><code class="language-python">import polars as pl
import pyarrow.parquet as pq
import s3fs

fs = s3fs.S3FileSystem()
bucket = &quot;&lt;YOUR_BUCKET&gt;&quot;
path = &quot;&lt;YOUR_PATH&gt;&quot;

dataset = pq.ParquetDataset(f&quot;s3://{bucket}/{path}&quot;, filesystem=fs)
df = pl.from_arrow(dataset.read())
</code></pre>
<h2 id="å†™å…¥"><a class="header" href="#å†™å…¥">å†™å…¥</a></h2>
<blockquote>
<p>è¯¥å†…å®¹æ­£åœ¨å»ºè®¾ä¸­ã€‚</p>
</blockquote>
<h1 id="ä¸googleçš„bigqueryäº¤äº’"><a class="header" href="#ä¸googleçš„bigqueryäº¤äº’">ä¸Googleçš„BigQueryäº¤äº’</a></h1>
<p>è¯»å†™BigQueryæ•°æ®åº“ï¼Œéœ€è¦é¢å¤–ä¾èµ–é¡¹ï¼š</p>
<pre><code class="language-shell">$ pip install google-cloud-bigquery
</code></pre>
<h2 id="è¯»å–"><a class="header" href="#è¯»å–">è¯»å–</a></h2>
<p>ä»BigQueryæŸ¥è¯¢å¹¶å¾—åˆ°<code>DataFrame</code>ï¼Œå¯ä»¥åƒè¿™æ ·ï¼š</p>
<pre><code class="language-python">import polars as pl
from google.cloud import bigquery

client = bigquery.Client()

# æ‰§è¡ŒæŸ¥è¯¢
QUERY = (
    'SELECT name FROM `bigquery-public-data.usa_names.usa_1910_2013` '
    'WHERE state = &quot;TX&quot; '
    'LIMIT 100')
query_job = client.query(QUERY)  # API è¯·æ±‚
rows = query_job.result()  # ç­‰å¾…æŸ¥è¯¢å®Œæˆ

df = pl.from_arrow(rows.to_arrow())
</code></pre>
<h2 id="å†™å…¥-1"><a class="header" href="#å†™å…¥-1">å†™å…¥</a></h2>
<blockquote>
<p>å†…å®¹è¿˜åœ¨å»ºè®¾ä¸­</p>
</blockquote>
<h1 id="ä¸postgresäº¤äº’"><a class="header" href="#ä¸postgresäº¤äº’">ä¸Postgresäº¤äº’</a></h1>
<h2 id="è¯»å–-1"><a class="header" href="#è¯»å–-1">è¯»å–</a></h2>
<p>ä»postgresæ•°æ®åº“ä¸­è¯»å–æ•°æ®ï¼Œéœ€è¦é¢å¤–ä¾èµ–é¡¹:</p>
<pre><code class="language-shell">$  pip install connectorx&gt;=0.2.0a3
</code></pre>
<pre><code class="language-python">import polars as pl

conn = &quot;postgresql://username:password@server:port/database&quot;
query = &quot;SELECT * FROM foo&quot;

pl.read_sql(query, conn)
</code></pre>
<h2 id="å†™å…¥-2"><a class="header" href="#å†™å…¥-2">å†™å…¥</a></h2>
<p>å†™å…¥postgresæ•°æ®åº“ï¼Œéœ€è¦é¢å¤–ä¾èµ–é¡¹:</p>
<pre><code class="language-shell">$ pip install psycopg2-binary
</code></pre>
<p>ç”¨<code>psycopg2</code>å†™å…¥postgresæ•°æ®åº“ï¼Œæˆ‘ä»¬ä¼šç”¨<code>æ‰¹å¤„ç†</code>çš„æ–¹æ³•ï¼Œé™åˆ¶ä¸æœåŠ¡å™¨çš„å¾€è¿”è¡Œç¨‹ä»¥æé«˜å†™å…¥æ€§èƒ½ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆè¦ä¿è¯æ‰€æœ‰çš„æ•°æ®ç±»å‹å¯ä»¥è¢«<code>psycopg2</code>æ‰€è¯†åˆ«ï¼Œå†ä½¿ç”¨<code>DataFrame.rows</code>è½»æ¾å°†æ¯åˆ—æ•°æ®è½¬ç½®æˆæ•°æ®åº“é©±åŠ¨ç¨‹åºå¯ä»¥å¤„ç†çš„è¡Œã€‚</p>
<pre><code class="language-python">from psycopg2 import sql
import psycopg2.extras
import polars as pl

# ä¸ä»¿å‡è®¾æœ‰ä¸€ä¸ªDataFrameï¼Œå…¶åˆ—åˆ†åˆ«ä¸ºï¼šæµ®ç‚¹ï¼Œæ•´æ•°ï¼Œå­—ç¬¦ä¸²ï¼Œæ—¥æœŸï¼ˆdate64ï¼‰ç±»å‹çš„æ•°æ®
df = pl.read_parquet(&quot;somefile.parquet&quot;)

# é¦–å…ˆå°† polars çš„ date64 æ•°æ®ç±»å‹è½¬æ¢æˆ python çš„ datetime å¯¹è±¡
for col in df:
    # åªè½¬æ¢date64ç±»å‹æ•°æ®
    if col.dtype == pl.Date64:
        df = df.with_column(col.dt.to_python_datetime())

# ä¸ºå­—æ®µååˆ›å»º sql æ ‡è¯†ç¬¦
# è¿™ä¸€æ­¥æ˜¯ä¸ºäº†åœ¨sqlè¯­å¥ä¸­å®‰å…¨æ’å…¥æ•°æ®
columns = sql.SQL(&quot;,&quot;).join(sql.Identifier(name) for name in df.columns)

# ä¸ºå€¼åˆ›å»ºå ä½ç¬¦ï¼Œä¹‹åå†è¢«å€¼å¡«å……
values = sql.SQL(&quot;,&quot;).join([sql.Placeholder() for _ in df.columns])

table_id = &quot;mytable&quot;

# å‡†å¤‡insertè¯­å¥
insert_stmt = sql.SQL(&quot;INSERT INTO ({}) VALUES({});&quot;).format(
    sql.Identifier(table_id), columns, values
)

# åˆ›å»ºä¸æ•°æ®åº“çš„è¿æ¥
conn = psycopg2.connect()
cur = conn.cursort()

# æ‰§è¡Œinsertè¯­å¥
psycopg2.extras.execute_batch(cur, insert_stmt, df.rows())
conn.commit()
</code></pre>
<h1 id="äº’é€šæ€§"><a class="header" href="#äº’é€šæ€§">äº’é€šæ€§</a></h1>
<h1 id="arrow"><a class="header" href="#arrow">Arrow</a></h1>
<p><code>Arrow</code> æ­£åœ¨è¿…é€Ÿåœ°æˆä¸ºåˆ—å¼æ•°æ® <em>äº‹å®ä¸Š</em> çš„æ ‡å‡†ã€‚è¿™æ„å‘³ç€å¯¹ <code>Arrow</code> çš„æ”¯æŒï¼ˆåŒ…æ‹¬è¯­è¨€ä¸å·¥å…·ï¼‰ä¹Ÿåœ¨è¿…é€Ÿå¢åŠ ã€‚
ç”±äºå¼€å‘è€…åœ¨è¿™ç§æ ¼å¼çš„èƒŒåæŠ•å…¥äº†å¤§é‡çš„åŠªåŠ›ä¸æ”¯æŒï¼Œä½¿ç”¨ <code>Arrow</code> å¯èƒ½æ˜¯å®Œæˆä¸‹é¢ä»»åŠ¡æœ€å¿«çš„æ–¹å¼ï¼š</p>
<ul>
<li>è¯»å†™ <code>Parquet</code> æ ¼å¼çš„æ–‡ä»¶</li>
<li>ä» CSV è¯»å–åˆ—å¼æ•°æ®</li>
<li>äº¤æ¢åˆ—å¼æ•°æ®</li>
</ul>
<p><code>Polars</code> ä½¿ç”¨ <code>Arrow</code> å†…å­˜ç¼“å†²ä½œä¸º <code>Polars</code> <code>Series</code> æœ€åŸºæœ¬çš„æ„å»ºæ¨¡å—ã€‚
è¿™æ„å‘³ç€å½“æˆ‘ä»¬è¦åœ¨ <code>Polars</code> å’Œ <code>Arrow</code> ä¹‹é—´äº¤æ¢æ•°æ®æ—¶ï¼Œæ— éœ€å¯¹æ•°æ®è¿›è¡Œ<strong>æ‹·è´</strong>æ“ä½œã€‚
è¿™ä¹Ÿæ„å‘³ç€ <code>Polars</code> è·å¾—äº† <code>Arrow</code> å¸¦æ¥çš„ä¸€åˆ‡æ€§èƒ½æå‡ã€‚</p>
<p>è¦å°† <code>Polars</code> çš„ <code>DataFrame</code> æˆ–è€… <code>Series</code> è½¬æ¢ä¸º <code>Arrow</code>ï¼Œåªéœ€ä½¿ç”¨ <code>.to_arrow()</code> å‡½æ•°ã€‚
ç±»ä¼¼çš„ï¼Œè¦ä» <code>Arrow</code> æ ¼å¼å¯¼å…¥æ•°æ®ï¼Œå¯ä»¥è°ƒç”¨ <code>.from_arrow()</code> å‡½æ•°ã€‚</p>
<h1 id="numpy"><a class="header" href="#numpy">NumPy</a></h1>
<p><code>Polars</code> çš„ <code>Series</code> æ”¯æŒ <code>NumPy</code> çš„
<a href="https://numpy.org/doc/stable/reference/ufuncs.html">é€šç”¨å‡½æ•° (ufuncs)</a>ã€‚
è°ƒç”¨å…ƒç´ å±‚é¢çš„ (element-wise) å‡½æ•°ï¼Œæ¯”å¦‚ <code>np.exp()</code>ã€<code>np.cos()</code> æˆ– <code>np.div()</code>ï¼ŒåŸºæœ¬ä¸Šæ²¡æœ‰é¢å¤–å¼€é”€ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>Polars</code> ä¸­çš„ç¼ºå¤±å€¼æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¯”ç‰¹æ©ç  â€”â€” å…¶åœ¨ <code>NumPy</code> ä¸­æ˜¯ä¸å¯è§çš„ã€‚
è¿™å¯èƒ½å¯¼è‡´çª—å£å‡½æ•°æˆ– <code>np.convolve()</code> è¾“å‡ºæœ‰ç¼ºé™·æˆ–ä¸å®Œæ•´çš„ç»“æœã€‚</p>
<p>è¦å°†ä¸€ä¸ª <code>Polars</code> <code>Series</code> è½¬æ¢ä¸º <code>NumPy</code> æ•°ç»„ï¼Œå¯ä»¥è°ƒç”¨ <code>.to_numpy()</code> å‡½æ•°ã€‚
è½¬æ¢æ—¶ï¼Œæ­¤å‡½æ•°å°†ä¼šæŠŠç¼ºå¤±å€¼æ›¿æ¢ä¸º <code>np.nan</code>ã€‚å¦‚æœ <code>Series</code> ä¸­æ²¡æœ‰ç¼ºå¤±å€¼ï¼Œæˆ–è½¬æ¢åä¸å†éœ€è¦è¿™äº›å€¼ï¼Œ
å¯ä»¥ä½¿ç”¨ <code>.view()</code> å‡½æ•°ä½œä¸ºä»£æ›¿ï¼Œè¿™å°†ä¸ºæ•°æ®ç”Ÿæˆä¸€ä¸ªé›¶æ‹·è´çš„ <code>NumPy</code> æ•°ç»„ã€‚</p>
<h1 id="æ•°æ®å¤„ç†"><a class="header" href="#æ•°æ®å¤„ç†">æ•°æ®å¤„ç†</a></h1>
<h1 id="å¤„ç†å­—ç¬¦ä¸²"><a class="header" href="#å¤„ç†å­—ç¬¦ä¸²">å¤„ç†å­—ç¬¦ä¸²</a></h1>
<p>æ„Ÿè°¢<code>Arrow</code> åç«¯, <code>Polars</code>å­—ç¬¦ä¸²æ“ä½œæ¯”ä½¿ç”¨<code>NumPy</code>æˆ–<code>Pandas</code>æ‰§è¡Œçš„ç›¸åŒæ“ä½œå¿«å¾—å¤šã€‚åœ¨åè€…ä¸­ï¼Œå­—ç¬¦ä¸²å­˜å‚¨ä¸º<code>Python</code>å¯¹è±¡ã€‚ åœ¨éå†<code>np.array</code> or the <code>pd.Series</code>æ—¶ï¼ŒCPUéœ€è¦è·Ÿè¸ªæ‰€æœ‰å­—ç¬¦ä¸²æŒ‡é’ˆï¼Œå¹¶è·³è½¬åˆ°è®¸å¤šéšæœºå†…å­˜ä½ç½®â€”â€”è¿™æ˜¯éå¸¸ä½æ•ˆçš„ç¼“å­˜ã€‚åœ¨<code>Polars</code>ï¼ˆé€šè¿‡<code>Arrow</code>æ•°æ®ç»“æ„ï¼‰ä¸­ï¼Œå­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­çš„ã€‚å› æ­¤ï¼Œå¯¹äºCPUæ¥è¯´ï¼Œéå†ç¼“å­˜æ˜¯æœ€ä¼˜çš„ï¼Œä¹Ÿæ˜¯å¯é¢„æµ‹çš„ã€‚</p>
<p><code>Polars</code>ä¸­å¯ç”¨çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°å¯ä»¥åœ¨ <a href="https://pola-rs.github.io/polars/py-polars/html/reference/series.html#strings">``str` namespace</a> ä¸­æ‰¾åˆ°ã€‚</p>
<p>ä¸‹é¢æ˜¯å‡ ä¸ªä¾‹å­ã€‚è¦è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<pre><code class="language-python">import polars as pl

df = pl.DataFrame({&quot;shakespeare&quot;: &quot;All that glitters is not gold&quot;.split(&quot; &quot;)})

df = df.with_column(pl.col(&quot;shakespeare&quot;).str.lengths().alias(&quot;letter_count&quot;))
</code></pre>
<p>è¿”å›ï¼š</p>
<pre><code class="language-text">shape: (6, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ shakespeare â”† letter_count â”‚
â”‚ ---         â”† ---          â”‚
â”‚ str         â”† u32          â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ All         â”† 3            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ that        â”† 4            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ glitters    â”† 8            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ is          â”† 2            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ not         â”† 3            â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ gold        â”† 4            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>ä¸‹é¢æ˜¯ä»å¥å­ä¸­è¿‡æ»¤å‡ºå† è¯ï¼ˆ<code>the</code>ã€<code>a</code>ã€<code>and</code>ã€<em>etc.</em>ï¼‰çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼š</p>
<pre><code class="language-python">import polars as pl

df = pl.DataFrame({&quot;a&quot;: &quot;The man that ate a whole cake&quot;.split(&quot; &quot;)})

df = df.filter(pl.col(&quot;a&quot;).str.contains(r&quot;(?i)^the$|^a$&quot;).is_not())
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="language-text">shape: (5, 1)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚ a     â”‚
â”‚ ---   â”‚
â”‚ str   â”‚
â•â•â•â•â•â•â•â•â•¡
â”‚ man   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ that  â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ ate   â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ whole â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ cake  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h1 id="æ—¶é—´æˆ³è§£æ"><a class="header" href="#æ—¶é—´æˆ³è§£æ">æ—¶é—´æˆ³è§£æ</a></h1>
<p><code>Polars</code> æä¾›äº†<code>4</code>æ—¶é—´æ•°æ®ç±»å‹ï¼š</p>
<ul>
<li><code>pl.Date</code>, ç”¨äº<strong>æ—¥æœŸ</strong>å¯¹è±¡ï¼šè‡ªUNIXçºªå…ƒä»¥æ¥çš„å¤©æ•°ï¼Œä¸º32ä½æœ‰ç¬¦å·æ•´æ•°ã€‚</li>
<li><code>pl.Datetime</code>, ç”¨äº<strong>datetime</strong>é¡¹ç›®ï¼šè‡ªUNIXçºªå…ƒä»¥æ¥çš„çº³ç§’æ•°ï¼Œä¸º64ä½æœ‰ç¬¦å·æ•´æ•°ã€‚</li>
<li><code>pl.Time</code>, ç¼–ç ä¸ºåˆå¤œåçš„çº³ç§’æ•°ã€‚</li>
</ul>
<p><code>Polars</code> å­—ç¬¦ä¸²(<code>pl.Utf8</code>) æ•°æ®ç±»å‹å¯ä»¥è§£æä¸ºå®ƒä»¬ä¸­çš„ä»»ä½•ä¸€ä¸ªã€‚æ‚¨å¯ä»¥è®©<code>Polars</code>å°è¯•çŒœæµ‹æ—¥æœŸ[time]çš„æ ¼å¼ï¼Œæˆ–è€…æ˜¾å¼æä¾›<code>fmt</code>è§„åˆ™ã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´ï¼ˆæŸ¥çœ‹æ­¤<a href="https://strftime.org/">æ­¤é“¾æ¥</a>ä»¥è·å–å…¨é¢åˆ—è¡¨ï¼‰ï¼š</p>
<ul>
<li><code>&quot;%Y-%m-%d&quot;</code> å¯¹äº <code>&quot;2020-12-31&quot;</code></li>
<li><code>&quot;%Y/%B/%d&quot;</code> å¯¹äº <code>&quot;2020/December/31&quot;</code></li>
<li><code>&quot;%B %y&quot;</code> å¯¹äº <code>&quot;December 20&quot;</code></li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<pre><code class="language-python">import polars as pl

dataset = pl.DataFrame({&quot;date&quot;: [&quot;2020-01-02&quot;, &quot;2020-01-03&quot;, &quot;2020-01-04&quot;], &quot;index&quot;: [1, 2, 3]})

q = dataset.lazy().with_column(pl.col(&quot;date&quot;).str.strptime(pl.Date, &quot;%Y-%m-%d&quot;))

df = q.collect()
</code></pre>
<p>è¿”å›ï¼š</p>
<pre><code class="language-text">shape: (3, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ date       â”† index â”‚
â”‚ ---        â”† ---   â”‚
â”‚ date       â”† i64   â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 2020-01-02 â”† 1     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2020-01-03 â”† 2     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2020-01-04 â”† 3     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>æ‰€æœ‰datetimeåŠŸèƒ½éƒ½æ˜¾ç¤ºåœ¨ <a href="https://pola-rs.github.io/polars/py-polars/html/reference/series.html#timeseries"><code>dt</code> å‘½åç©ºé—´</a>ä¸­ã€‚</p>
<h1 id="æ€§èƒ½"><a class="header" href="#æ€§èƒ½">æ€§èƒ½</a></h1>
<p>æœ¬ç« ä»‹ç»äº†ä¸€äº›<code>Polars</code>å®ç°æœ€å¤§æ€§èƒ½æ‰€éœ€çš„æŠ€å·§ã€‚
å¦‚æœä½¿ç”¨å¾—å½“ï¼Œ<code>Polars</code>å¯ä»¥ä»¥æå¿«çš„é€Ÿåº¦è¿è¡Œã€‚è¯·åœ¨<a href="https://h2oai.github.io/db-benchmark/">H2O AI database benchmark</a>ä¸­çœ‹ç»“æœã€‚</p>
<h1 id="ä¸²"><a class="header" href="#ä¸²">ä¸²</a></h1>
<p>äº†è§£<code>Arrow</code>å’Œ<code>Polars</code>ä½¿ç”¨çš„å†…å­˜æ ¼å¼å¯ä»¥çœŸæ­£æé«˜æŸ¥è¯¢çš„æ€§èƒ½. å¯¹äºå¤§å‹å­—ç¬¦ä¸²æ•°æ®å°¤å…¶å¦‚æ­¤ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†<code>Arrow</code> <code>UTF8</code>æ•°ç»„åœ¨å†…å­˜ä¸­çš„å¸ƒå±€ã€‚</p>
<p>æ•°ç»„<code>[â€œfooâ€ã€â€œbarâ€ã€â€œhamâ€]</code>ç”±ä»¥ä¸‹ç¼–ç ï¼š</p>
<ul>
<li>è¿æ¥å­—ç¬¦ä¸²<code>foobarham</code>ï¼Œ</li>
<li>ä¸€ä¸ªåç§»æ•°ç»„ï¼ŒæŒ‡ç¤ºæ¯ä¸ªå­—ç¬¦ä¸²<code>[0,2,5,8]</code>çš„å¼€å§‹ï¼ˆå’Œç»“æŸï¼‰ï¼Œ</li>
<li>ç©ºä½å›¾ï¼ŒæŒ‡ç¤ºç©ºå€¼ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/pola-rs/polars-static/master/docs/arrow-string.svg" alt="" /></p>
<p>å¦‚æœæˆ‘ä»¬è¦è¯»å–å­—ç¬¦ä¸²å€¼ï¼Œè¿™ç§å†…å­˜ç»“æ„çš„ç¼“å­˜æ•ˆç‡éå¸¸é«˜ã€‚
å°¤å…¶æ˜¯å¦‚æœæˆ‘ä»¬å°†å®ƒä¸<code>Vec&lt;String&gt;</code>ï¼ˆåœ¨<code>Rust</code>ä¸­ç”±å †åˆ†é…çš„å­—ç¬¦ä¸²æ•°æ®ç»„æˆçš„æ•°ç»„ï¼‰è¿›è¡Œæ¯”è¾ƒã€‚</p>
<p><img src="https://raw.githubusercontent.com/pola-rs/polars-static/master/docs/pandas-string.svg" alt="" /></p>
<p>ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¯¹<code>Arrow</code> <code>UTF8</code>æ•°ç»„é‡æ–°æ’åºï¼Œæˆ‘ä»¬éœ€è¦äº¤æ¢å­—ç¬¦ä¸²å€¼çš„æ‰€æœ‰å­—èŠ‚ï¼Œè¿™åœ¨å¤„ç†å¤§å‹å­—ç¬¦ä¸²æ—¶å¯èƒ½ä¼šéå¸¸æ˜‚è´µã€‚å¦ä¸€æ–¹é¢ï¼Œå¯¹äº<code>Vec&lt;String&gt;</code>ï¼Œæˆ‘ä»¬åªéœ€è¦äº¤æ¢æŒ‡é’ˆï¼Œåªéœ€ç§»åŠ¨8å­—èŠ‚çš„æ•°æ®ï¼Œæˆæœ¬å¾ˆä½ã€‚
ç”±äºä¸€é¡¹æ“ä½œï¼ˆè¿‡æ»¤ã€è¿æ¥ã€åˆ†ç»„<em>ç­‰</em>ï¼‰è€ŒåµŒå…¥å¤§é‡<code>Utf8</code> <code>Series</code>çš„<code>DataFrame</code>çš„é‡æ–°æ’åºå¯èƒ½å¾ˆå¿«å˜å¾—éå¸¸æ˜‚è´µã€‚</p>
<h2 id="èŒƒç•´å‹"><a class="header" href="#èŒƒç•´å‹">èŒƒç•´å‹</a></h2>
<p>å› æ­¤ï¼Œ<code>Polars</code>æœ‰ä¸€ä¸ª<code>CategoricalType</code>ã€‚<code>category</code> <code>Series</code>æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­å¡«å……äº†<code>u32</code>å€¼ï¼Œæ¯ä¸ªå€¼ä»£è¡¨ä¸€ä¸ªå”¯ä¸€çš„å­—ç¬¦ä¸²å€¼ã€‚å› æ­¤ï¼Œåœ¨ä¿æŒç¼“å­˜æ•ˆç‡çš„åŒæ—¶ï¼Œç§»åŠ¨å€¼çš„æˆæœ¬ä¹Ÿå¾ˆä½ã€‚</p>
<p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºå¦‚ä½•å°†ä¸€ä¸ª<code>Utf8</code> <code>Series</code>åˆ—å¼ºåˆ¶è½¬æ¢ä¸ºä¸€ä¸ª<code>Categorical</code> <code>Series</code>ã€‚</p>
<pre><code class="language-python">import polars as pl

df[&quot;utf8-column&quot;].cast(pl.Categorical)
</code></pre>
<h3 id="åœ¨åˆ†ç±»æ•°æ®ä¸ŠåŠ å…¥å¤šä¸ªæ•°æ®å¸§"><a class="header" href="#åœ¨åˆ†ç±»æ•°æ®ä¸ŠåŠ å…¥å¤šä¸ªæ•°æ®å¸§">åœ¨åˆ†ç±»æ•°æ®ä¸ŠåŠ å…¥å¤šä¸ªæ•°æ®å¸§</a></h3>
<p>å½“éœ€è¦åŸºäºå­—ç¬¦ä¸²æ•°æ®è¿æ¥ä¸¤ä¸ª<code>DataFrame</code>æ—¶ï¼Œéœ€è¦åŒæ­¥<code>Category</code>æ•°æ®ï¼ˆ<code>df1</code>çš„<code>A</code>åˆ—ä¸­çš„æ•°æ®éœ€è¦æŒ‡å‘ä¸<code>df2</code>ä¸­çš„<code>B</code>åˆ—ç›¸åŒçš„åº•å±‚å­—ç¬¦ä¸²æ•°æ®ï¼‰ã€‚å¯ä»¥é€šè¿‡åœ¨<code>StringCache</code>ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä¸­å¼ºåˆ¶è½¬æ¢æ•°æ®æ¥å®ç°ã€‚è¿™å°†åœ¨è¯¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨æœŸé—´åŒæ­¥æ‰€æœ‰å¯å‘ç°çš„å­—ç¬¦ä¸²å€¼ã€‚å¦‚æœå¸Œæœ›å…¨å±€å­—ç¬¦ä¸²ç¼“å­˜åœ¨æ•´ä¸ªè¿è¡ŒæœŸé—´å­˜åœ¨ï¼Œå¯ä»¥å°†<code>toggle_string_cache</code>è®¾ç½®ä¸º<code>True</code>ã€‚</p>
<pre><code class="language-python">import polars as pl

df1 = pl.DataFrame({&quot;a&quot;: [&quot;foo&quot;, &quot;bar&quot;, &quot;ham&quot;], &quot;b&quot;: [1, 2, 3]})
df2 = pl.DataFrame({&quot;a&quot;: [&quot;foo&quot;, &quot;spam&quot;, &quot;eggs&quot;], &quot;c&quot;: [3, 2, 2]})

with pl.StringCache():
    df1.with_column(pl.col(&quot;a&quot;).cast(pl.Categorical))
    df2.with_column(pl.col(&quot;a&quot;).cast(pl.Categorical))
</code></pre>
<h3 id="æƒ°æ€§è¿æ¥åˆ†ç±»æ•°æ®ä¸Šçš„å¤šä¸ªæ•°æ®å¸§"><a class="header" href="#æƒ°æ€§è¿æ¥åˆ†ç±»æ•°æ®ä¸Šçš„å¤šä¸ªæ•°æ®å¸§">æƒ°æ€§è¿æ¥åˆ†ç±»æ•°æ®ä¸Šçš„å¤šä¸ªæ•°æ®å¸§</a></h3>
<p>åœ¨æŸ¥è¯¢æœŸé—´ï¼ˆç›´åˆ°è°ƒç”¨<code>.collect()</code>ï¼‰ï¼Œæƒ°æ€§æŸ¥è¯¢å§‹ç»ˆå…·æœ‰å…¨å±€å­—ç¬¦ä¸²ç¼“å­˜ï¼ˆé™¤éæ‚¨é€‰æ‹©é€€å‡ºï¼‰ã€‚ä¸‹é¢çš„ç¤ºä¾‹æ˜¾ç¤ºäº†å¦‚ä½•å°†ä¸¤ä¸ª<code>DataFrame</code>ä¸<code>Category</code>ç±»å‹è¿æ¥èµ·æ¥ã€‚</p>
<pre><code class="language-python">import polars as pl

lf1 = pl.DataFrame({&quot;a&quot;: [&quot;foo&quot;, &quot;bar&quot;, &quot;ham&quot;], &quot;b&quot;: [1, 2, 3]}).lazy()
lf2 = pl.DataFrame({&quot;a&quot;: [&quot;foo&quot;, &quot;spam&quot;, &quot;eggs&quot;], &quot;c&quot;: [3, 2, 2]}).lazy()

lf1 = lf1.with_column(pl.col(&quot;a&quot;).cast(pl.Categorical))
lf2 = lf2.with_column(pl.col(&quot;a&quot;).cast(pl.Categorical))

lf1.join(lf2, on=&quot;a&quot;, how=&quot;inner&quot;)
</code></pre>
<h1 id="ä¼˜åŒ–"><a class="header" href="#ä¼˜åŒ–">ä¼˜åŒ–</a></h1>
<p>æœ¬ç« å°†ç ”ç©¶<code>Polars</code>åº”ç”¨çš„ä¸€äº›ä¼˜åŒ–æŸ¥è¯¢ä¼˜åŒ–å™¨ï¼Œé€šè¿‡æŸ¥çœ‹ä¸€äº›ç¤ºä¾‹æ¥äº†è§£<code>Polars</code>å¦‚ä½•ä¿®æ”¹åŸå§‹æŸ¥è¯¢è®¡åˆ’ã€‚</p>
<h1 id="æƒ°æ€§api"><a class="header" href="#æƒ°æ€§api">æƒ°æ€§API</a></h1>
<blockquote>
<p>æƒ°æ€§APIé¡µé¢æ­£åœ¨æ„å»ºä¸­ã€‚</p>
</blockquote>
<p>ä¸ºäº†å±•ç¤ºæƒ°æ€§<code>Polars</code>åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†æ¢ç´¢ä¸¤ç§ä¸­å¤§å‹ç”¨æˆ·åæ•°æ®é›†ï¼š</p>
<p><a href="https://www.reddit.com/r/datasets/comments/9i8s5j/dataset_metadata_for_69_million_reddit_users_in/">Redditç”¨æˆ·åæ•°æ®é›†</a>
åŒ…å«6900å¤šä¸‡è¡Œ</p>
<pre><code class="language-python">import polars as pl

from ..paths import DATA_DIR

dataset = pl.read_csv(f&quot;{DATA_DIR}/reddit.csv&quot;, stop_after_n_rows=10)
</code></pre>
<pre><code class="language-text">shape: (5, 6)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id  â”† name                     â”† created_utc â”† updated_on â”† comment_karma â”† link_karma â”‚
â”‚ --- â”† ---                      â”† ---         â”† ---        â”† ---           â”† ---        â”‚
â”‚ i64 â”† str                      â”† i64         â”† i64        â”† i64           â”† i64        â”‚
â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 1   â”† truman48lamb_jasonbroken â”† 1397113470  â”† 1536527864 â”† 0             â”† 0          â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 2   â”† johnethen06_jasonbroken  â”† 1397113483  â”† 1536527864 â”† 0             â”† 0          â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 3   â”† yaseinrez_jasonbroken    â”† 1397113483  â”† 1536527864 â”† 0             â”† 1          â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 4   â”† Valve92_jasonbroken      â”† 1397113503  â”† 1536527864 â”† 0             â”† 0          â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 5   â”† srbhuyan_jasonbroken     â”† 1397113506  â”† 1536527864 â”† 0             â”† 0          â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>ä»¥åŠ<a href="https://github.com/RuneStar/name-cleanup-2014">Runescapeç”¨æˆ·åæ•°æ®é›†</a>
åŒ…å«çº¦5500å¤šä¸‡æ¡è®°å½•ã€‚</p>
<pre><code class="language-python">import polars as pl

from ..paths import DATA_DIR

dataset = pl.read_csv(f&quot;{DATA_DIR}/runescape.csv&quot;, has_headers=False, stop_after_n_rows=10)
</code></pre>
<pre><code class="language-text">shape: (5, 1)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ column_1    â”‚
â”‚ ---         â”‚
â”‚ str         â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ a000        â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ a0000       â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ a000000     â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ a0000000    â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ a0000000000 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h1 id="è°“è¯ä¸‹æ¨"><a class="header" href="#è°“è¯ä¸‹æ¨">è°“è¯ä¸‹æ¨</a></h1>
<blockquote>
<p><code>è°“è¯ä¸‹æ¨</code>ç« èŠ‚æ­£åœ¨æ„å»ºä¸­</p>
</blockquote>
<p>è°“è¯ä¸‹æ¨æ˜¯<code>Polars</code>æ‰€åšçš„ä¼˜åŒ–ï¼Œå¯ä»¥å‡å°‘æŸ¥è¯¢æ—¶é—´å’Œå†…å­˜ä½¿ç”¨ã€‚è°“è¯æ˜¯æ•°æ®åº“è¡Œè¯ï¼Œç”¨äºåœ¨æŸä¸ªè¡¨ä¸Šåº”ç”¨è¿‡æ»¤å™¨ï¼Œä»è€Œå‡å°‘è¯¥è¡¨ä¸Šçš„è¡Œæ•°ã€‚</p>
<p>é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦å¯ä»¥åŠ è½½ä¸€äº›Redditæ•°æ®å¹¶å¯¹å‡ ä¸ªè°“è¯è¿›è¡Œè¿‡æ»¤ã€‚</p>
<pre><code class="language-python">import polars as pl

from ..paths import DATA_DIR

q1 = (
    pl.scan_csv(f&quot;{DATA_DIR}/reddit.csv&quot;)
    .filter(pl.col(&quot;comment_karma&quot;) &gt; 0)  # è°“è¯è¿‡æ»¤
    .filter(pl.col(&quot;link_karma&quot;) &gt; 0)
    .filter(pl.col(&quot;name&quot;).str.contains(r&quot;^a&quot;))  # filter name that start with an &quot;a&quot;
)
</code></pre>
<p>å¦‚æœæˆ‘ä»¬åœ¨ä¸Šé¢è¿è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Œä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿï¼è¿™æ˜¯ç”±äºæ‡’æƒ°çš„è¯„ä¼°ã€‚
é™¤éç‰¹åˆ«è¦æ±‚ï¼Œå¦åˆ™ä¸ä¼šå‘ç”Ÿä»»ä½•äº‹æƒ…ã€‚è¿™ä½¿Polarsèƒ½å¤Ÿçœ‹åˆ°æŸ¥è¯¢çš„æ•´ä¸ªä¸Šä¸‹æ–‡ï¼Œå¹¶åŠæ—¶ä¼˜åŒ–ä»¥æ‰§è¡Œã€‚</p>
<p><code>.collect</code>æ–¹æ³•è¯·æ±‚æ‰§è¡Œã€‚è¿™å°†æŸ¥è¯¢æ‰€æœ‰å¯ç”¨æ•°æ®ã€‚
åœ¨ç¼–å†™ã€ä¼˜åŒ–å’Œæ£€æŸ¥æŸ¥è¯¢æ—¶ï¼Œè¿™é€šå¸¸æ˜¯ä¸å¯å–çš„ã€‚å¦ä¸€ä¸ªè°ƒç”¨æ‰§è¡Œçš„æ–¹æ³•æ˜¯<code>.fetch</code>æ–¹æ³•ã€‚<code>.fetch</code>æ¥å—ä¸€ä¸ªå‚æ•°<code>n_rows</code>ï¼Œå¹¶å°è¯•åœ¨æ•°æ®æºä¸Š'è·å–'è¯¥æ•°é‡çš„è¡Œï¼ˆå°½ç®¡æ²¡æœ‰ç»™å‡ºä»»ä½•ä¿è¯ï¼‰ã€‚</p>
<p>å› æ­¤ï¼Œè®©æˆ‘ä»¬ä»æºæ–‡ä»¶ä¸­â€œè·å–â€çº¦1000ä¸‡è¡Œï¼Œå¹¶åº”ç”¨è°“è¯ã€‚</p>
<pre><code class="language-python">q1.fetch(n_rows=int(1e7))
</code></pre>
<pre><code class="language-text">shape: (656, 6)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id      â”† name        â”† created_utc â”† updated_on â”† comment_karma â”† link_karma â”‚
â”‚ ---     â”† ---         â”† ---         â”† ---        â”† ---           â”† ---        â”‚
â”‚ i64     â”† str         â”† i64         â”† i64        â”† i64           â”† i64        â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 77860   â”† aquarin     â”† 1137474000  â”† 1536528294 â”† 150           â”† 11         â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 77974   â”† aadvaark    â”† 1137301200  â”† 1536528294 â”† 26            â”† 47         â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 78004   â”† apoisel     â”† 1137301200  â”† 1536497404 â”† 42            â”† 2549       â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 78041   â”† aonic       â”† 1137301200  â”† 1536497404 â”† 2931          â”† 2095       â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ ...     â”† ...         â”† ...         â”† ...        â”† ...           â”† ...        â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 1192656 â”† atothedrian â”† 1162785880  â”† 1536497412 â”† 748           â”† 585        â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 1204607 â”† akbusiness  â”† 1162899425  â”† 1536532995 â”† 73            â”† 512        â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 1214809 â”† aaminics    â”† 1162969322  â”† 1536533034 â”† 22            â”† 6          â”‚
â”œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¼â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”¤
â”‚ 1225341 â”† antonulrich â”† 1163110623  â”† 1536497412 â”† 9304          â”† 1782       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>ä¸Šé¢æˆ‘ä»¬çœ‹åˆ°ï¼Œä»1000ä¸‡è¡Œä¸­ï¼Œ61503è¡ŒåŒ¹é…æˆ‘ä»¬çš„è°“è¯ã€‚</p>
<h2 id="åˆ†è§£"><a class="header" href="#åˆ†è§£">åˆ†è§£</a></h2>
<p>åœ¨<code>Polars</code>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯è§†åŒ–æŸ¥è¯¢è®¡åˆ’ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ã€‚</p>
<pre><code class="language-python">q1.show_graph(optimized=False)
</code></pre>
<p><img src="optimizations/lazy/../../outputs/predicate_pushdown/graph1.png" alt="" /></p>
<p>ç²¾æ˜çš„è¯»è€…å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œæˆ‘ä»¬çš„æŸ¥è¯¢ä¸æ˜¯å¾ˆç†æƒ³ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰ä¸‰ä¸ªç‹¬ç«‹çš„<em>FILTER</em>èŠ‚ç‚¹ã€‚è¿™æ„å‘³ç€åœ¨æ¯ä¸€ä¸ª<em>è¿‡æ»¤å™¨</em>åˆ†é…ä¸€ä¸ªæ–°çš„<code>DataFrame</code>ï¼Œå®ƒå°†è¢«è¾“å…¥åˆ°ä¸‹ä¸€ä¸ª<em>è¿‡æ»¤å™¨</em>ä¸­ï¼Œç„¶åä»å†…å­˜ä¸­åˆ é™¤--è¿™ä¸€å®šæ˜¯å¤šä½™çš„ï¼Œä½ çŸ¥é“å—... ä»–ä»¬æ˜¯å¯¹çš„ã€‚è°“è¯åº”è¯¥ç»„åˆåœ¨ä¸€èµ·ã€‚æˆ‘ä»¬åº”è¯¥å†™ä¸‹è¿™ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="language-python">import polars as pl

from ..paths import DATA_DIR

q2 = pl.scan_csv(f&quot;{DATA_DIR}/reddit.csv&quot;).filter(
    (pl.col(&quot;comment_karma&quot;) &gt; 0) &amp; (pl.col(&quot;link_karma&quot;) &gt; 0) &amp; (pl.col(&quot;name&quot;).str.contains(r&quot;^a&quot;))
)
</code></pre>
<p>è¿™å°†è½¬åŒ–ä¸ºï¼š</p>
<pre><code class="language-python">q2.show_graph(optimized=False)
</code></pre>
<p><img src="optimizations/lazy/../../outputs/predicate_pushdown/graph2.png" alt="" /></p>
<p>æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œè°“è¯æ˜¯ç»„åˆåœ¨ä¸€èµ·çš„ã€‚è¿™å°†å‡å°‘æ•°æ®çš„å¤åˆ¶ã€‚</p>
<h2 id="ä¼˜åŒ–éšä¹‹è€Œæ¥"><a class="header" href="#ä¼˜åŒ–éšä¹‹è€Œæ¥">ä¼˜åŒ–éšä¹‹è€Œæ¥</a></h2>
<p><code>Polars</code>è¯•å›¾ä»æŸ¥è¯¢ç¼–å†™å™¨ä¸­èŠ‚çœè¿™ç§ç²¾ç¥å¼€é”€ï¼Œå¹¶ä¸ºæ‚¨ç»„åˆè°“è¯ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜å°†è°“è¯ä¸‹æ¨åˆ°æ‰«æçº§åˆ«ï¼è®©æˆ‘ä»¬çœ‹çœ‹ä¼˜åŒ–åçš„æŸ¥è¯¢æ˜¯ä»€ä¹ˆæ ·å­ã€‚</p>
<pre><code class="language-python">q1.show_graph(optimized=True)
</code></pre>
<p><img src="optimizations/lazy/../../outputs/predicate_pushdown/graph1-optimized.png" alt="" /></p>
<p>è¿™å¯èƒ½å¾ˆéš¾çœ‹åˆ°ï¼Œä½†å¾ˆæ¸…æ¥šçš„æ˜¯ï¼Œåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼š<em>CSVæ‰«æ</em>ã€‚è°“è¯è¿‡æ»¤æ˜¯åœ¨è¯»å–csvçš„è¿‡ç¨‹ä¸­å®Œæˆçš„ã€‚è¿™æ„å‘³ç€è¯¥æŸ¥è¯¢çš„å†…å­˜å¼€é”€é€šè¿‡è¿‡æ»¤å› å­å‡å°‘äº†ï¼è¿™äº§ç”Ÿäº†å·¨å¤§çš„å½±å“ã€‚</p>
<h3 id="å†…å­˜"><a class="header" href="#å†…å­˜">å†…å­˜</a></h3>
<p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œåœ¨<em>è¿‡æ»¤å™¨</em>ä¹‹åè¿˜å‰©ä¸‹çº¦62000è¡Œã€‚è¿™æ„å‘³ç€ï¼ˆé™¤äº†æ‰¹é‡å¤§å°å’Œç­›é€‰æ“ä½œçš„ä¸€äº›å†…å­˜å¼€é”€ï¼‰æˆ‘ä»¬ä½¿ç”¨\(\frac{6.2\text{e-}4}{1\text{e-}7} \sim 0.6 \text{%} \)åœ¨ä¸€æ¬¡æ€¥åˆ‡çš„è¯„ä¼°ä¸­ï¼Œæˆ‘ä»¬å°†é¦–å…ˆè¯»å–å†…å­˜ä¸­çš„æ•´ä¸ªè¡¨ï¼Œç„¶åå†åº”ç”¨è¿‡æ»¤å™¨ã€‚</p>
<h3 id="æ€§èƒ½-1"><a class="header" href="#æ€§èƒ½-1">æ€§èƒ½</a></h3>
<p>åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œè°“è¯ä¸‹æ¨ä¹Ÿæé«˜äº†æŸ¥è¯¢æ—¶é—´æ€§èƒ½ã€‚</p>
<p><strong>æ— ä¼˜åŒ–</strong>, <code>predicate_pushdown=False</code> æ ‡ç­¾:</p>
<pre><code class="language-text">real    0m2,401s
user    0m5,457s
sys    0m0,894s
</code></pre>
<p><strong>æœ‰ä¼˜åŒ–</strong>, <code>predicate_pushdown=True</code> æ ‡ç­¾:</p>
<pre><code class="language-text">real    0m1,597s
user    0m6,143s
sys    0m0,647s
</code></pre>
<h2 id="å…³ç³»ä»£æ•°"><a class="header" href="#å…³ç³»ä»£æ•°">å…³ç³»ä»£æ•°</a></h2>
<p>åœ¨æŸ¥è¯¢è®¡åˆ’çš„å¯è§†åŒ–ä¸­ï¼Œæ‚¨ä¼šçœ‹åˆ°ä¸€ä¸ª\ï¼ˆ\sigma\ï¼‰ç¬¦å·ã€‚è¿™è¡¨ç¤ºåœ¨<em>æ‰«æ</em>çº§åˆ«æ‰§è¡Œçš„è°“è¯ã€‚è¿˜æœ‰ä¸€ä¸ª\ï¼ˆ\pi\ï¼‰ç¬¦å·è¡¨ç¤ºæŠ•å½±ï¼ˆç”¨äºåˆ—é€‰æ‹©çš„æ•°æ®åº“è¡Œè¯ï¼‰ï¼Œä½†æˆ‘ä»¬ç¨åå°†è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚</p>
<h2 id="æ›´ä¾¿æ·çš„è”ç»“joinsæ“ä½œ"><a class="header" href="#æ›´ä¾¿æ·çš„è”ç»“joinsæ“ä½œ">æ›´ä¾¿æ·çš„è”ç»“ï¼ˆjoinsï¼‰æ“ä½œ</a></h2>
<p>è°“è¯ä¸‹æ¨ä¼˜åŒ–é€šå¸¸ä¹Ÿä¼šå¯¼è‡´æ›´ä¾¿å®œçš„è¿æ¥ã€‚è¿æ¥æ˜¯ä¸€ä¸ªæ˜‚è´µçš„æ“ä½œã€‚è¿æ¥æ“ä½œä¸­çš„è¡Œæ•°è¶Šå°‘ï¼Œæˆæœ¬å°±è¶Šä½ã€‚</p>
<h1 id="æŠ•å½±ä¸‹æ¨"><a class="header" href="#æŠ•å½±ä¸‹æ¨">æŠ•å½±ä¸‹æ¨</a></h1>
<blockquote>
<p><code>æŠ•å½±ä¸‹æ¨</code>ç« èŠ‚æ­£åœ¨æ„å»ºä¸­</p>
</blockquote>
<p>æˆ‘ä»¬æ¥æŠŠä¸Šä¸€ç« èŠ‚ä¸­çš„æŸ¥è¯¢ä¸åœ¨ Runescape ï¼ˆä¸€æ¬¾æ¸¸æˆï¼‰æ•°æ®ä¸­è¿›è¡Œ <em>FILTER</em> æ“ä½œçš„ç»“æœç»“åˆèµ·æ¥ï¼Œ
æ¥æ‰¾å‡ºä»¥å­—æ¯ <code>a</code> å¼€å¤´ä¸”ç©è¿‡ Runescape çš„æµè¡Œ Reddit ç”¨æˆ·åã€‚ç›¸ä¿¡ä½ ä¸€å®šä¹Ÿä¼šå¯¹æ­¤æ„Ÿå…´è¶£çš„ï¼</p>
<p>ä½ å¯ä»¥æ„å»ºç±»ä¼¼äºä»¥ä¸‹çš„æŸ¥è¯¢ï¼š</p>
<pre><code class="language-python">import polars as pl

from ..paths import DATA_DIR

reddit = (
    pl.scan_csv(f&quot;{DATA_DIR}/reddit.csv&quot;)
    .filter(pl.col(&quot;comment_karma&quot;) &gt; 0)
    .filter(pl.col(&quot;link_karma&quot;) &gt; 0)
    .filter(pl.col(&quot;name&quot;).str.contains(r&quot;^a&quot;))
)

runescape = pl.scan_csv(&quot;data/runescape.csv&quot;, has_headers=False).select(pl.col(&quot;column_1&quot;).alias(&quot;name&quot;))

dataset = reddit.join(runescape, on=&quot;name&quot;, how=&quot;inner&quot;).select([&quot;name&quot;, &quot;comment_karma&quot;, &quot;link_karma&quot;])

df1 = dataset.fetch(int(1e7))
df2 = dataset.fetch(int(1e7), predicate_pushdown=True, projection_pushdown=True)
</code></pre>
<p>è¿™å°†äº§å‡ºä»¥ä¸‹ DataFrameï¼š</p>
<pre><code class="language-text">shape: (0, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ name â”† comment_karma â”† link_karma â”‚
â”‚ ---  â”† ---           â”† ---        â”‚
â”‚ str  â”† i64           â”† i64        â”‚
â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 id="æ›´è¿‘ä¸€æ­¥"><a class="header" href="#æ›´è¿‘ä¸€æ­¥">æ›´è¿‘ä¸€æ­¥</a></h2>
<p>è®©æˆ‘ä»¬å†æ¥çœ‹çœ‹æŸ¥è¯¢è®¡åˆ’ã€‚</p>
<pre><code class="language-python">dataset.show_graph(optimized=False)
</code></pre>
<p><img src="optimizations/lazy/./../outputs/projection_pushdown/graph.png" alt="" /></p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å…³æ³¨çš„æ˜¯ç”¨ <code>Ï€</code> è¡¨ç¤ºçš„æŠ•å½±ã€‚ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸Šæ˜¾ç¤ºç€ Ï€ 3/6ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä» <code>DataFrame</code>
çš„ 6 åˆ—ä¸­é€‰å‡ºäº†å…¶ä¸­çš„ 3 åˆ—ã€‚åœ¨ csv è¯»å–ç»“æœä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šé…ç¬¦ <code>Ï€ */6</code> å’Œ <code>Ï€ */1</code>ï¼Œ
è¿™æ„å‘³ç€æˆ‘ä»¬é€‰ä¸­äº† Reddit æ•°æ®é›†ä¸­çš„å…¨éƒ¨ 6 åˆ—ï¼Œä»¥åŠå¯¹åº”çš„ Runescape æ•°æ®é›†ä¸­å”¯ä¸€çš„ä¸€åˆ—ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™æ ·çš„æŸ¥è¯¢æ€§èƒ½å¹¶ä¸ç†æƒ³ â€”â€” æˆ‘ä»¬é€‰ä¸­äº†ä¸¤ä¸ªæ•°æ®é›†çš„æ‰€æœ‰åˆ—ï¼Œå´åªæ˜¾ç¤ºäº†å…³è” (join) åçš„ 3 åˆ—ã€‚
è¿™æ„å‘³ç€ä¸€äº›å‚ä¸å…³è”è®¡ç®—çš„åˆ—å®é™…ä¸Šæ˜¯å¯ä»¥è¢«å¿½ç•¥çš„ã€‚ç±»ä¼¼çš„ï¼Œåœ¨è¯»å– csv æ—¶è§£æäº†ä¸€äº›åˆ—ï¼Œè€Œå®ƒä»¬åœ¨æœ€åæ˜¯è¢«ç™½ç™½ä¸¢å¼ƒæ‰çš„ã€‚
å½“æˆ‘ä»¬è¦å¤„ç†çš„ <code>DataFrame</code> ä¸­æœ‰å¤§é‡çš„åˆ—æ—¶ï¼Œæ‰€åšçš„è¿™ç§å†—ä½™å·¥ä½œé‡å¯èƒ½æ˜¯éå¸¸å¯è§‚çš„ã€‚</p>
<h3 id="æ›´ä¼˜æŸ¥è¯¢æ–¹æ¡ˆ"><a class="header" href="#æ›´ä¼˜æŸ¥è¯¢æ–¹æ¡ˆ">æ›´ä¼˜æŸ¥è¯¢æ–¹æ¡ˆ</a></h3>
<p>è®©æˆ‘ä»¬çœ‹çœ‹ <code>Polars</code> æ˜¯å¦‚ä½•ä¼˜åŒ–è¿™ä¸ªæŸ¥è¯¢çš„ã€‚</p>
<pre><code class="language-python">dataset.show_graph(optimized=True)
</code></pre>
<p><img src="optimizations/lazy/./../outputs/projection_pushdown/graph-optimized.png" alt="" /></p>
<p>å…³è” (join) æ“ä½œä¸­çš„æŠ•å½±è¢«ä¸‹æ¨è‡³ csv è¯»å–çš„è¿™ä¸€æ­¥ã€‚è¿™æ„å‘³ç€æŸ¥è¯¢ä¼˜åŒ–é™ä½äº†è¯»å–æ•°æ®ä»¥åŠå…³è”æ“ä½œè¿™äºŒè€…çš„å¼€é”€ã€‚</p>
<h2 id="æ€§èƒ½-2"><a class="header" href="#æ€§èƒ½-2">æ€§èƒ½</a></h2>
<p>è®©æˆ‘ä»¬ä¸ºä¼˜åŒ–å‰åçš„ç»“æœè¿›è¡Œè®¡æ—¶ã€‚</p>
<p><strong>ä¼˜åŒ–å‰</strong>ï¼Œå³ <code>predicate_pushdown=False</code> ä¸” <code>projection_pushdown=False</code>ã€‚</p>
<pre><code class="language-text">real    0m3,273s
user    0m9,284s
sys    0m1,081s
</code></pre>
<p><strong>ä¼˜åŒ–å</strong>ï¼Œå³å°† <code>predicate_pushdown</code> ä¸ <code>projection_pushdown</code> å‡è®¾ç½®ä¸º <code>True</code>ã€‚</p>
<pre><code class="language-text">real    0m1,732s
user    0m7,581s
sys    0m0,783s
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸€ç®€å•çš„ä¼˜åŒ–ä½¿å¾—æˆ‘ä»¬èŠ‚çœäº†å°†è¿‘ä¸€åŠçš„æŸ¥è¯¢æ—¶é—´ï¼åœ¨ç°å®åº”ç”¨ä¸­ï¼Œä¸šåŠ¡æ•°æ®é€šå¸¸ä¿å­˜äº†å¤§é‡åˆ—ï¼Œ
æˆ‘ä»¬é¢„æœŸè¿™ä½¿å¾—ä¼˜åŒ–å‰åçš„è¿‡æ»¤ç¼ºå¤±æ•°æ®ã€è¿›è¡Œå¤æ‚çš„åˆ†ç»„æ“ä½œã€å…³è”æ“ä½œç­‰çš„æ€§èƒ½å·®å¼‚ä¼šå˜å¾—æ›´å¤§ã€‚</p>
<h1 id="å…¶å®ƒä¼˜åŒ–"><a class="header" href="#å…¶å®ƒä¼˜åŒ–">å…¶å®ƒä¼˜åŒ–</a></h1>
<blockquote>
<p><code>å…¶å®ƒä¼˜åŒ–</code>é¡µé¢æ­£åœ¨æ„å»ºä¸­ã€‚</p>
</blockquote>
<p>é™¤äº†è°“è¯å’ŒæŠ•å½±ä¸‹æ¨ä¹‹å¤–ï¼Œ<code>Polars</code>è¿˜è¿›è¡Œå…¶ä»–ä¼˜åŒ–ã€‚</p>
<p>ä¸€ä¸ªé‡è¦çš„ä¸»é¢˜æ˜¯å¯é€‰çš„ç¼“å­˜å’Œå¹¶è¡ŒåŒ–ã€‚å¾ˆå®¹æ˜“æƒ³è±¡ï¼Œæœ‰ä¸¤ç§ä¸åŒçš„<code>DataFrame</code>è®¡ç®—ä¼šå¯¼è‡´æ‰«æåŒä¸€ä¸ªæ–‡ä»¶<code>Polars</code>å¯èƒ½ä¼šç¼“å­˜æ‰«æçš„æ–‡ä»¶ï¼Œä»¥é˜²æ­¢æ‰«æåŒä¸€æ–‡ä»¶ä¸¤æ¬¡ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æ„¿æ„ï¼Œå¯ä»¥é‡å†™æ­¤è¡Œä¸ºå¹¶å¼ºåˆ¶<code>Polars</code>è¯»å–åŒä¸€æ–‡ä»¶ã€‚è¿™å¯èƒ½ä¼šæ›´å¿«ï¼Œå› ä¸ºæ‰«æå¯ä»¥å¹¶è¡Œè¿›è¡Œã€‚</p>
<h2 id="è”ç»“å¹¶è¡ŒåŒ–"><a class="header" href="#è”ç»“å¹¶è¡ŒåŒ–">è”ç»“å¹¶è¡ŒåŒ–</a></h2>
<p>å¦‚æœæˆ‘ä»¬æŸ¥çœ‹ä¸Šä¸€ä¸ªæŸ¥è¯¢ï¼Œå°±ä¼šå‘ç°joinæ“ä½œæœ‰ä¸€ä¸ªè¾“å…¥å¸¦æœ‰<code>data/reddit.csv</code>çš„è®¡ç®—è·¯å¾„ä½œä¸ºæ ¹ç›®å½•ï¼Œä¸€ä¸ªè·¯å¾„å¸¦æœ‰<code>data/runescape.csv</code>ä½œä¸ºæ ¹ç›®å½•ã€‚<code>Polars</code>å¯ä»¥è§‚å¯Ÿåˆ°ä¸¤ä¸ª<code>DataFrame</code>ä¹‹é—´æ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œå°†å¹¶è¡Œè¯»å–è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚å¦‚æœåœ¨åŠ å…¥ä¹‹å‰å®Œæˆäº†å…¶ä»–æ“ä½œï¼ˆä¾‹å¦‚groupbyã€filtersç­‰ï¼‰ï¼Œå®ƒä»¬ä¹Ÿä¼šå¹¶è¡Œæ‰§è¡Œã€‚</p>
<p><img src="optimizations/lazy/../../outputs/projection_pushdown/graph-optimized.png" alt="" /></p>
<h2 id="ç®€åŒ–è¡¨è¾¾å¼"><a class="header" href="#ç®€åŒ–è¡¨è¾¾å¼">ç®€åŒ–è¡¨è¾¾å¼</a></h2>
<p>å…¶ä»–ä¸€äº›ä¼˜åŒ–æ˜¯è¡¨è¾¾å¼ç®€åŒ–ã€‚è¿™äº›ä¼˜åŒ–çš„å½±å“æ¯”è°“è¯å’ŒæŠ•å½±ä¸‹æ¨çš„å½±å“å°ï¼Œä½†å®ƒä»¬å¾ˆå¯èƒ½åŠ èµ·æ¥ã€‚ä½ å¯ä»¥<a href="https://github.com/pola-rs/polars/issues/139">è¿½è¸ªè¿™ä¸ªé—®é¢˜</a>æŸ¥çœ‹è¿™äº›çš„æœ€æ–°çŠ¶æ€ã€‚</p>
<h1 id="å‚è€ƒæŒ‡å—"><a class="header" href="#å‚è€ƒæŒ‡å—">å‚è€ƒæŒ‡å—</a></h1>
<p>éœ€è¦æŸ¥çœ‹<code>Polars</code>çš„æ‰€æœ‰å¯ç”¨æ–¹æ³•/åŠŸèƒ½å—ï¼Ÿæˆ‘ä»¬æœ‰<code>Rust</code>å’Œ<code>Python</code>çš„å‚è€ƒæ–‡çŒ®ï¼š</p>
<ul>
<li><a href="https://docs.rs/polars"><code>Rust</code> å‘è¡Œç‰ˆæœ¬</a></li>
<li><a href="https://pola-rs.github.io/polars/py-polars/html/reference"><code>Python</code> API</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>
        
        

    </body>
</html>
